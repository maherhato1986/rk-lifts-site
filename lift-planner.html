<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>RKL Lift Planner (Plan + Section)</title>
  <style>
    :root{
      --ink:#111827;
      --muted:#6b7280;
      --line:#e5e7eb;
      --soft:#f8fafc;
      --card:#ffffff;
    }
    *{box-sizing:border-box}
    body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial; background:var(--soft); color:var(--ink)}
    header{padding:16px 18px;border-bottom:1px solid var(--line); background:#fff}
    header h1{margin:0;font-size:18px}
    header p{margin:6px 0 0;color:var(--muted);font-size:13px}

    .wrap{max-width:1200px;margin:0 auto;padding:16px 18px}
    .grid{display:grid;grid-template-columns: 360px 1fr; gap:14px}
    .panel{
      background:var(--card); border:1px solid var(--line);
      border-radius:14px; padding:14px;
      box-shadow:0 6px 18px rgba(17,24,39,.06);
    }
    .panel h2{margin:0 0 10px;font-size:15px}
    .row{display:grid;grid-template-columns: 1fr 1fr; gap:10px}
    .f{display:flex;flex-direction:column;gap:6px;margin:10px 0}
    label{font-size:12px;color:var(--muted)}
    input{
      padding:10px 10px; border:1px solid var(--line); border-radius:10px;
      font-size:14px; outline:none; background:#fff
    }
    input:focus{border-color:#94a3b8}
    .btns{display:flex;gap:10px;flex-wrap:wrap;margin-top:10px}
    button{
      border:1px solid var(--line); background:#fff; border-radius:12px;
      padding:10px 12px; font-size:13px; cursor:pointer
    }
    button:hover{background:#f3f4f6}
    .note{font-size:12px;color:var(--muted);line-height:1.6;margin-top:10px}
    .canvas{
      background:var(--card); border:1px solid var(--line); border-radius:14px;
      box-shadow:0 6px 18px rgba(17,24,39,.06);
      overflow:hidden;
    }
    .canvas-head{
      display:flex; justify-content:space-between; align-items:center;
      padding:12px 14px; border-bottom:1px solid var(--line)
    }
    .badge{font-size:12px;color:var(--muted)}
    .svgs{
      display:grid; grid-template-columns: 1fr 1fr; gap:0;
    }
    .svgbox{
      border-left:1px solid var(--line);
      padding:12px;
    }
    .svgbox:first-child{border-left:none}
    .svgtitle{font-size:13px;margin:0 0 8px;color:var(--muted)}
    .hint{font-size:12px;color:var(--muted);margin-top:8px}
    @media(max-width:980px){
      .grid{grid-template-columns:1fr}
      .svgs{grid-template-columns:1fr}
      .svgbox{border-left:none;border-top:1px solid var(--line)}
      .svgbox:first-child{border-top:none}
    }
  </style>
</head>
<body>
<header>
  <h1>Ù…Ø®Ø·Ø· Ø§Ù„Ù…ØµØ¹Ø¯ â€” Ø£ÙÙ‚ÙŠ (Plan) + Ø¬Ø§Ù†Ø¨ÙŠ (Section)</h1>
  <p>Ø±Ø³Ù… SVG Ø¨Ø³Ù…Ùƒ Ø¬Ø¯Ø±Ø§Ù† + ÙØªØ­Ø© Ø¨Ø§Ø¨ + ÙƒØ§Ø¨ÙŠÙ†Ø© + Ø£Ø¨Ø¹Ø§Ø¯. Ø§Ù„ÙˆØ­Ø¯Ø§Øª: mm</p>
</header>

<div class="wrap">
  <div class="grid">

    <!-- Inputs -->
    <div class="panel">
      <h2>Ù…Ø¯Ø®Ù„Ø§Øª Ø§Ù„Ù…Ø®Ø·Ø· (mm)</h2>

      <div class="row">
        <div class="f">
          <label>Ø¹Ø±Ø¶ Ø§Ù„Ø¨Ø¦Ø± Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠ (Shaft W)</label>
          <input id="shaftW" type="number" value="2000" min="1200" step="10">
        </div>
        <div class="f">
          <label>Ø¹Ù…Ù‚ Ø§Ù„Ø¨Ø¦Ø± Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠ (Shaft D)</label>
          <input id="shaftD" type="number" value="1800" min="1200" step="10">
        </div>
      </div>

      <div class="row">
        <div class="f">
          <label>Ø¹Ø±Ø¶ Ø§Ù„ÙƒØ§Ø¨ÙŠÙ†Ø© (Cabin W)</label>
          <input id="cabinW" type="number" value="1100" min="700" step="10">
        </div>
        <div class="f">
          <label>Ø¹Ù…Ù‚ Ø§Ù„ÙƒØ§Ø¨ÙŠÙ†Ø© (Cabin D)</label>
          <input id="cabinD" type="number" value="1400" min="700" step="10">
        </div>
      </div>

      <div class="row">
        <div class="f">
          <label>Ø¹Ø±Ø¶ ÙØªØ­Ø© Ø§Ù„Ø¨Ø§Ø¨ (Door W)</label>
          <input id="doorW" type="number" value="900" min="600" step="10">
        </div>
        <div class="f">
          <label>Ø³Ù…Ø§ÙƒØ© Ø§Ù„Ø¬Ø¯Ø§Ø± (Wall thk)</label>
          <input id="wallT" type="number" value="200" min="100" step="10">
        </div>
      </div>
<div class="f">
  <label>Ù…ÙˆÙ‚Ø¹ Ø§Ù„ÙƒÙˆÙ†ØªØ±ÙˆÙŠØª ÙÙŠ Ø§Ù„Ù…Ù‚Ø·Ø¹ (CW Side)</label>
  <select id="cwSide" style="padding:10px;border:1px solid var(--line);border-radius:10px;font-size:14px">
    <option value="right" selected>ÙŠÙ…ÙŠÙ†</option>
    <option value="left">ÙŠØ³Ø§Ø±</option>
  </select>
</div>


      <hr style="border:none;border-top:1px solid var(--line);margin:12px 0">

      <div class="row">
        <div class="f">
          <label>Ø¹Ø¯Ø¯ Ø§Ù„ÙˆÙ‚ÙØ§Øª (Stops)</label>
          <input id="stops" type="number" value="10" min="2" step="1">
        </div>
        <div class="f">
          <label>Ø§Ø±ØªÙØ§Ø¹ Ø§Ù„Ø¯ÙˆØ± Ø§Ù„ÙˆØ§Ø­Ø¯ (Floor height)</label>
          <input id="floorH" type="number" value="3600" min="2500" step="10">
        </div>
      </div>

      <div class="row">
        <div class="f">
          <label>Pit (Ø¹Ù…Ù‚ Ø§Ù„Ø­ÙØ±Ø©)</label>
          <input id="pit" type="number" value="1400" min="800" step="10">
        </div>
        <div class="f">
          <label>OH (Overhead)</label>
          <input id="oh" type="number" value="4200" min="2500" step="10">
        </div>
      </div>

      <div class="btns">
        <button id="btnDraw" type="button">ğŸ”„ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ø®Ø·Ø·</button>
        <button id="btnExportSVG" type="button">â¬‡ï¸ ØªØµØ¯ÙŠØ± SVG</button>
      </div>

      <div class="note">
        âœ… Ù…Ù„Ø§Ø­Ø¸Ø©: Ø§Ù„Ø±Ø³Ù… ÙŠØ³ØªØ®Ø¯Ù… Ù…Ù‚ÙŠØ§Ø³ Ø«Ø§Ø¨Øª Ø¯Ø§Ø®Ù„ Ø§Ù„Ù€ SVG (mm â†’ px) Ù„ÙŠØ·Ù„Ø¹ Ø´ÙƒÙ„ â€œÙ…Ø®Ø·Ø·â€ Ù…Ø¹ Ø£Ø¨Ø¹Ø§Ø¯ ÙˆØ£Ø³Ù‡Ù…ØŒ ÙˆÙ„ÙŠØ³ Ù…Ø±Ø¨Ø¹Ø§Øª ÙÙ‚Ø·.
      </div>
    </div>

    <!-- Output -->
    <div class="canvas">
      <div class="canvas-head">
        <div class="badge" id="badgeInfo">â€”</div>
        <div class="badge">Scale: 1px = 5mm (Ø§ÙØªØ±Ø§Ø¶ÙŠ)</div>
      </div>

      <div class="svgs">
        <div class="svgbox">
          <p class="svgtitle">Plan View (Ù…Ø®Ø·Ø· Ø£ÙÙ‚ÙŠ)</p>
          <svg id="svgPlan" width="100%" viewBox="0 0 520 420" xmlns="http://www.w3.org/2000/svg"></svg>
          <div class="hint">ÙŠØ¹Ø±Ø¶ Ø§Ù„Ø¨Ø¦Ø± + ÙØªØ­Ø© Ø§Ù„Ø¨Ø§Ø¨ + Ø§Ù„ÙƒØ§Ø¨ÙŠÙ†Ø© + Ø®Ø·ÙˆØ· Ù…Ø­Ø§ÙˆØ± + Ø£Ø¨Ø¹Ø§Ø¯.</div>
        </div>

        <div class="svgbox">
          <p class="svgtitle">Section View (Ù…Ø®Ø·Ø· Ø¬Ø§Ù†Ø¨ÙŠ)</p>
          <svg id="svgSec" width="100%" viewBox="0 0 520 420" xmlns="http://www.w3.org/2000/svg"></svg>
          <div class="hint">ÙŠØ¹Ø±Ø¶ Pit + Travel + OH + Ù…Ù†ØµØ© Ø§Ù„ÙƒØ§Ø¨ÙŠÙ†Ø© + Ø£Ø¨Ø¹Ø§Ø¯ Ø§Ø±ØªÙØ§Ø¹ÙŠØ©.</div>
        </div>
      </div>
    </div>

  </div>
</div>

<script>
/* =======================
   Helpers
======================= */
const NS = "http://www.w3.org/2000/svg";
function el(name, attrs = {}) {
  const n = document.createElementNS(NS, name);
  for (const [k,v] of Object.entries(attrs)) n.setAttribute(k, String(v));
  return n;
}
function clear(svg){ while(svg.firstChild) svg.removeChild(svg.firstChild); }
function clamp(n, min, max){ return Math.max(min, Math.min(max, n)); }

function dimLine(svg, x1,y1,x2,y2, text, textX, textY){
  // line
  svg.appendChild(el('line',{x1,y1,x2,y2, stroke:"#111827", "stroke-width":"1"}));
  // arrows
  const a1 = el('path',{d:`M ${x1} ${y1} l 8 -4 l 0 8 z`, fill:"#111827"});
  const a2 = el('path',{d:`M ${x2} ${y2} l -8 -4 l 0 8 z`, fill:"#111827"});
  svg.appendChild(a1); svg.appendChild(a2);
  // text (label)
  const t = el('text',{x:textX, y:textY, "font-size":"12", fill:"#111827"});
  t.textContent = text;
  svg.appendChild(t);
}
function centerLine(svg, x1,y1,x2,y2){
  svg.appendChild(el('line',{x1,y1,x2,y2, stroke:"#6b7280", "stroke-width":"1", "stroke-dasharray":"6 4"}));
}
function hatchDefs(svg){
  const defs = el('defs');
  const pat = el('pattern',{id:"hatch", patternUnits:"userSpaceOnUse", width:"8", height:"8", patternTransform:"rotate(45)"});
  pat.appendChild(el('line',{x1:"0",y1:"0",x2:"0",y2:"8", stroke:"#cbd5e1", "stroke-width":"2"}));
  defs.appendChild(pat);

  const marker = el('marker',{
    id:"arrow", viewBox:"0 0 10 10", refX:"5", refY:"5",
    markerWidth:"6", markerHeight:"6", orient:"auto-start-reverse"
  });
  marker.appendChild(el('path',{d:"M 0 0 L 10 5 L 0 10 z", fill:"#111827"}));
  defs.appendChild(marker);

  svg.appendChild(defs);
}

function exportSVG(svg, filename){
  const serializer = new XMLSerializer();
  const source = serializer.serializeToString(svg);
  const blob = new Blob([source], {type: "image/svg+xml;charset=utf-8"});
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url; a.download = filename;
  document.body.appendChild(a);
  a.click();
  a.remove();
  URL.revokeObjectURL(url);
}

/* =======================
   Drawing Logic
======================= */
function draw(){
  const shaftW = Number(document.getElementById('shaftW').value);
  const shaftD = Number(document.getElementById('shaftD').value);
  const cabinW = Number(document.getElementById('cabinW').value);
  const cabinD = Number(document.getElementById('cabinD').value);
  const doorW  = Number(document.getElementById('doorW').value);
  const wallT  = Number(document.getElementById('wallT').value);
const cwSide = document.getElementById('cwSide')?.value || 'right';

  const stops  = Number(document.getElementById('stops').value);
  const floorH = Number(document.getElementById('floorH').value);
  const pit    = Number(document.getElementById('pit').value);
  const oh     = Number(document.getElementById('oh').value);

  const travel = (Math.max(stops,2)-1) * floorH;

  // basic guards (keep drawing sensible)
  const cabinW2 = clamp(cabinW, 600, shaftW-200);
  const cabinD2 = clamp(cabinD, 600, shaftD-200);
  const doorW2  = clamp(doorW, 600, shaftW-200);
  const wallT2  = clamp(wallT, 100, 400);

  document.getElementById('badgeInfo').textContent =
    `Shaft ${shaftW}Ã—${shaftD} | Cabin ${cabinW2}Ã—${cabinD2} | Door ${doorW2} | Travel ${travel} | Pit ${pit} | OH ${oh}`;

  drawPlan(shaftW, shaftD, cabinW2, cabinD2, doorW2, wallT2);
drawSection(travel, pit, oh, shaftW, cabinW2, cwSide);


}

function drawPlan(shaftW, shaftD, cabinW, cabinD, doorW, wallT){
  const svg = document.getElementById('svgPlan');
  clear(svg);
  hatchDefs(svg);

  // scale: 1px = 5mm (fixed)
  const scale = 5;

  // layout box
  const W = 520, H = 420;
  const pad = 46;

  // convert mm->px within viewBox
  const innerW = shaftW / scale;
  const innerD = shaftD / scale;

  // fit inside viewbox while preserving ratio
  const maxW = W - pad*2;
  const maxH = H - pad*2;
  const f = Math.min(maxW/innerW, maxH/innerD);

  const sW = innerW * f;
  const sD = innerD * f;

  const x0 = (W - sW)/2;
  const y0 = (H - sD)/2;

  // wall thickness in px
  const t = (wallT/scale) * f;

  // OUTER (walls with hatch)
  svg.appendChild(el('rect',{
    x:x0 - t, y:y0 - t, width:sW + 2*t, height:sD + 2*t,
    fill:"url(#hatch)", stroke:"#111827", "stroke-width":"2"
  }));

  // INNER opening
  svg.appendChild(el('rect',{
    x:x0, y:y0, width:sW, height:sD,
    fill:"#ffffff", stroke:"#111827", "stroke-width":"2"
  }));

  /* =========================
     DOOR opening (bottom side)
  ========================= */
  const doorPx = (doorW/scale) * f;
  const doorX = x0 + (sW - doorPx)/2;
  const doorY = y0 + sD;

  // erase wall line for opening
  svg.appendChild(el('line',{x1:doorX, y1:doorY, x2:doorX+doorPx, y2:doorY, stroke:"#ffffff", "stroke-width":"6"}));

  // jambs
  svg.appendChild(el('line',{x1:doorX, y1:doorY-10, x2:doorX, y2:doorY+10, stroke:"#111827", "stroke-width":"2"}));
  svg.appendChild(el('line',{x1:doorX+doorPx, y1:doorY-10, x2:doorX+doorPx, y2:doorY+10, stroke:"#111827", "stroke-width":"2"}));

  const dlab = el('text',{x:doorX+doorPx/2, y:doorY+28, "font-size":"12", fill:"#111827", "text-anchor":"middle"});
  dlab.textContent = `DOOR ${doorW}mm`;
  svg.appendChild(dlab);

  /* =========================
     CABIN centered
  ========================= */
  const cW = (cabinW/scale) * f;
  const cD = (cabinD/scale) * f;
  const cx = x0 + (sW - cW)/2;
  const cy = y0 + (sD - cD)/2;

  // cabin
  svg.appendChild(el('rect',{x:cx, y:cy, width:cW, height:cD, fill:"#f8fafc", stroke:"#111827", "stroke-width":"2", rx:"6"}));
  svg.appendChild(el('rect',{x:cx+6, y:cy+6, width:cW-12, height:cD-12, fill:"#ffffff", stroke:"#cbd5e1", "stroke-width":"1", rx:"4"}));

  /* =========================
     REAR COUNTERWEIGHT (Top side)
     - placed behind cabin near the rear wall
  ========================= */
  // rear clearance zone near top wall
  const rearMargin = Math.max(10, sD * 0.06);

  // CW width ~ 12% of shaft width, depth ~ 10% of shaft depth (symbolic)
  const cwW = clamp(sW * 0.12, 22, 44);
  const cwD = clamp(sD * 0.10, 18, 36);

  // Put CW at top (rear) centered with cabin width area
  const cwX = x0 + (sW - cwW)/2;
  const cwY = y0 + rearMargin;

  svg.appendChild(el('rect',{
    x:cwX, y:cwY, width:cwW, height:cwD,
    fill:"#f8fafc", stroke:"#111827", "stroke-width":"2", rx:"4"
  }));

  const cwt = el('text',{
    x:cwX+cwW/2, y:cwY-6,
    "font-size":"11", fill:"#111827", "text-anchor":"middle"
  });
  cwt.textContent = "CW (REAR)";
  svg.appendChild(cwt);

  /* =========================
     RAILS (Plan)
  ========================= */
  // Cabin rails: left/right of cabin
  const railStroke = 1.4;
  const railDash = "6 4";

  const cabRailL = cx - 8;
  const cabRailR = cx + cW + 8;

  svg.appendChild(el('line',{x1:cabRailL, y1:y0, x2:cabRailL, y2:y0+sD, stroke:"#6b7280","stroke-width":railStroke,"stroke-dasharray":railDash}));
  svg.appendChild(el('line',{x1:cabRailR, y1:y0, x2:cabRailR, y2:y0+sD, stroke:"#6b7280","stroke-width":railStroke,"stroke-dasharray":railDash}));

  // CW rails: small pair around CW
  const cwRailL = cwX - 6;
  const cwRailR = cwX + cwW + 6;

  svg.appendChild(el('line',{x1:cwRailL, y1:y0, x2:cwRailL, y2:y0+sD*0.45, stroke:"#6b7280","stroke-width":railStroke,"stroke-dasharray":railDash}));
  svg.appendChild(el('line',{x1:cwRailR, y1:y0, x2:cwRailR, y2:y0+sD*0.45, stroke:"#6b7280","stroke-width":railStroke,"stroke-dasharray":railDash}));

  /* =========================
     CENTER LINES
  ========================= */
  centerLine(svg, x0, y0 + sD/2, x0 + sW, y0 + sD/2);
  centerLine(svg, x0 + sW/2, y0, x0 + sW/2, y0 + sD);

  /* =========================
     DIMENSIONS (overall shaft)
  ========================= */
  // horizontal
  dimLine(svg, x0, y0-24, x0+sW, y0-24, `${shaftW} mm`, x0 + sW/2 - 24, y0-30);
  // vertical
  dimLine(svg, x0-24, y0, x0-24, y0+sD, `${shaftD} mm`, x0-40, y0 + sD/2);

  /* =========================
     TITLE
  ========================= */
  const title = el('text',{x:14,y:18,"font-size":"13",fill:"#111827"});
  title.textContent = "PLAN VIEW (REAR CW)";
  svg.appendChild(title);
}


function drawSection(travel, pit, oh, shaftW, cabinW, cwSide){
  const svg = document.getElementById('svgSec');
  clear(svg);
  hatchDefs(svg);

  const W = 520, H = 420;
  const pad = 52;

  // Ù…Ù‚ÙŠØ§Ø³ Ø§Ù„Ø±Ø³Ù…
  const mmPerPx = 10;

  const totalH = pit + travel + oh;

  // mm â†’ px (Ù‚Ø¨Ù„ Ø§Ù„Ù€ fit)
  const shaftW_px_raw = shaftW / mmPerPx;
  const totalH_px_raw = totalH / mmPerPx;

  const usableW = W - pad * 2;
  const usableH = H - pad * 2;

  const fit = Math.min(usableW / shaftW_px_raw, usableH / totalH_px_raw);

  const shaftPxW = shaftW_px_raw * fit;
  const shaftPxH = totalH_px_raw * fit;

  const x0 = (W - shaftPxW) / 2;
  const yTop = pad;

  // Ø³Ù…Ø§ÙƒØ© Ø§Ù„Ø¬Ø¯Ø§Ø± (Ø±Ù…Ø²ÙŠØ©)
  const wallT = 18;

  /* ======================
     SHAFT WALLS
  ====================== */
  svg.appendChild(el('rect',{
    x: x0 - wallT, y: yTop,
    width: shaftPxW + wallT * 2, height: shaftPxH,
    fill: "url(#hatch)",
    stroke: "#111827", "stroke-width": "2"
  }));

  svg.appendChild(el('rect',{
    x: x0, y: yTop,
    width: shaftPxW, height: shaftPxH,
    fill: "#ffffff",
    stroke: "#111827", "stroke-width": "2"
  }));

  /* ======================
     ZONES
  ====================== */
  const pitH_px    = (pit / mmPerPx) * fit;
  const travelH_px = (travel / mmPerPx) * fit;
  const ohH_px     = (oh / mmPerPx) * fit;

  const yTravelTop = yTop + ohH_px;          // Ù†Ù‡Ø§ÙŠØ© OH
  const yPitTop    = yTravelTop + travelH_px;// Ù†Ù‡Ø§ÙŠØ© Travel / Ø¨Ø¯Ø§ÙŠØ© Pit
  const yBottom    = yTop + shaftPxH;        // Ø£Ø±Ø¶ÙŠØ© Pit

  // Ø®Ø·ÙˆØ· Ø§Ù„ÙØµÙ„
  svg.appendChild(el('line',{x1:x0,y1:yTravelTop,x2:x0+shaftPxW,y2:yTravelTop,stroke:"#cbd5e1","stroke-width":"2"}));
  svg.appendChild(el('line',{x1:x0,y1:yPitTop,   x2:x0+shaftPxW,y2:yPitTop,   stroke:"#cbd5e1","stroke-width":"2"}));
  svg.appendChild(el('line',{x1:x0,y1:yBottom,   x2:x0+shaftPxW,y2:yBottom,   stroke:"#111827","stroke-width":"2"}));

  /* ======================
     MRL ELEMENTS (1:1) + Side CW
  ====================== */
  const marginSide = Math.max(10, shaftPxW * 0.06);
  const gap = 10;

  // Counterweight
  const cwW = clamp(shaftPxW * 0.10, 18, 34);
  const cwH = clamp(shaftPxH * 0.18, 70, 120);

  // Cabin
  const cabinW_px = (cabinW / mmPerPx) * fit;
  const cabH = clamp(shaftPxH * 0.16, 70, 110);

  const maxCabW = shaftPxW - (marginSide * 2) - cwW - gap;
  const cabW = clamp(cabinW_px, 60, maxCabW);

  const midY = yTravelTop + travelH_px / 2;

  let cwX, cabX;
  if (cwSide === 'left') {
    cwX  = x0 + marginSide;
    cabX = cwX + cwW + gap;
  } else {
    cabX = x0 + marginSide;
    cwX  = x0 + shaftPxW - cwW - marginSide;
  }

  const cwY  = midY - cwH / 2;
  const cabY = midY - cabH / 2;

  /* ======================
     RAILS (Cabin + CW)
  ====================== */
  // Rails Ø³Ù…Ø§ÙƒØªÙ‡Ø§ Ø¨Ø³ÙŠØ·Ø© + Ù…ØªÙ‚Ø·Ø¹Ø© Ø®ÙÙŠÙØ©
  const railStroke = 1.6;
  const railDash = "7 5";

  // Cabin rails: ÙŠÙ…ÙŠÙ† ÙˆÙŠØ³Ø§Ø± Ø§Ù„ÙƒØ§Ø¨ÙŠÙ†Ø©
  const cabRailL = cabX - 6;
  const cabRailR = cabX + cabW + 6;
  svg.appendChild(el('line',{x1:cabRailL, y1:yTravelTop+6, x2:cabRailL, y2:yBottom-6, stroke:"#6b7280","stroke-width":railStroke,"stroke-dasharray":railDash}));
  svg.appendChild(el('line',{x1:cabRailR, y1:yTravelTop+6, x2:cabRailR, y2:yBottom-6, stroke:"#6b7280","stroke-width":railStroke,"stroke-dasharray":railDash}));

  // CW rail: Ø®Ø· ÙˆØ§Ø­Ø¯ Ø¹Ù„Ù‰ Ù…Ù†ØªØµÙ Ø§Ù„ÙƒÙˆÙ†ØªØ±ÙˆÙŠØª
  const cwRailX = cwX + cwW/2;
  svg.appendChild(el('line',{x1:cwRailX, y1:yTravelTop+6, x2:cwRailX, y2:yBottom-6, stroke:"#6b7280","stroke-width":railStroke,"stroke-dasharray":railDash}));

  // Labels Ù„Ù„Ù€ Rails (Ø§Ø®ØªÙŠØ§Ø±ÙŠ Ø¨Ø³ÙŠØ·)
  const rlab = el('text',{x:x0+8, y:yTravelTop+32, "font-size":"10", fill:"#6b7280"});
  rlab.textContent = "Rails";
  svg.appendChild(rlab);

  /* ======================
     DRAW CW + CABIN
  ====================== */
  // Counterweight
  svg.appendChild(el('rect',{
    x:cwX,y:cwY,width:cwW,height:cwH,
    fill:"#f8fafc",stroke:"#111827","stroke-width":"2",rx:"4"
  }));
  const cwt = el('text',{
    x:cwX+cwW/2,y:cwY+cwH+16,
    "font-size":"11",fill:"#111827","text-anchor":"middle"
  });
  cwt.textContent="CW";
  svg.appendChild(cwt);

  // Cabin
  svg.appendChild(el('rect',{
    x:cabX,y:cabY,width:cabW,height:cabH,
    fill:"#f8fafc",stroke:"#111827","stroke-width":"2",rx:"6"
  }));
  const ct = el('text',{
    x:cabX+cabW/2,y:cabY+cabH/2+4,
    "font-size":"12",fill:"#111827","text-anchor":"middle"
  });
  ct.textContent="CABIN";
  svg.appendChild(ct);

  /* ======================
     BUFFERS (in PIT)
  ====================== */
  // Ù†Ø±Ø³Ù… Buffer Ù„Ù„ÙƒØ§Ø¨ÙŠÙ†Ø© + Buffer Ù„Ù„ÙƒÙˆÙ†ØªØ±ÙˆÙŠØª Ø¯Ø§Ø®Ù„ Ø§Ù„Ù€ pit
  // (Ø±Ù…Ø²ÙŠ Ù„ÙƒÙ† Ø¨Ù…ÙƒØ§Ù†Ù‡ Ø§Ù„ØµØ­ÙŠØ­ ØªØ­Øª Ø§Ù„Ø¹Ù†Ø§ØµØ±)
  const bufW = 26, bufH = 18;
  const pitFloorY = yBottom;          // Ø£Ø±Ø¶ÙŠØ© pit
  const bufTopY = pitFloorY - 24;     // Ù…Ø³Ø§ÙØ© ÙÙˆÙ‚ Ø§Ù„Ø£Ø±Ø¶

  // Cabin buffer (ÙˆØ³Ø· Ø§Ù„ÙƒØ§Ø¨ÙŠÙ†Ø©)
  const cabBufX = cabX + cabW/2 - bufW/2;
  svg.appendChild(el('rect',{
    x:cabBufX, y:bufTopY, width:bufW, height:bufH,
    fill:"#ffffff", stroke:"#111827", "stroke-width":"2", rx:"4"
  }));
  const b1 = el('text',{x:cabBufX+bufW/2, y:bufTopY-6, "font-size":"10", fill:"#6b7280", "text-anchor":"middle"});
  b1.textContent="Buffer";
  svg.appendChild(b1);

  // CW buffer (ØªØ­Øª Ø§Ù„ÙƒÙˆÙ†ØªØ±ÙˆÙŠØª)
  const cwBufX = cwX + cwW/2 - bufW/2;
  svg.appendChild(el('rect',{
    x:cwBufX, y:bufTopY, width:bufW, height:bufH,
    fill:"#ffffff", stroke:"#111827", "stroke-width":"2", rx:"4"
  }));

  /* ======================
     GOVERNOR (Symbolic) in OH
  ====================== */
  // Governor sheave + Ø®Ø· rope Ù†Ø²ÙˆÙ„Ø§Ù‹ Ø¨Ø¬Ø§Ù†Ø¨ Ø§Ù„Ø¨Ø¦Ø±
  const govR = 14;
  const govX = x0 + shaftPxW - marginSide - 20;
  const govY = yTop + Math.max(16, ohH_px * 0.20);

  svg.appendChild(el('circle',{cx:govX, cy:govY, r:govR, fill:"#fff", stroke:"#111827","stroke-width":"2"}));
  svg.appendChild(el('circle',{cx:govX, cy:govY, r:3, fill:"#111827"}));

  const gtxt = el('text',{x:govX, y:govY-govR-8, "font-size":"10", fill:"#6b7280", "text-anchor":"middle"});
  gtxt.textContent = "GOV";
  svg.appendChild(gtxt);

  // Governor rope line (Ø±Ù…Ø²ÙŠ) Ù†Ø²ÙˆÙ„Ø§Ù‹ Ø¥Ù„Ù‰ pit
  svg.appendChild(el('line',{
    x1:govX, y1:govY+govR,
    x2:govX, y2:yBottom-6,
    stroke:"#111827", "stroke-width":"1.2", "stroke-dasharray":"4 4"
  }));

  /* ======================
     MRL MACHINE + SHEAVE
  ====================== */
  const machW = clamp(shaftPxW * 0.45, 90, 160);
  const machH = 44;
  const machX = x0 + marginSide;
  const machY = yTop + Math.max(14, ohH_px * 0.12);

  svg.appendChild(el('rect',{
    x:machX,y:machY,width:machW,height:machH,
    fill:"#ffffff",stroke:"#111827","stroke-width":"2",rx:"6"
  }));
  const mt = el('text',{
    x:machX+machW/2,y:machY+machH/2+4,
    "font-size":"12",fill:"#111827","text-anchor":"middle"
  });
  mt.textContent="MRL MACHINE";
  svg.appendChild(mt);

  const shR = 16;
  const shX = machX + machW + 22;
  const shY = machY + machH / 2;

  svg.appendChild(el('circle',{cx:shX,cy:shY,r:shR,fill:"#fff",stroke:"#111827","stroke-width":"2"}));
  svg.appendChild(el('circle',{cx:shX,cy:shY,r:4,fill:"#111827"}));

  /* ======================
     ROPES (1:1)
  ====================== */
  const cwCenterX = cwX + cwW / 2;
  const cabRopeX  = cabX + cabW * 0.18;

  svg.appendChild(el('path',{
    d:`M ${shX-10} ${shY+shR} L ${cabRopeX} ${cabY} L ${cabRopeX} ${cabY+cabH}`,
    fill:"none",stroke:"#111827","stroke-width":"1.6"
  }));

  svg.appendChild(el('path',{
    d:`M ${shX+10} ${shY+shR} L ${cwCenterX} ${cwY} L ${cwCenterX} ${cwY+cwH}`,
    fill:"none",stroke:"#111827","stroke-width":"1.6"
  }));

  /* ======================
     CONTROLLER
  ====================== */
  const ctrlW = 62, ctrlH = 70;
  const ctrlX = x0 + shaftPxW + 20;
  const ctrlY = yTravelTop + 10;

  svg.appendChild(el('rect',{
    x:ctrlX,y:ctrlY,width:ctrlW,height:ctrlH,
    fill:"#ffffff",stroke:"#111827","stroke-width":"2",rx:"6"
  }));

  const k1 = el('text',{
    x:ctrlX+ctrlW/2,y:ctrlY+28,
    "font-size":"11",fill:"#111827","text-anchor":"middle"
  });
  k1.textContent="CTRL";
  svg.appendChild(k1);

  const k2 = el('text',{
    x:ctrlX+ctrlW/2,y:ctrlY+46,
    "font-size":"10",fill:"#6b7280","text-anchor":"middle"
  });
  k2.textContent="Panel";
  svg.appendChild(k2);

  /* ======================
     DIMENSIONS
  ====================== */
  const dx1 = x0 + shaftPxW + 96;
  const dx2 = x0 + shaftPxW + 120;

  dimLine(svg, dx2, yTop,       dx2, yTop+shaftPxH, `${totalH} mm`, dx2+12, yTop+shaftPxH/2);
  dimLine(svg, dx1, yTop,       dx1, yTravelTop,    `${oh} mm`,     dx1+10, yTop+ohH_px/2);
  dimLine(svg, dx1, yTravelTop, dx1, yPitTop,       `${travel} mm`, dx1+10, yTravelTop+travelH_px/2);
  dimLine(svg, dx1, yPitTop,    dx1, yBottom,       `${pit} mm`,    dx1+10, yPitTop+pitH_px/2);

  const yDim = yTop + shaftPxH + 26;
  svg.appendChild(el('line',{x1:x0,y1:yDim,x2:x0+shaftPxW,y2:yDim,stroke:"#111827","stroke-width":"1"}));
  svg.appendChild(el('path',{d:`M ${x0} ${yDim} l 8 -4 l 0 8 z`, fill:"#111827"}));
  svg.appendChild(el('path',{d:`M ${x0+shaftPxW} ${yDim} l -8 -4 l 0 8 z`, fill:"#111827"}));

  const wtxt = el('text',{
    x:x0+shaftPxW/2,y:yDim-6,
    "font-size":"12",fill:"#111827","text-anchor":"middle"
  });
  wtxt.textContent = `SHAFT W = ${shaftW} mm`;
  svg.appendChild(wtxt);

  /* ======================
     LABELS
  ====================== */
  const t1 = el('text',{x:14,y:18,"font-size":"13",fill:"#111827"});
  t1.textContent="SECTION VIEW (MRL â€¢ 1:1 â€¢ Rails â€¢ Buffers â€¢ Governor)";
  svg.appendChild(t1);

  const z1 = el('text',{x:x0+8,y:yTop+16,"font-size":"11",fill:"#6b7280"}); z1.textContent="OH"; svg.appendChild(z1);
  const z2 = el('text',{x:x0+8,y:yTravelTop+16,"font-size":"11",fill:"#6b7280"}); z2.textContent="TRAVEL"; svg.appendChild(z2);
  const z3 = el('text',{x:x0+8,y:yPitTop+16,"font-size":"11",fill:"#6b7280"}); z3.textContent="PIT"; svg.appendChild(z3);
}




/* =======================
   Events
======================= */
document.getElementById('btnDraw').addEventListener('click', draw);
document.getElementById('btnExportSVG').addEventListener('click', () => {
  // ÙŠØµØ¯Ø± Ø§Ù„Ù…Ø®Ø·Ø·ÙŠÙ† ÙƒÙ€ SVG Ù…Ù†ÙØµÙ„ÙŠÙ†
  exportSVG(document.getElementById('svgPlan'), 'lift-plan.svg');
  exportSVG(document.getElementById('svgSec'), 'lift-section.svg');
});

// auto draw
draw();
</script>
</body>
</html>
