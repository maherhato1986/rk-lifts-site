<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
   
<style>

/* =================================================
   إعدادات عامة (عرض الشاشة فقط)
================================================= */
body {
  font-family: "Cairo", system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
  background: #f3f4f6;
  margin: 0;
  padding: 20px;
  color: #111827;
}

/* الصفحة في العرض */
.page {
  max-width: 900px;
  margin: 0 auto;
  background: #fff;
  padding: 20px;
  box-shadow: 0 4px 14px rgba(0,0,0,0.08);
  box-sizing: border-box;
}

/* =================================================
   Editable
================================================= */
body[contenteditable="true"] { cursor: text; }
[contenteditable="true"]:focus { outline: none; }
.editable-highlight:hover { background: rgba(59,130,246,0.06); }

/* =================================================
   Header
================================================= */
.page-header {
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  border-bottom: 2px solid #e5e7eb;
  padding-bottom: 8px;
  margin-bottom: 12px;
  font-size: 12px;
}

.header-left { text-align: right; }
.header-right { text-align: left; }

.logo-title { font-weight: 700; font-size: 18px; }
.logo-sub {
  font-size: 11px;
  color: #6b7280;
  line-height: 1.5;
}

/* =================================================
   العناوين
================================================= */
h1.main-title {
  text-align: center;
  font-size: 18px;
  margin: 10px 0 18px;
}

.section-title {
  font-weight: 700;
  font-size: 14px;
  margin: 18px 0 8px;
  border-right: 4px solid #2563eb;
  padding-right: 6px;
}

/* =================================================
   الجداول (عرض الشاشة)
================================================= */
table {
  width: 100%;
  border-collapse: collapse;
  font-size: 12px;
}

th, td {
  border: 1px solid #d1d5db;
  padding: 6px 8px;
  vertical-align: top;
}

th {
  background: #f9fafb;
  font-weight: 600;
}

.spec-table th { width: 22%; background: #f8fafc; }
.spec-table td { width: 28%; }

/* =================================================
   تقسيمات
================================================= */
.two-col {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 12px;
}

.small-note {
  font-size: 11px;
  color: #6b7280;
}

.terms p {
  font-size: 11.5px;
  margin: 4px 0;
  text-align: justify;
}

/* =================================================
   غلاف PDF
================================================= */
.pdf-cover {
  padding: 0 !important;
}

.fixed-pdf-img {
  width: 100%;
  display: block;
}

/* =================================================
   الشعارات
================================================= */
.partners-logos img {
  max-width: 180px;
  max-height: 90px;
  object-fit: contain;
  display: block;
  margin: 0 auto;
}

/* =================================================
   زر الطباعة
================================================= */
.btn-print {
  display: inline-block;
  margin: 12px auto 0;
  padding: 8px 18px;
  font-size: 13px;
  background: #2563eb;
  color: #fff;
  border-radius: 4px;
  border: none;
  cursor: pointer;
}

/* =================================================
   ================== الطباعة ==================
================================================= */
@media print {

 @page {
  size: A4;
  margin: 0;
}


  html, body {
    margin: 0 !important;
    padding: 0 !important;
    background: #fff !important;
    -webkit-print-color-adjust: exact !important;
    print-color-adjust: exact !important;
  }

  /* كل صفحة = ورقة A4 مستقلة */
  .page {
    width: 210mm !important;
    min-height: 297mm !important;
    margin: 0 !important;
    padding: 15mm !important;
    box-sizing: border-box !important;

    page-break-after: always !important;
    break-after: page !important;

    display: block !important;
    position: relative !important;
    overflow: hidden !important;

    box-shadow: none !important;
  }

  .page:last-child {
    page-break-after: auto !important;
  }

  /* الغلاف */
  .pdf-cover {
    padding: 0 !important;
  }

  .pdf-cover img,
  .fixed-pdf-img {
    width: 210mm !important;
    height: 297mm !important;
    object-fit: cover !important;
    display: block !important;
  }

  /* الجداول – السماح بالكسر الطبيعي */
  table {
    page-break-inside: auto !important;
    break-inside: auto !important;
  }

  thead {
    display: table-header-group !important;
  }

  tr {
    page-break-inside: avoid !important;
    break-inside: avoid !important;
  }

  /* إلغاء grid / flex في الطباعة */
  .two-col,
  .page-header,
  .partners-logos {
    display: block !important;
  }

  /* إخفاء زر الطباعة */
  .btn-print {
    display: none !important;
  }
}

</style>


</head>


   <body contenteditable="true" spellcheck="false">

 


<!-- ================= صفحة غلاف 1 ================= -->
<div class="page pdf-cover">
  <img src="/public/images/FIRST_PAGE_RKL1.png" class="fixed-pdf-img">
</div>

<!-- ================= صفحة غلاف 2 ================= -->
<div class="page pdf-cover">
  <img src="/public/images/FIRST_PAGE_RKL2.png" class="fixed-pdf-img">
</div>

<!-- ================= صفحة 1: تعريف RKL + ملف العميل ================= -->
<!-- ===== Header ===== -->
<div class="page-header">
  
  <!-- الشعار -->
  <div class="header-logo">
    <img src="/public/images/logo.png" alt="RKL Logo">
  </div>

  <!-- بيانات الشركة -->
  <div class="header-center">
    <div class="company-name">RKL للمصاعد والسلالم الكهربائية</div>
    <div class="company-sub">
      السجل التجاري: 1010709355 – الرقم الضريبي: 302250422600003<br>
      السليمانية – الرياض – هاتف: 0114774021 – WWW.RKL.SA
    </div>
  </div>

  <!-- رقم وتاريخ العرض -->
  <div class="header-meta">
    <div>رقم العرض:<br><strong class="bind_quote_number">—</strong></div>
    <div>تاريخ العرض:<br><strong class="bind_offer_date">—</strong></div>
  </div>

</div>



  <!-- ===== Title ===== -->
  <h1 class="main-title">عرض سعر توريد وتركيب وتشغيل مصعد كهربائي</h1>

  <!-- ===== About RKL ===== -->
  <div class="section-title">أولاً: نبذة عن مؤسسة آر كي ال RKL</div>
  <p class="small-note editable" contenteditable="true">
    مؤسسة سعودية متخصصة في توريد وتركيب وصيانة المصاعد والسلالم الكهربائية،
    تعمل وفق أعلى معايير الجودة والسلامة، وتمتلك شراكات مع مصانع عالمية،
    مع خبرة في تنفيذ مشاريع حكومية وخاصة في مختلف مناطق المملكة.
  </p>

  <!-- ===== Client File ===== -->
  <div class="section-title">ثانياً: ملف العميل</div>

  <div class="formal-letter">
    
      إشارةً إلى طلبكم الكريم، نفيدكم بأن
      <strong>مؤسسة آر كي ال RKL للمصاعد والسلالم الكهربائية</strong>
      قامت بإعداد هذا العرض الفني والمالي بناءً على البيانات والمعلومات الرسمية
      المقدمة من طرفكم، وذلك وفق التفاصيل الموضحة أدناه.
   
  </div>

<!-- ===== Client Data – Formal Letter Style ===== -->
<div class="client-letter-box">

  <div class="client-line">
    <span>اسم العميل:</span>
    <strong class="bind_customer_name">—</strong>
    <span class="sep">|</span>
    <span>نوع العميل:</span>
    <strong class="bind_customer_type">—</strong>
  </div>

  <div class="client-line">
    <span>الشخص المسؤول:</span>
    <strong class="bind_contact_person">—</strong>
    <span class="sep">|</span>
    <span>السجل التجاري:</span>
    <strong class="bind_cr_number">—</strong>
  </div>

  <div class="client-line">
    <span>الرقم الضريبي:</span>
    <strong class="bind_tax_number">—</strong>
    <span class="sep">|</span>
    <span>رقم الهاتف:</span>
    <strong class="bind_customer_phone">—</strong>
  </div>

  <div class="client-line">
    <span>البريد الإلكتروني:</span>
    <strong class="bind_customer_email">—</strong>
  </div>

  <div class="client-line">
    <span>العنوان:</span>
    <strong>
      <span class="bind_city">—</span> /
      <span class="bind_district">—</span> /
      <span class="bind_street">—</span> /
      مبنى <span class="bind_building_number">—</span> /
      <span class="bind_postal_code">—</span>
    </strong>
  </div>

  <div class="client-line">
    <span>العنوان الوطني:</span>
    <strong class="bind_national_address">—</strong>
  </div>

</div>

  <!-- ===== Elevator Data ===== -->
  <div class="section-title" style="margin-top:20px">
    ثالثاً: بيانات المصاعد الخاصة بالمشروع
  </div>

  <p class="small-note">
    فيما يلي البيانات الفنية الأساسية للمصاعد المطلوبة للمشروع، وذلك حسب المعلومات المعتمدة من طرفكم:
  </p>

  <!-- ===== Table Wrap (important) ===== -->
  <div class="table-wrap">
    <table class="spec-table">
      <tbody>

        <tr>
          <th>اسم المشروع</th>
          <td class="bind_project_name">—</td>
          <th>موقع المشروع</th>
          <td class="bind_project_location">—</td>
        </tr>

        <tr>
          <th>ماركة المصعد</th>
          <td class="bind_brand">—</td>
          <th>نوع الاستخدام</th>
          <td class="bind_usage">Passenger Elevator</td>
        </tr>

        <tr>
          <th>عدد المصاعد</th>
          <td class="bind_lifts">—</td>
          <th>الحمولة الاسمية (kg)</th>
          <td class="bind_capacity">—</td>
        </tr>

        <tr>
          <th>السرعة (m/s)</th>
          <td class="bind_speed">—</td>
          <th>عدد التوقفات (Stops)</th>
          <td class="bind_stops">—</td>
        </tr>

        <tr>
          <th>ارتفاع الدور الواحد (FH)</th>
          <td class="bind_fh">—</td>
          <th>ارتفاع الرحلة الكلي (TH)</th>
          <td class="bind_th">—</td>
        </tr>

        <tr>
          <th>نظام التركيب</th>
          <td colspan="3" class="bind_machine_type">
            MRL – Machine Room Less
          </td>
        </tr>

      </tbody>
    </table>
  </div>

</div>
<!-- ================= End Page ================= -->

    <!-- ================= Page 2: RKL Coverage ================= -->
<!-- ===== Header ===== -->
<div class="page-header">
  
  <!-- الشعار -->
  <div class="header-logo">
    <img src="/public/images/logo.png" alt="RKL Logo">
  </div>

  <!-- بيانات الشركة -->
  <div class="header-center">
    <div class="company-name">RKL للمصاعد والسلالم الكهربائية</div>
    <div class="company-sub">
      السجل التجاري: 1010709355 – الرقم الضريبي: 302250422600003<br>
      السليمانية – الرياض – هاتف: 0114774021 – WWW.RKL.SA
    </div>
  </div>

  <!-- رقم وتاريخ العرض -->
  <div class="header-meta">
    <div>رقم العرض:<br><strong class="bind_quote_number">—</strong></div>
    <div>تاريخ العرض:<br><strong class="bind_offer_date">—</strong></div>
  </div>

</div>





  <div style="display:flex;gap:30px;margin-top:20px;align-items:flex-start">

    <!-- صورة الخريطة -->
    <div style="width:50%">
      <img
        src="/public/images/ksa-map.png"
        alt="RKL Coverage Map"
        style="width:100%;border-radius:10px;border:1px solid #e5e7eb"
      />
      <div style="font-size:11px;color:#6b7280;margin-top:6px;text-align:center">
        التوزيع الجغرافي لأعمال RKL داخل المملكة العربية السعودية
      </div>
    </div>

    <!-- جدول المناطق -->
    <div style="width:50%">
      <h4 style="margin:0 0 10px 0">
        ثالثا ملخص الأعمال حسب المناطق
      </h4>

      <table>
        <thead>
          <tr>
            <th>المنطقة</th>
            <th>Region</th>
            <th>عدد المصاعد</th>
            <th>Elevators</th>
          </tr>
        </thead>
         <tbody>
  <tr>
    <td>421</td>
    <td>421</td>
    <td>Riyadh</td>
    <td>الرياض</td>
  </tr>
  <tr>
    <td>98</td>
    <td>98</td>
    <td>Makkah</td>
    <td>مكة المكرمة</td>
  </tr>
  <tr>
    <td>72</td>
    <td>72</td>
    <td>Eastern Region</td>
    <td>المنطقة الشرقية</td>
  </tr>
  <tr>
    <td>34</td>
    <td>34</td>
    <td>Madinah</td>
    <td>المدينة المنورة</td>
  </tr>
  <tr>
    <td>26</td>
    <td>26</td>
    <td>Qassim</td>
    <td>القصيم</td>
  </tr>
  <tr>
    <td>19</td>
    <td>19</td>
    <td>Tabuk</td>
    <td>تبوك</td>
  </tr>
  <tr>
    <td>17</td>
    <td>17</td>
    <td>Hail</td>
    <td>حائل</td>
  </tr>
  <tr>
    <td>23</td>
    <td>23</td>
    <td>Najran</td>
    <td>نجران</td>
  </tr>
  <tr>
    <td>41</td>
    <td>41</td>
    <td>Asir & Jazan</td>
    <td>عسير وجازان</td>
  </tr>
</tbody>


      </table>
    </div>

  </div>
   <!-- =========================
     الاعتمادات والشراكات
========================= -->
<div class="section-title">الاعتمادات والشراكات الدولية</div>

<p class="section-text">
مؤسسة <strong>RKL للمصاعد والسلالم الكهربائية</strong> معتمدة في توريد وتنفيذ أنظمة المصاعد
من موردين عالميين، وتعمل وفق أعلى معايير الجودة الأوروبية واليابانية،
وبشراكات تقنية مباشرة مع الشركات المصنعة.
</p>

<div class="partners-logos">
  <div class="partner-box">
    <img src="public/images/fuji-logo.png" alt="FUJI Japan">
    <div class="partner-name">FUJI – Japan</div>
    <div class="partner-desc">مصاعد كهربائية – أنظمة MRL & Passenger</div>
  </div>

  <div class="partner-box">
    <img src="public/images/vertilift-logo.png" alt="VertiLift Italy">
    <div class="partner-name">VertiLift – Italy</div>
    <div class="partner-desc">مصاعد أوروبية – حلول حديثة</div>
  </div>
</div>

<!-- نبذة عن المؤسسة والمشاريع -->
<div style="margin-top:20px; border-top:1px solid #e5e7eb; padding-top:15px;">

  <strong>مشاريعنا داخل المملكة العربية السعودية</strong>
  <p style="font-size:12px; line-height:1.6; color:#374151; margin-top:6px;">
    مؤسسة RKL للمصاعد والسلالم الكهربائية هي مؤسسة سعودية متخصصة في توريد،
    تركيب، تحديث، وصيانة المصاعد الكهربائية بمختلف أنواعها. تمتلك المؤسسة خبرة عملية
    واسعة في تنفيذ المشاريع السكنية، التجارية، الطبية، والتعليمية، وقد نفذت أعمالها
    في عدة مناطق داخل المملكة العربية السعودية.
  </p>

  <p style="font-size:12px; line-height:1.6; color:#374151;">
    تضم سابقة أعمال المؤسسة عددًا كبيرًا من المصاعد التي تم تنفيذها وتشغيلها بنجاح،
    مع الالتزام الكامل بمعايير الجودة والسلامة المعتمدة، وتقديم حلول فنية موثوقة
    تتناسب مع متطلبات كل مشروع.
  </p>

  <hr style="border:none;border-top:1px dashed #d1d5db;margin:10px 0">

  <strong>About RKL Projects in Saudi Arabia</strong>
  <p style="font-size:12px; line-height:1.6; color:#374151; margin-top:6px;">
    RKL Elevators & Escalators is a Saudi-based company specialized in the supply,
    installation, modernization, and maintenance of elevators. The company has
    extensive experience in delivering residential, commercial, medical, and
    educational projects across multiple regions within the Kingdom of Saudi Arabia.
  </p>

  <p style="font-size:12px; line-height:1.6; color:#374151;">
    RKL’s portfolio includes a large number of successfully delivered elevators,
    fully compliant with international quality and safety standards, providing
    reliable long-term performance and user comfort.
  </p>

</div>


</div>


<!-- ================= صفحة 3: المواصفات الفنية العامة ================= -->
<!-- ===== Header ===== -->
<div class="page-header">
  
  <!-- الشعار -->
  <div class="header-logo">
    <img src="/public/images/logo.png" alt="RKL Logo">
  </div>

  <!-- بيانات الشركة -->
  <div class="header-center">
    <div class="company-name">RKL للمصاعد والسلالم الكهربائية</div>
    <div class="company-sub">
      السجل التجاري: 1010709355 – الرقم الضريبي: 302250422600003<br>
      السليمانية – الرياض – هاتف: 0114774021 – WWW.RKL.SA
    </div>
  </div>

  <!-- رقم وتاريخ العرض -->
  <div class="header-meta">
    <div>رقم العرض:<br><strong class="bind_quote_number">—</strong></div>
    <div>تاريخ العرض:<br><strong class="bind_offer_date">—</strong></div>
  </div>

</div>



<div class="section-title">رابعاً: المواصفات القياسية الثابتة لنظام المصعد</div>

<table class="info-table">
<thead>
<tr>
  <th style="width:40px">م</th>
  <th>البند</th>
  <th>الوصف</th>
  <th>ملاحظات</th>
</tr>
</thead>

<tbody>

<!-- ===== Drive & Control System ===== -->
<tr><td>1</td><td>Drive System</td><td>VVVF – Variable Voltage Variable Frequency</td><td>تشغيل ناعم واقتصادي</td></tr>
<tr><td>2</td><td>Power Saver</td><td>Included</td><td>توفير استهلاك الطاقة</td></tr>
<tr><td>3</td><td>Anti-vibration & Motion Smoothing</td><td>Included</td><td>تقليل الاهتزاز والضوضاء</td></tr>
<tr><td>4</td><td>Speed Governor</td><td>Included</td><td>مطابق EN81</td></tr>
<tr><td>5</td><td>Overload Protection</td><td>Included</td><td>حماية من زيادة الحمولة</td></tr>
<tr><td>6</td><td>Auto Park Function</td><td>Included</td><td>إيقاف تلقائي عند عدم الاستخدام</td></tr>

<!-- ===== Doors System ===== -->
<tr><td>7</td><td>Door Type</td><td>Automatic</td><td></td></tr>
<tr><td>8</td><td>Door Opening</td><td>Center Opening</td><td></td></tr>
<tr><td>9</td><td>Door Material</td><td>Stainless Steel</td><td>باب الكابينة</td></tr>
<tr><td>10</td><td>Landing Door Material</td><td>Stainless Steel</td><td>أبواب الأدوار</td></tr>

<!-- ===== COP & HOP ===== -->
<tr><td>11</td><td>COP Type</td><td>Hairline Stainless Steel</td><td></td></tr>
<tr><td>12</td><td>COP Buttons</td><td>ANOD / Push Button</td><td></td></tr>
<tr><td>13</td><td>Display</td><td>LCD Display</td><td></td></tr>
<tr><td>14</td><td>Display Size</td><td>4.3 Inch LCD</td><td></td></tr>
<tr><td>15</td><td>Language</td><td>English</td><td></td></tr>
<tr><td>16</td><td>HOP Type</td><td>Hairline Stainless Steel</td><td></td></tr>
<tr><td>17</td><td>Indicators</td><td>Location & Direction Indicator</td><td></td></tr>

<!-- ===== Electrical ===== -->
<tr><td>18</td><td>Power Supply</td><td>380V – 60Hz – 3 Phase</td><td>التغذية الرئيسية</td></tr>
<tr><td>19</td><td>Lighting Power</td><td>220V – 60Hz</td><td>إنارة الكابينة</td></tr>

<!-- ===== Safety Systems ===== -->
<tr><td>20</td><td>ARD</td><td>Automatic Rescue Device</td><td>إنزال تلقائي عند انقطاع التيار</td></tr>
<tr><td>21</td><td>Fireman Key</td><td>Included</td><td>وضع الطوارئ للحريق</td></tr>
<tr><td>22</td><td>Two-way Intercom System</td><td>Included</td><td>اتصال داخلي للطوارئ</td></tr>
<tr><td>23</td><td>Emergency Car Light</td><td>Included</td><td></td></tr>
<tr><td>24</td><td>Emergency Alarm Bell</td><td>Included</td><td></td></tr>
<tr><td>25</td><td>Electric Blower</td><td>Included</td><td>تهوية الكابينة</td></tr>
<tr><td>26</td><td>Fire & Earthquake Sensor Ready</td><td>Included</td><td>جاهز للربط مع أنظمة المبنى</td></tr>
<tr><td>27</td><td>Car Top Safety Guard</td><td>Included (for travel &gt; 450cm)</td><td></td></tr>
<tr><td>28</td><td>Door Lock Monitoring</td><td>Included</td><td></td></tr>
<tr><td>29</td><td>Door Opening Prevention</td><td>Included</td><td>منع الفتح أثناء الحركة</td></tr>
<tr><td>30</td><td>Full Height Sensor</td><td>Included</td><td></td></tr>
<tr><td>31</td><td>Safe Landing System</td><td>Included</td><td></td></tr>
<tr><td>32</td><td>Self-diagnostic Electronic Devices</td><td>Included</td><td>تشخيص الأعطال ذاتياً</td></tr>
<tr><td>33</td><td>Phase / Voltage Protection</td><td>Included</td><td>حماية الجهد والفازات</td></tr>
<tr><td>34</td><td>Buffer in Pit</td><td>Included</td><td></td></tr>
<tr><td>35</td><td>Governor & Safety Gear</td><td>Included</td><td>مطابق EN81</td></tr>

</tbody>
</table>


  
</div>
<!-- ================= صفحة 4: مخطط استرشادي هندسي ================= -->
<!-- ===== Header ===== -->
<div class="page-header">
  
  <!-- الشعار -->
  <div class="header-logo">
    <img src="/public/images/logo.png" alt="RKL Logo">
  </div>

  <!-- بيانات الشركة -->
  <div class="header-center">
    <div class="company-name">RKL للمصاعد والسلالم الكهربائية</div>
    <div class="company-sub">
      السجل التجاري: 1010709355 – الرقم الضريبي: 302250422600003<br>
      السليمانية – الرياض – هاتف: 0114774021 – WWW.RKL.SA
    </div>
  </div>

  <!-- رقم وتاريخ العرض -->
  <div class="header-meta">
    <div>رقم العرض:<br><strong class="bind_quote_number">—</strong></div>
    <div>تاريخ العرض:<br><strong class="bind_offer_date">—</strong></div>
  </div>

</div>




<div class="section-title">
  خامسًا: مخطط استرشادي هندسي لمقاسات البئر والكابينة (EN81)
</div>

<div style="display:grid; grid-template-columns: 340px 1fr; gap:24px; margin-top:20px">

<table class="tech-table">
  <thead>
    <tr>
      <th>م</th>
      <th>البند</th>
      <th>القيمة (mm)</th>
       <th>الملاحظات</th>
    </tr>
  </thead>
  <tbody>
      <tr>
            <td>1</td>
            <td>مقاس بئر المصعد (mm)</td>
            <td class="bind_dim_shaft">—</td>
            <td>طبقاً لجدول EN81 أو حالة الموقع</td>
        </tr>

       <tr>
            <td>2</td>
            <td>مقاس الكابينة (mm)</td>
            <td class="bind_dim_cabin">—</td>
            <td>طبقاً لجدول EN81 أو التصميم المعتمد</td>
        </tr>

   
       
      </td>
    </tr>

    <tr>
            <td>3</td>
            <td>عمق الحفرة Pit</td>
            <td class="bind_pit">—</td>
            <td></td>
        </tr>
   <tr>
            <td>4</td>
            <td>الابواب </td>
            <td>طبقاً لجدول EN81 أو التصميم المعتمد</td>
            <td></td>
        </tr>

     <tr>
            <td>5</td>
            <td>ارتفاع أعلى البئر OH</td>
            <td class="bind_oh">—</td>
            <td></td>
        </tr>
  </tbody>
</table>


   

  <!-- ✅ المخطط الهندسي -->
<div class="diagram-container" style="display:flex;gap:30px">

<!-- ================= SECTION VIEW ================= -->
<svg width="220" height="420" viewBox="0 0 220 420"
     style="border:1px solid #cbd5e1;background:#fff">

  <!-- Shaft -->
  <rect x="60" y="40" width="100" height="320"
        fill="none" stroke="#0f172a" stroke-width="2"/>

  <!-- Cabin -->
  <rect x="80" y="140" width="60" height="120"
        fill="#ecfdf5" stroke="#10b981" stroke-width="2"/>

  <!-- Labels -->
  <text x="110" y="30" text-anchor="middle" font-size="12" font-weight="600">
    SECTION VIEW
  </text>

  <text x="110" y="205" text-anchor="middle" font-size="11">CABIN</text>

  <!-- PIT -->
  <line x1="60" y1="360" x2="160" y2="360" stroke="#0f172a"/>
  <text x="110" y="390" text-anchor="middle" font-size="11">
    PIT = 1200 mm
  </text>

  <!-- OH -->
  <line x1="60" y1="40" x2="160" y2="40" stroke="#0f172a"/>
  <text x="110" y="20" text-anchor="middle" font-size="11">
    OH = 3500 mm
  </text>
</svg>

<!-- ================= PLAN VIEW ================= -->
<svg width="220" height="220" viewBox="0 0 220 220"
     style="border:1px solid #cbd5e1;background:#fff">

  <!-- Shaft -->
  <rect x="40" y="40" width="140" height="140"
        fill="none" stroke="#0f172a" stroke-width="2"/>

  <!-- Cabin -->
  <rect x="70" y="70" width="80" height="80"
        fill="#ecfdf5" stroke="#10b981" stroke-width="2"/>

  <text x="110" y="30" text-anchor="middle" font-size="12" font-weight="600">
    PLAN VIEW
  </text>

  <text x="110" y="115" text-anchor="middle" font-size="11">
    CABIN
  </text>

  <text x="110" y="200" text-anchor="middle" font-size="11">
    HW = 1700 mm | HD = 1500 mm
  </text>
</svg>

</div>


</div>




</div>




   

</div>

<!-- ================= صفحة 5: ميزات الأمان + مخطط المقاسات ================= -->
<!-- ===== Header ===== -->
<div class="page-header">
  
  <!-- الشعار -->
  <div class="header-logo">
    <img src="/public/images/logo.png" alt="RKL Logo">
  </div>

  <!-- بيانات الشركة -->
  <div class="header-center">
    <div class="company-name">RKL للمصاعد والسلالم الكهربائية</div>
    <div class="company-sub">
      السجل التجاري: 1010709355 – الرقم الضريبي: 302250422600003<br>
      السليمانية – الرياض – هاتف: 0114774021 – WWW.RKL.SA
    </div>
  </div>

  <!-- رقم وتاريخ العرض -->
  <div class="header-meta">
    <div>رقم العرض:<br><strong class="bind_quote_number">—</strong></div>
    <div>تاريخ العرض:<br><strong class="bind_offer_date">—</strong></div>
  </div>

</div>




<p style="font-size:12px; line-height:1.7; color:#374151; margin-bottom:10px">
يعتمد تصميم ومقاسات بئر المصعد والكابينة الواردة في هذا العرض على
<strong>المعايير الأوروبية EN81</strong> المعتمدة دوليًا.
وبناءً عليه، فإن المصعد المختار من قبل العميل سيتم تنفيذه بمقاسات
مطابقة لجدول الاعتماد الدولي EN81 أو بما يتوافق مع حالة الموقع والمخططات
التنفيذية المعتمدة، دون الإخلال بمتطلبات السلامة أو الأداء.
</p>

   <div class="section-title">
ملحق (ب): جدول المقاسات القياسية المعتمدة حسب EN81
</div>

<table>
  <thead>
    <tr>
      <th>الحمولة (kg)</th>
      <th style="background:#eef2ff">عدد المصاعد</th>
      <th>مقاس الكابينة (mm)</th>
      <th>مقاس البئر المطلوب (mm)</th>
      <th>عرض باب المصعد (mm)</th>
      <th>عمق الحفرة (Pit)</th>
      <th>ارتفاع أعلى البئر (OH)</th>
    </tr>
  </thead>

  <tbody>
    <!-- ✅ المصعد المعتمد في هذا العرض -->
    <tr style="background:#f0fdf4">
      <td><strong>450</strong></td>
      <td style="
        font-weight:bold;
        text-align:center;
        background:#dcfce7;
        color:#166534
      ">
        1
      </td>
      <td>1100 × 1000</td>
      <td>1700 × 1500</td>
      <td>700</td>
      <td>1200</td>
      <td>3500</td>
    </tr>

    <tr>
      <td>630</td>
      <td style="font-weight:bold;text-align:center;background:#eef2ff">0</td>
      <td>1400 × 1100</td>
      <td>1800 × 1600</td>
      <td>800</td>
      <td>1200</td>
      <td>3500</td>
    </tr>

    <tr>
      <td>800</td>
      <td style="font-weight:bold;text-align:center;background:#eef2ff">0</td>
      <td>1400 × 1350</td>
      <td>2000 × 1600</td>
      <td>900</td>
      <td>1300</td>
      <td>3600</td>
    </tr>

    <tr>
      <td>1000</td>
      <td style="font-weight:bold;text-align:center;background:#eef2ff">0</td>
      <td>1500 × 1600</td>
      <td>2200 × 1800</td>
      <td>900</td>
      <td>1400</td>
      <td>3700</td>
    </tr>

    <tr>
      <td>1275</td>
      <td style="font-weight:bold;text-align:center;background:#eef2ff">0</td>
      <td>1600 × 1800</td>
      <td>2400 × 1900</td>
      <td>1100</td>
      <td>1400</td>
      <td>3800</td>
    </tr>

    <tr>
      <td>1600</td>
      <td style="font-weight:bold;text-align:center;background:#eef2ff">0</td>
      <td>2000 × 1800</td>
      <td>2600 × 2400</td>
      <td>1100</td>
      <td>1500</td>
      <td>4000</td>
    </tr>
  </tbody>
</table>



   <p style="font-size:11px; color:#6b7280; margin-top:8px">
جميع القيم الواردة في الجدول أعلاه هي قيم إرشادية وفق معيار EN81،
وتخضع للتعديل بما يتوافق مع حالة الموقع والمخططات التنفيذية النهائية
(Final Shop Drawings) المعتمدة من الاستشاري والجهات المختصة.
</p>



</div>


<!-- ================= صفحة 6: القيمة المالية + الدفعات + البنود ================= -->
<!-- ===== Header ===== -->
<div class="page-header">
  
  <!-- الشعار -->
  <div class="header-logo">
    <img src="/public/images/logo.png" alt="RKL Logo">
  </div>

  <!-- بيانات الشركة -->
  <div class="header-center">
    <div class="company-name">RKL للمصاعد والسلالم الكهربائية</div>
    <div class="company-sub">
      السجل التجاري: 1010709355 – الرقم الضريبي: 302250422600003<br>
      السليمانية – الرياض – هاتف: 0114774021 – WWW.RKL.SA
    </div>
  </div>

  <!-- رقم وتاريخ العرض -->
  <div class="header-meta">
    <div>رقم العرض:<br><strong class="bind_quote_number">—</strong></div>
    <div>تاريخ العرض:<br><strong class="bind_offer_date">—</strong></div>
  </div>

</div>



<!-- ===============================
  سابعاً: ملخص القيمة المالية
================================ -->
<div class="section-title">سابعاً: ملخص القيمة المالية</div>

<!-- ===============================
  7-1) ملخص عرض السعر والبنود
================================ -->
<div class="section-title">7-1) ملخص عرض السعر والبنود</div>

<table id="items-table">
  <thead>
    <tr>
      <th style="width:40%">وصف البند</th>
      <th style="width:10%">الكمية</th>
      <th style="width:20%">سعر الوحدة (SAR)</th>
      <th style="width:20%">الإجمالي (SAR)</th>
      <th style="width:10%">✖</th>
    </tr>
  </thead>
  <tbody>
    <!-- بند رئيسي تلقائي من عرض السعر -->
    <tr>
      <td contenteditable="true" class="item-desc"></td>
      <td><input type="number" class="qty" value="1" min="1"></td>
      <td><input type="number" class="unit" value="0" min="0"></td>
      <td class="row-total">0.00</td>
      <td style="text-align:center">—</td>
    </tr>
  </tbody>

  <tfoot>
    <tr style="background:#f8fafc;font-weight:bold">
      <td colspan="3" style="text-align:right">الإجمالي قبل الضريبة</td>
      <td id="itemsSubtotal">SAR 0.00</td>
      <td></td>
    </tr>
  </tfoot>
</table>

<div style="margin-top:8px">
  <button type="button" onclick="addExtraRow()">➕ إضافة بند إضافي</button>
</div>

<!-- ===============================
  7-2) تعديل السعر قبل الضريبة (اختياري)
================================ -->
<div class="section-title">7-2) تعديل السعر قبل الضريبة (اختياري)</div>

<select id="adjustmentType">
  <option value="none">بدون تعديل</option>
  <option value="discount">خصم</option>
  <option value="increase">زيادة</option>
</select>

<input type="number" id="adjustmentValue" placeholder="أدخل المبلغ">

<!-- ===============================
  7-3) جدول الدفعات المقترح
================================ -->
<div class="section-title">7-3) جدول الدفعات المقترح</div>

<table>
  <tbody>
    <tr><td>عند توقيع العقد</td><td>50%</td><td class="pay50">—</td></tr>
    <tr><td>عند الانتهاء من الأعمال الميكانيكية</td><td>25%</td><td class="pay25">—</td></tr>
    <tr><td>بعد الانتهاء من الأعمال الكهربائية والتشغيل</td><td>20%</td><td class="pay20">—</td></tr>
    <tr><td>عند التسليم النهائي للمصعد</td><td>5%</td><td class="pay5">—</td></tr>

    <tr><th>الإجمالي قبل التعديل</th><th></th><th class="subtotalBefore">—</th></tr>
    <tr><th>قيمة الخصم / الزيادة</th><th></th><th class="adjustmentAmount">—</th></tr>
    <tr><th>الإجمالي بعد التعديل</th><th></th><th class="subtotalAfter">—</th></tr>
    <tr><th>ضريبة القيمة المضافة (15%)</th><th></th><th class="vatAmount">—</th></tr>
    <tr style="background:#f0f9ff;font-weight:bold">
      <th>الإجمالي النهائي (شامل الضريبة)</th>
      <th>100%</th>
      <th class="grandTotal">—</th>
    </tr>
  </tbody>
</table>


<div class="contract-terms">
  <h4>٨) بنود رئيسية للعقد (قابلة للتعديل)</h4>

  <ol>
    <li>يُعد هذا العرض جزءًا لا يتجزأ ومكمّلًا لعقد توريد وتركيب وتشغيل المصعد، ويُعمل به بعد اعتماده وتوقيعه من الطرفين.</li>

    <li>جميع الأسعار الواردة في هذا العرض بالريال السعودي وتشمل ضريبة القيمة المضافة بنسبة (15%) ما لم يُذكر خلاف ذلك.</li>

    <li>يلتزم الطرف الأول بتوفير التغذية الكهربائية (3 فاز – 380 فولت) وتنفيذ جميع الأعمال المدنية الخاصة بالبئر والأبواب حسب المخططات المعتمدة.</li>

    <li>يلتزم الطرف الثاني بتنفيذ الأعمال وفق المواصفات الفنية المعتمدة ونطاق الأعمال الموضح في هذا العرض فقط.</li>

    <li>في حال تأخر الدفعات، يحق للطرف الثاني إيقاف الأعمال مؤقتًا دون أي مسؤولية عن التأخير الناتج.</li>

    <li>لا يتحمل الطرف الثاني أي مسؤولية عن الأعطال أو الأضرار الناتجة عن سوء الاستخدام، أو تدخل أطراف غير معتمدة، أو عدم استقرار التيار الكهربائي.</li>

    <li>تكون ولاية القضاء للمحاكم المختصة في المملكة العربية السعودية.</li>

    <li>يُعد هذا العرض لاغيًا في حال عدم توقيعه وسداد الدفعة الأولى خلال مدة سريان العرض.</li>
  </ol>
</div>


<!-- زر طباعة عام -->
<div style="text-align:center; margin-top:10px;">
  <button class="btn-print" onclick="printWithName()">طباعة / حفظ PDF</button>
    <div id="warn_no_data" class="warning" style="display:none;">
      لم يتم العثور على عرض سعر محفوظ في السجل. الرجاء العودة إلى نموذج التسعير وحفظ عرض السعر أولاً.
    </div>
</div>

   
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

<script src="/public/rkl-map.js"></script>
<script src="/public/rkl-summary.js"></script>



<script>
/* =================================================
   Helper: bind text safely
================================================= */
const bindAll = (selector, value) => {
  document.querySelectorAll(selector).forEach(el => {
    el.textContent =
      (value !== undefined && value !== null && value !== '')
        ? value
        : '—';
  });
};


/* =================================================
   تحميل عرض السعر من LocalStorage
================================================= */
const quotes = JSON.parse(localStorage.getItem('rkl_quotes') || '[]');
const currentIndex = localStorage.getItem('rkl_current_quote_index');
window.q = quotes[currentIndex ?? quotes.length - 1];


if (!q) {
  alert('لا يوجد عرض سعر لعرضه');
}
/* =================================================
   (1) بيانات العرض العامة
================================================= */
bindAll('.bind_quote_number', q.quoteNumber);
bindAll('.bind_offer_date', q.timestamp?.slice(0, 10));


/* =================================================
   (2) بيانات العميل
================================================= */
bind('.bind_customer_name', q.customerName);
bind('.bind_customer_type', q.customerDetails?.customer_type || '—');
bind('.bind_contact_person', q.customerDetails?.contact_person || '—');
bind('.bind_cr_number', q.customerDetails?.cr_number || '—');
bind('.bind_tax_number', q.customerDetails?.tax_number || '—');
bind('.bind_customer_phone', q.customerDetails?.mobile || q.customerDetails?.phone || '—');
bind('.bind_customer_email', q.customerDetails?.email || '—');

/* =================================================
   (3) عنوان العميل
================================================= */
bind('.bind_city', q.customerDetails?.city || '—');
bind('.bind_district', q.customerDetails?.district || '—');
bind('.bind_street', q.customerDetails?.street || '—');
bind('.bind_building_number', q.customerDetails?.building_no || '—');
bind('.bind_postal_code', q.customerDetails?.postal_code || '—');
bind('.bind_national_address', q.customerDetails?.full_address || '—');

/* =================================================
   (4) بيانات المشروع
================================================= */
bind('.bind_project_name', q.projectName || '—');
bind('.bind_project_location', q.projectLocation || '—');

/* =================================================
   (5) بيانات المصاعد
================================================= */
bind('.bind_brand', q.brandLabel || '—');
bind('.bind_usage', 'Passenger Elevator');
bind('.bind_lifts', q.liftsCount || '—');
bind('.bind_capacity', q.capacity || '—');
bind('.bind_speed', q.speed || '—');
bind('.bind_stops', q.stops || q.floors || '—');
bind('.bind_fh', q.floorHeight ? q.floorHeight + ' mm' : '—');
bind('.bind_th', q.travelHeight ? q.travelHeight + ' mm' : '—');
bind('.bind_machine_type', q.machineType || 'MRL – Machine Room Less');

/* ارتفاع الرحلة */
bind(
  '.bind_travel_height',
  q.travelHeight ? q.travelHeight + ' mm' : '—'
);



/* =================================================
   (3) البيانات الفنية الرئيسية – ربط نهائي صحيح
================================================= */

bind('.bind_brand', q.brandLabel);                 // ماركة المصعد / النظام
bind('.bind_usage', inferUsage(q.projectName));   // الاستخدام
bind('.bind_capacity', q.capacity);               // الحمولة
bind('.bind_speed', q.speed);                     // السرعة
bind('.bind_stops', q.stops);                     // عدد التوقفات
bind('.bind_lifts', q.liftsCount);                // عدد المصاعد
bind('.bind_machine_type', q.machineType);        // نوع الماكينة

bind('.bind_cabin_design', q.cabinDesign);        // تشطيب داخلي
bind('.bind_floor_finish', q.floorFinish);        // أرضية الكابينة

bind('.bind_dim_shaft', q.shaftSize);              // مقاس البئر
bind('.bind_dim_cabin', q.cabinSize);              // مقاس الكابينة

bind('.bind_pit', q.pit);                          // PIT
bind('.bind_oh', q.oh);                            // OH

bind('.bind_fh', q.floorHeight);                   // FH
bind('.bind_th', q.travelHeight);                  // TH



/* =================================================
   Helper: format currency (SAR)
================================================= */
function formatCurrency(value) {
  const v = Number(value) || 0;
  return v.toLocaleString('en-US', {
    minimumFractionDigits: 2,
    maximumFractionDigits: 2
  }) + ' SAR';
}

/* =================================================
   (5 + 6 + 6-1 + 7) الحساب المالي الكامل
================================================= */

// ✅ الإجمالي الشامل القادم من سجل عروض الأسعار
const grandTotal = Number(q.totalWithVat || 0);

// ✅ عدد المصاعد
const units = Number(q.liftsCount || 1);

// ✅ نسبة الضريبة
const vatRate = Number(q.vatRate || 15);

   /* =================================================
   مخطط المقاسات – فك القيم بالأرقام
================================================= */

// Cabin: "1100 x 1000"
if (q.cabinSize) {
  const [cw, cd] = q.cabinSize.split('x').map(v => v.trim());
  bind('.bind_cabin_width', cw);
  bind('.bind_cabin_depth', cd);
}

// Shaft: "1700 x 1500"
if (q.shaftSize) {
  const [sw, sd] = q.shaftSize.split('x').map(v => v.trim());
 // لازم تكون القيمة: "1700 x 1500"
q.shaftSize = "1700 x 1500";
q.cabinSize = "1100 x 1000";

}

// Door: "700 x 2100" أو "700"
if (q.doorSize) {
  const [dw, dh] = q.doorSize.split('x').map(v => v.trim());
  bind('.bind_door_width', dw);
  bind('.bind_door_height', dh || '—');
}


// ✅ السعر قبل الضريبة (عكسي)
const baseSubtotal = grandTotal / (1 + vatRate / 100);




/* ✅ تشغيل أولي */
recalcFinancialSummary();

/* ✅ إعادة الحساب عند أي تعديل */
document.getElementById('adjust_type')?.addEventListener('change', recalcFinancialSummary);
document.getElementById('adjust_value')?.addEventListener('input', recalcFinancialSummary);
</script>


<script>
function renderPricingTable(q) {
  const tbody = document.querySelector("#pricing-table tbody");
  if (!tbody || !q.items) return;

  tbody.innerHTML = "";

  q.items.forEach(item => {
    const tr = document.createElement("tr");
    tr.innerHTML = `
      <td>${item.description}</td>
      <td style="text-align:center">${item.quantity}</td>
      <td>${item.unitPrice.toLocaleString()} SAR</td>
      <td>${item.total.toLocaleString()} SAR</td>
    `;
    tbody.appendChild(tr);
  });

  document.querySelector(".bind_subtotal").textContent =
    q.subtotal.toLocaleString() + " SAR";

  document.querySelector(".bind_vat").textContent =
    q.vatAmount.toLocaleString() + " SAR";

  document.querySelector(".bind_total").textContent =
    q.totalWithVat.toLocaleString() + " SAR";
}
</script>
<script>
function renderPayments(q) {
  const tbody = document.querySelector("#payments-table tbody");
  if (!tbody || !q.payments) return;

  tbody.innerHTML = "";

  q.payments.forEach(p => {
    const tr = document.createElement("tr");
    tr.innerHTML = `
      <td>${p.label}</td>
      <td style="text-align:center">${p.percent}%</td>
      <td>${p.amount.toLocaleString()} SAR</td>
    `;
    tbody.appendChild(tr);
  });
}
</script>

<script>
function syncEditableFieldsToStorage() {
  const index = localStorage.getItem('rkl_current_quote_index');
  if (index === null) return;

  const quotes = JSON.parse(localStorage.getItem('rkl_quotes') || '[]');
  const q = quotes[index];
  if (!q) return;

  // ✅ البيانات المعدلة يدويًا
  q.brandLabel   = document.querySelector('.bind_brand')?.textContent?.trim() || q.brandLabel;
  q.capacity     = document.querySelector('.bind_capacity')?.textContent?.trim() || q.capacity;
  q.speed        = document.querySelector('.bind_speed')?.textContent?.trim() || q.speed;
  q.floors       = document.querySelector('.bind_floors')?.textContent?.trim() || q.floors;
  q.cabinSize    = document.querySelector('.bind_dim_cabin')?.textContent?.trim() || q.cabinSize;
  q.shaftSize    = document.querySelector('.bind_dim_shaft')?.textContent?.trim() || q.shaftSize;
  q.pit          = document.querySelector('.bind_pit')?.textContent?.trim() || q.pit;
  q.oh           = document.querySelector('.bind_oh')?.textContent?.trim() || q.oh;

  quotes[index] = q;
  localStorage.setItem('rkl_quotes', JSON.stringify(quotes));
}
</script>


<script>
function printWithName() {
  syncEditableFieldsToStorage();

  const quoteNo = document.querySelector('.bind_quote_number')?.textContent?.trim() || 'quotation';
  const cleanNo = quoteNo.replace(/[^\w\d-]/g, '');

  document.title = `RKL_Quotation_${cleanNo}`;
  window.print();

  setTimeout(() => {
    document.title = 'RKL Elevator Offer';
  }, 1000);
}

</script>

   <script>
(function () {

  const idx = localStorage.getItem('rkl_current_quote_index');
  if (idx === null) return;

  const quotes = JSON.parse(localStorage.getItem('rkl_quotes') || '[]');
  const q = quotes[Number(idx)];
  if (!q) return;

  const bind = (selector, value) => {
    const el = document.querySelector(selector);
    if (el) el.textContent = value ?? '—';
  };

  /* ===============================
     Page 1 + Headers
  =============================== */


  bind('.bind_customer_name', q.customerName);
  bind('.bind_project_name', q.projectName);
  bind('.bind_project_location', q.projectLocation);

  /* ===============================
     Page 3 – البيانات الفنية الرئيسية
  =============================== */
  bind('.bind_brand', q.brandLabel);
  bind('.bind_usage', 'Passenger Elevator');

  // بلد المنشأ حسب الماركة
  const origin =
    q.brandLabel?.includes('FUJI') ? 'Japan' :
    q.brandLabel?.includes('VERTILIFT') ? 'Italy' : '—';
  bind('.bind_origin', origin);

  bind('.bind_capacity', q.capacity);
  bind('.bind_speed', q.speed);
  bind('.bind_floors', q.floors);
  bind('.bind_lifts', q.liftsCount);

  bind('.bind_machine_type', 'MRL – Machine Room Less');

  bind('.bind_cabin_design', q.cabinDesign);
  bind('.bind_floor_finish', q.floorFinish);

  bind('.bind_dim_shaft', q.shaftSize);
  bind('.bind_dim_cabin', q.cabinSize);

  bind('.bind_pit', q.pit);
  bind('.bind_oh', q.oh);

  bind('.bind_floor_height', q.floorHeight);
  bind('.bind_travel_height', q.travelHeight);

})();
</script>

<script>
/* ===============================
   أدوات مساعدة
===============================*/
function formatSAR(v){
  return 'SAR ' + (Number(v)||0).toLocaleString('en-US',{
    minimumFractionDigits:2,
    maximumFractionDigits:2
  });
}

/* ===============================
   إعادة حساب البنود + الدفعات
===============================*/
function recalcPricing(){
  const rows = document.querySelectorAll('#items-table tbody tr');
  let subtotal = 0;

  rows.forEach(row=>{
    const qty  = row.querySelector('.qty');
    const unit = row.querySelector('.unit');
    const totalCell = row.querySelector('.row-total');

    if(!qty || !unit || !totalCell) return;

    const rowTotal = (Number(qty.value)||0) * (Number(unit.value)||0);
    totalCell.textContent = rowTotal.toFixed(2);
    subtotal += rowTotal;
  });

  // إجمالي جدول البنود
  document.getElementById('itemsSubtotal').textContent = formatSAR(subtotal);

  // التعديل قبل الضريبة
  const adjTypeEl = document.getElementById('adjustmentType');
  const adjValEl  = document.getElementById('adjustmentValue');

  let adjAmount = 0;
  if(adjTypeEl && adjValEl){
    const adjVal = Number(adjValEl.value||0);
    if(adjTypeEl.value === 'discount') adjAmount = -adjVal;
    if(adjTypeEl.value === 'increase') adjAmount =  adjVal;
  }

  const afterAdj = subtotal + adjAmount;
  const vat      = afterAdj * 0.15;
  const total    = afterAdj + vat;

  // ربط جدول الدفعات
  document.querySelector('.subtotalBefore').textContent = formatSAR(subtotal);
  document.querySelector('.adjustmentAmount').textContent = formatSAR(adjAmount);
  document.querySelector('.subtotalAfter').textContent = formatSAR(afterAdj);
  document.querySelector('.vatAmount').textContent = formatSAR(vat);
  document.querySelector('.grandTotal').textContent = formatSAR(total);

  document.querySelector('.pay50').textContent = formatSAR(total * 0.50);
  document.querySelector('.pay25').textContent = formatSAR(total * 0.25);
  document.querySelector('.pay20').textContent = formatSAR(total * 0.20);
  document.querySelector('.pay5').textContent  = formatSAR(total * 0.05);
}

/* ===============================
   إضافة بند إضافي
===============================*/
function addExtraRow(){
  const tbody = document.querySelector('#items-table tbody');
  const tr = document.createElement('tr');

  tr.innerHTML = `
    <td contenteditable="true">بند إضافي</td>
    <td><input type="number" class="qty" value="1" min="1"></td>
    <td><input type="number" class="unit" value="0" min="0"></td>
    <td class="row-total">0.00</td>
    <td style="text-align:center">
      <button onclick="this.closest('tr').remove();recalcPricing()">✖</button>
    </td>
  `;

  tbody.appendChild(tr);
  recalcPricing();
}

/* ===============================
   مراقبة التغييرات
===============================*/
document.addEventListener('input',e=>{
  if(
    e.target.closest('#items-table') ||
    e.target.id === 'adjustmentType' ||
    e.target.id === 'adjustmentValue'
  ){
    recalcPricing();
  }
});

/* ===============================
   تعبئة البند الرئيسي تلقائيًا
===============================*/
window.addEventListener('load', () => {

  if (!window.q) return;

  const quoteNumber = q.quoteNumber || '—';
  const liftsCount  = Number(q.liftsCount || 1);

  const priceBeforeVat =
    q.totalBeforeVat
      ? Number(q.totalBeforeVat)
      : (Number(q.totalWithVat || 0) / 1.15);

  const firstRow = document.querySelector('#items-table tbody tr:first-child');
  if (!firstRow) return;

  const desc = firstRow.querySelector('td[contenteditable]');
  const qty  = firstRow.querySelector('.qty');
  const unit = firstRow.querySelector('.unit');

  if (desc) {
    desc.textContent =
`توريد وتركيب وتشغيل مصعد/مصاعد كهربائية

اسم المشروع: ${q.projectName || '—'}
موقع المشروع: ${q.projectLocation || '—'}
رقم عرض السعر: ${quoteNumber}

نوع المصعد: ${q.brandLabel || '—'}
الحمولة الاسمية: ${q.capacity || '—'}
عدد الأدوار / التوقفات: ${q.stops || q.floors || '—'}

حسب المواصفات الفنية المعتمدة والواردة في هذا العرض.`;
  }

  if (qty)  qty.value  = liftsCount;
  if (unit) unit.value = priceBeforeVat.toFixed(2);

  recalcPricing();
});

</script>



</body>
</html>

























































































































