<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
   
<style>

   /* =================================================
   PRINT FIX – EN81 DIAGRAM PAGE (PAGE 6)
================================================= */
@media print {

  /* تأكيد أن الصفحة لا تنكسر */
  .page.en81-page {
    page-break-after: always !important;
    break-inside: avoid !important;
  }

  /* تخطيط الصفحة */
 .en81-layout {
    display: flex;
    align-items: flex-start;
    gap: 20px;
    padding: 15px;
    background: #ffffff;
    border-radius: 12px;
}
 .annexC-wrap{
    margin-top: 12px;
    border: 1px solid #e5e7eb;
    border-radius: 10px;
    padding: 12px;
    background:#fff;
  }
  .annexC-title{
    text-align:center;
    font-weight:800;
    font-size:14px;
    margin: 0 0 10px 0;
    color:#111827;
  }
  .annexC-subtitle{
    text-align:center;
    font-size:11px;
    color:#6b7280;
    margin-top:-6px;
    margin-bottom: 10px;
  }
  .finish-grid{
    display:grid;
    grid-template-columns: repeat(3, 1fr);
    gap:10px;
  }
  .finish-card{
    border:1px solid #e5e7eb;
    border-radius:10px;
    padding:8px;
    display:flex;
    gap:8px;
    align-items:center;
    min-height:62px;
  }
  .finish-card.active{
    border:2px solid #16a34a;
    box-shadow: 0 0 0 2px rgba(22,163,74,.10);
  }
  .finish-thumb{
    width:46px;
    height:46px;
    border-radius:8px;
    border:1px solid #e5e7eb;
    object-fit:cover;
    flex: 0 0 46px;
  }
  .finish-meta{ flex:1; }
  .finish-name{ font-weight:800; font-size:11.5px; color:#111827; margin:0; }
  .finish-code{ font-size:10px; color:#6b7280; margin:2px 0 0 0; }
  .finish-note{
    margin-top:10px;
    font-size:10px;
    color:#6b7280;
    line-height:1.6;
    background:#f9fafb;
    border:1px dashed #e5e7eb;
    border-radius:10px;
    padding:8px;
  }

  /* للطباعة: منع الكروت تتكسر */
  .annexC-wrap, .finish-card { break-inside: avoid; page-break-inside: avoid; }
  /* تكبير المخطط */
  .diagram-container {
    display: flex;
    justify-content: center;
    align-items: center;
  }

  .diagram-container svg {
    max-width: 100%;
    height: auto;
    transform: scale(1.08);
  }

  /* ضبط الجدول */
  .en81-table table {
    font-size: 11px;
  }

  .en81-table th,
  .en81-table td {
    padding: 6px 8px;
  }

}

/* ===============================
   HEADER (Final – Print Safe)
=============================== */
.page-header {
  position: relative;
  min-height: 70px;
  margin-bottom: 14px;
  padding-top: 6px;
  border-bottom: 1.5px solid #e5e7eb;
  font-size: 11px;
}

/* الشعار – ثابت لا يتحرك */
.header-logo {
  position: absolute;
  top: 6px;
  left: 0;
  width: 42px;
  height: auto;
}

/* النص بالمنتصف */
.header-text {
  text-align: center;
  padding: 0 90px; /* مساحة للشعار + بيانات العرض */
  line-height: 1.4;
}

.company-name {
  font-weight: 700;
  font-size: 14px;
}

.company-sub {
  font-size: 10px;
  color: #6b7280;
}

/* رقم وتاريخ العرض */
.header-meta {
  position: absolute;
  top: 6px;
  right: 0;
  text-align: right;
  font-size: 11px;
  line-height: 1.5;
}

@media print {
  .page {
    position: relative;
    overflow: hidden;
  }

  .page-header {
    break-inside: avoid;
  }
}


/* =================================================
   Editable
================================================= */
body[contenteditable="true"] { cursor: text; }
[contenteditable="true"]:focus { outline: none; }
.editable-highlight:hover { background: rgba(59,130,246,0.06); }

/* =================================================
   Header
================================================= */
.page-header {
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  border-bottom: 2px solid #e5e7eb;
  padding-bottom: 8px;
  margin-bottom: 12px;
  font-size: 12px;
}

.header-left { text-align: right; }
.header-right { text-align: left; }

.logo-title { font-weight: 700; font-size: 18px; }
.logo-sub {
  font-size: 11px;
  color: #6b7280;
  line-height: 1.5;
}

/* =================================================
   العناوين
================================================= */
h1.main-title {
  text-align: center;
  font-size: 18px;
  margin: 10px 0 18px;
}

.section-title {
  font-weight: 700;
  font-size: 14px;
  margin: 18px 0 8px;
  border-right: 4px solid #2563eb;
  padding-right: 6px;
}

/* =================================================
   الجداول (عرض الشاشة)
================================================= */
table {
  width: 100%;
  border-collapse: collapse;
  font-size: 12px;
}

th, td {
  border: 1px solid #d1d5db;
  padding: 6px 8px;
  vertical-align: top;
}

th {
  background: #f9fafb;
  font-weight: 600;
}

.spec-table th { width: 22%; background: #f8fafc; }
.spec-table td { width: 28%; }

/* =================================================
   تقسيمات
================================================= */
.two-col {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 12px;
}

.small-note {
  font-size: 11px;
  color: #6b7280;
}

.terms p {
  font-size: 11.5px;
  margin: 4px 0;
  text-align: justify;
}

/* =================================================
   غلاف PDF
================================================= */
.pdf-cover {
  padding: 0 !important;
}

.fixed-pdf-img {
  width: 100%;
  display: block;
}

/* =================================================
   الشعارات
================================================= */
.partners-logos img {
  max-width: 180px;
  max-height: 90px;
  object-fit: contain;
  display: block;
  margin: 0 auto;
}

/* =================================================
   زر الطباعة
================================================= */
.btn-print {
  display: inline-block;
  margin: 12px auto 0;
  padding: 8px 18px;
  font-size: 13px;
  background: #2563eb;
  color: #fff;
  border-radius: 4px;
  border: none;
  cursor: pointer;
}

/* =================================================
   ================== الطباعة ==================
================================================= */
@media print {

 @page {
  size: A4;
  margin: 0;
}
.page-coverage {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 24px;
  margin-top: 18px;

  break-inside: avoid !important;
  page-break-inside: avoid !important;
}
     .price-adjust-section {
    display: none !important;
  }
.page-coverage img {
  max-height: 210mm; /* ضمان عدم تجاوز ارتفاع الصفحة */
  object-fit: contain;
}
   .coverage-table table {
  font-size: 11px;
}
  .diagram-container svg {
    transform: scale(1.05);
  }
   .diagram-container {
  align-items: center;
}
.coverage-table th,
.coverage-table td {
  padding: 5px 6px;
}
   

  html, body {
    margin: 0 !important;
    padding: 0 !important;
    background: #fff !important;
    -webkit-print-color-adjust: exact !important;
    print-color-adjust: exact !important;
  }

  /* كل صفحة = ورقة A4 مستقلة */
  .page {
    width: 210mm !important;
    min-height: 297mm !important;
    margin: 0 !important;
    padding: 15mm !important;
    box-sizing: border-box !important;

    page-break-after: always !important;
    break-after: page !important;

    display: block !important;
    position: relative !important;
    overflow: hidden !important;

    box-shadow: none !important;
  }

  /* الغلاف */
  .pdf-cover {
    padding: 0 !important;
  }

  .pdf-cover img,
  .fixed-pdf-img {
    width: 210mm !important;
    height: 297mm !important;
    object-fit: cover !important;
    display: block !important;
  }

  /* الجداول – السماح بالكسر الطبيعي */
  table {
    page-break-inside: auto !important;
    break-inside: auto !important;
     font-size: 10.2px !important;
  }

  thead {
    display: table-header-group !important;
  }


  tr {
    page-break-inside: avoid !important;
    break-inside: avoid !important;
  }

  /* إلغاء grid / flex في الطباعة */
  .two-col,
  .page-header,
  .partners-logos {
    display: block !important;
  }

  /* إخفاء زر الطباعة */
  .btn-print {
    display: none !important;
  }
    .section-title {
    margin-top: 10px !important;
    margin-bottom: 6px !important;
    font-size: 13px !important;
  }
    p {
    margin-top: 6px !important;
    margin-bottom: 6px !important;
    line-height: 1.6 !important;
  }
.en81-layout {
    display: flex;
    align-items: flex-start;
    gap: 20px;
    padding: 15px;
    background: #ffffff;
    border-radius: 12px;
}
   
/* ===== EN81 Auto Highlight ===== */
.en81-active {
  background: #f6fffa !important;
}
.en81-active .en81-count {
  background: #e6f7ef !important;
  color: #065f46 !important;
}

.en81-active .en81-count {
  background: #dcfce7 !important;
  color: #166534 !important;
  font-weight: 700 !important;
  text-align: center !important;
}
.en81-count {
  min-width: 70px;
  text-align: center;
  font-weight: 700;
}

  /* منع زيادة ارتفاع الصفوف */
  tr {
    height: auto !important;
  }
}
.en81-match {
  background: #e8f5e9 !important;
  border: 2px solid #2e7d32 !important;
  font-weight: bold;
}
   #annexC-table tr.annexC-active {
  background: #e8f5e9 !important;
  border: 2px solid #2e7d32 !important;
  font-weight: bold;
}


</style>


</head>


   <body contenteditable="true" spellcheck="false">

 

<!-- =================================================
 PAGE 0 | Cover Page – Corporate Identity
================================================= -->
<div class="page pdf-cover">
  <img src="/public/images/FIRST_PAGE_RKL1.png" class="fixed-pdf-img">
</div>

<!-- =================================================
 PAGE 1 | Cover Page – Company Profile
================================================= -->
<div class="page pdf-cover">
  <img src="/public/images/FIRST_PAGE_RKL2.png" class="fixed-pdf-img">
</div>

<!-- =================================================
 PAGE 2 | Introduction + Client File + Project Data
================================================= -->
<div class="page">

  <!-- ===== Header ===== -->
  <div class="page-header">

  <!-- شعار ثابت -->
  <img src="/public/images/logo.png" class="header-logo" alt="RKL Logo">

  <div class="header-text">
    <div class="company-name">RKL للمصاعد والسلالم الكهربائية</div>
    <div class="company-sub">
      السجل التجاري: 1010709355 – الرقم الضريبي: 302250422600003<br>
      السليمانية – الرياض – هاتف: 0114774021 – WWW.RKL.SA
    </div>
  </div>

  <div class="header-meta">
    رقم العرض: <strong class="bind_quote_number">—</strong><br>
    تاريخ العرض: <strong class="bind_offer_date">—</strong>
  </div>

</div>

  <!-- ===== Title ===== -->
  <h1 class="main-title">عرض سعر توريد وتركيب وتشغيل مصعد كهربائي</h1>

  <!-- ===== About RKL ===== -->
  <div class="section-title">أولاً: نبذة عن مؤسسة آر كي ال RKL</div>
  <p class="small-note editable" contenteditable="true">
    مؤسسة سعودية متخصصة في توريد وتركيب وصيانة المصاعد والسلالم الكهربائية،
    تعمل وفق أعلى معايير الجودة والسلامة، وتمتلك شراكات مع مصانع عالمية،
    مع خبرة في تنفيذ مشاريع حكومية وخاصة في مختلف مناطق المملكة.
  </p>

  <!-- ===== Client File ===== -->
  <div class="section-title">ثانياً: ملف العميل</div>

  <div class="formal-letter">
    
      إشارةً إلى طلبكم الكريم، نفيدكم بأن
      <strong>مؤسسة آر كي ال RKL للمصاعد والسلالم الكهربائية</strong>
      قامت بإعداد هذا العرض الفني والمالي بناءً على البيانات والمعلومات الرسمية
      المقدمة من طرفكم، وذلك وفق التفاصيل الموضحة أدناه.
   
  </div>

<!-- ===== Client Data – Formal Letter Style ===== -->
<div class="client-letter-box">

  <div class="client-line">
    <span>اسم العميل:</span>
    <strong class="bind_customer_name">—</strong>
    <span class="sep">|</span>
    <span>نوع العميل:</span>
    <strong class="bind_customer_type">—</strong>
  </div>

  <div class="client-line">
    <span>الشخص المسؤول:</span>
    <strong class="bind_contact_person">—</strong>
    <span class="sep">|</span>
    <span>السجل التجاري:</span>
    <strong class="bind_cr_number">—</strong>
  </div>

  <div class="client-line">
    <span>الرقم الضريبي:</span>
    <strong class="bind_tax_number">—</strong>
    <span class="sep">|</span>
    <span>رقم الهاتف:</span>
    <strong class="bind_customer_phone">—</strong>
  </div>

  <div class="client-line">
    <span>البريد الإلكتروني:</span>
    <strong class="bind_customer_email">—</strong>
  </div>

  <div class="client-line">
    <span>العنوان:</span>
    <strong>
      <span class="bind_city">—</span> /
      <span class="bind_district">—</span> /
      <span class="bind_street">—</span> /
      مبنى <span class="bind_building_number">—</span> /
      <span class="bind_postal_code">—</span>
    </strong>
  </div>

  <div class="client-line">
    <span>العنوان الوطني:</span>
    <strong class="bind_national_address">—</strong>
  </div>

</div>

  <!-- ===== Elevator Data ===== -->
  <div class="section-title" style="margin-top:20px">
    ثالثاً: بيانات المصاعد الخاصة بالمشروع
  </div>

  <p class="small-note">
    فيما يلي البيانات الفنية الأساسية للمصاعد المطلوبة للمشروع، وذلك حسب المعلومات المعتمدة من طرفكم:
  </p>

  <!-- ===== Table Wrap (important) ===== -->
  <div class="table-wrap">
<table class="spec-table">
  <tbody>

    <!-- الصف 1 -->
    <tr>
      <th>اسم المشروع</th>
      <td class="bind_project_name">—</td>
      <th>موقع المشروع</th>
      <td class="bind_project_location">—</td>
    </tr>

    <!-- الصف 2 -->
    <tr>
      <th>ماركة المصعد</th>
      <td class="bind_brand">—</td>
      <th>نوع الاستخدام</th>
      <td class="bind_usage">Passenger Elevator</td>
    </tr>

    <!-- الصف 3 -->
    <tr>
      <th>عدد المصاعد</th>
      <td class="bind_lifts">—</td>
      <th>الحمولة الاسمية (kg)</th>
      <td class="bind_capacity">—</td>
    </tr>

    <!-- الصف 4 -->
    <tr>
      <th>السرعة (m/s)</th>
      <td class="bind_speed">—</td>
      <th>عدد التوقفات (Stops)</th>
      <td class="bind_stops">—</td>
    </tr>

    <!-- الصف 5 -->
    <tr>
      <th>ضمان المصاعد</th>
      <td>خمسة سنوات</td>
      <th>مدة الصيانة الوقائية</th>
      <td>سنة ميلادية</td>
    </tr>

    <!-- الصف 6 -->
    <tr>
      <th>إمدادات الطاقة</th>
      <td>60 Hz, 380-220V</td>
      <th>التعليق</th>
      <td>1:2</td>
    </tr>

    <!-- الصف 7 -->
    <tr>
      <th>نوع الكابينة</th>
      <td>ركاب</td>
      <th>نظام التركيب</th>
      <td class="bind_machine_type">
        MRL – Machine Room Less
      </td>
    </tr>

    <!-- الصف 8 -->
    <tr>
      <th>مدة التصنيع في المصنع</th>
      <td>45 – 60 يوم عمل</td>
      <th>مدة الشحن البحري</th>
      <td>30 – 40 يوم عمل</td>
    </tr>

    <!-- الصف 9 -->
    <tr>
      <th>مدة تركيب المصعد</th>
      <td>15 – 22 يوم عمل</td>
      <th>إجمالي المدة المتوقعة (تقديري)</th>
      <td>90 – 122 يوم عمل</td>
    </tr>

    <!-- الصف 10 -->
    <tr>
      <th>ارتفاع الدور الواحد (FH)</th>
      <td class="bind_fh">—</td>
      <th>ارتفاع الرحلة الكلي (TH)</th>
      <td class="bind_th">—</td>
    </tr>

  </tbody>
</table>

  </div>
<div style="margin-top: 15px; border-top: 2px solid #1e3a8a; padding-top: 10px; font-family: sans-serif;">
    
    <div style="display: grid; grid-template-columns: 1fr 1.2fr; gap: 20px;">
        
        <div style="background: #f8fafc; padding: 10px; border-radius: 5px; border: 1px solid #e2e8f0;">
            <h6 style="color: #1e3a8a; font-size: 11px; margin: 0 0 8px 0; border-bottom: 1px solid #1e3a8a; padding-bottom: 3px;">دليل الرموز الفنية (Legend)</h6>
            <table style="width: 100%; font-size: 10px; border-collapse: collapse; line-height: 1.5;">
                <tr>
                    <td style="font-weight: bold; color: #2563eb; width: 30%;">CW / CD</td>
                    <td>صافي عرض وعمق الكابينة الداخلي.</td>
                </tr>
                <tr>
                    <td style="font-weight: bold; color: #2563eb;">HW / HD</td>
                    <td>أبعاد بئر المصعد (الخلوص الخرساني).</td>
                </tr>
                <tr>
                    <td style="font-weight: bold; color: #2563eb;">Pit / OH</td>
                    <td>عمق الحفرة وأدنى ارتفاع علوي للأمان.</td>
                </tr>
                <tr>
                    <td style="font-weight: bold; color: #2563eb;">EN 81-20</td>
                    <td>المعيار الدولي لسلامة الركاب والفنيين.</td>
                </tr>
            </table>
        </div>

        <div>
            <h6 style="color: #1e3a8a; font-size: 11px; margin: 0 0 8px 0;">◎ ملاحظات هندسية ومعايير الجودة:</h6>
            <ul style="margin: 0; padding-right: 15px; font-size: 10.5px; line-height: 1.6; color: #333;">
                <li>تطابق هذه المقاسات متطلبات <strong>كود البناء السعودي (SBC)</strong> والدفاع المدني.</li>
                <li>تم تصميم المساحات لضمان تقليل الاحتكاك والضوضاء الميكانيكية داخل البئر.</li>
                <li>يتم تدقيق أبعاد الموقع فعلياً قبل التصنيع لضمان مطابقة الكابينة للبئر.</li>
                <li>تضمن مسافات الأمان (Pit/OH) حماية الفنيين أثناء عمليات الصيانة الدورية.</li>
                <li><strong>تنبيه:</strong> أي تعديل في أبعاد البئر بالموقع يتطلب مراجعة المكتب الفني لدينا.</li>
            </ul>
        </div>
    </div>

    <div style="margin-top: 12px; background: #1e3a8a; color: white; padding: 6px; text-align: center; border-radius: 4px; font-size: 10px;">
        جميع التصاميم الهندسية لشركة <strong>RKL</strong> تخضع لرقابة صارمة لضمان أعلى معايير الجودة والأمان المستدام.
    </div>
</div>
   
</div> <!-- نهاية .page -->

<!-- =================================================
 PAGE 3 | RKL Coverage & International Partnerships
================================================= -->
<div class="page">

  <div class="page-header">


  <!-- شعار ثابت -->
  <img src="/public/images/logo.png" class="header-logo" alt="RKL Logo">

  <div class="header-text">
    <div class="company-name">RKL للمصاعد والسلالم الكهربائية</div>
    <div class="company-sub">
      السجل التجاري: 1010709355 – الرقم الضريبي: 302250422600003<br>
      السليمانية – الرياض – هاتف: 0114774021 – WWW.RKL.SA
    </div>
  </div>

  <div class="header-meta">
    رقم العرض: <strong class="bind_quote_number">—</strong><br>
    تاريخ العرض: <strong class="bind_offer_date">—</strong>
  </div>

</div>

<div class="page-coverage">

    <!-- صورة الخريطة -->
    <div style="width:50%">
      <img
        src="/public/images/ksa-map.png"
        alt="RKL Coverage Map"
        style="width:100%;border-radius:10px;border:1px solid #e5e7eb"
      />
      <div style="font-size:11px;color:#6b7280;margin-top:6px;text-align:center">
        التوزيع الجغرافي لأعمال RKL داخل المملكة العربية السعودية
      </div>
    </div>

    <!-- جدول المناطق -->
    <div style="width:50%">
      <h4 style="margin:0 0 10px 0">
        ثالثا ملخص الأعمال حسب المناطق
      </h4>

      <table>
        <thead>
          <tr>
            <th>المنطقة</th>
            <th>Region</th>
            <th>عدد المصاعد</th>
            <th>Elevators</th>
          </tr>
        </thead>
         <tbody>
  <tr>
    <td>421</td>
    <td>421</td>
    <td>Riyadh</td>
    <td>الرياض</td>
  </tr>
  <tr>
    <td>98</td>
    <td>98</td>
    <td>Makkah</td>
    <td>مكة المكرمة</td>
  </tr>
  <tr>
    <td>72</td>
    <td>72</td>
    <td>Eastern Region</td>
    <td>المنطقة الشرقية</td>
  </tr>
  <tr>
    <td>34</td>
    <td>34</td>
    <td>Madinah</td>
    <td>المدينة المنورة</td>
  </tr>
  <tr>
    <td>26</td>
    <td>26</td>
    <td>Qassim</td>
    <td>القصيم</td>
  </tr>
  <tr>
    <td>19</td>
    <td>19</td>
    <td>Tabuk</td>
    <td>تبوك</td>
  </tr>
  <tr>
    <td>17</td>
    <td>17</td>
    <td>Hail</td>
    <td>حائل</td>
  </tr>
  <tr>
    <td>23</td>
    <td>23</td>
    <td>Najran</td>
    <td>نجران</td>
  </tr>
  <tr>
    <td>41</td>
    <td>41</td>
    <td>Asir & Jazan</td>
    <td>عسير وجازان</td>
  </tr>
</tbody>


      </table>
    </div>

  </div>
   <!-- =========================
     الاعتمادات والشراكات
========================= -->
<div class="section-title">الاعتمادات والشراكات الدولية</div>

<p class="section-text">
 <strong>RKL </strong> معتمدة في توريد وتنفيذ أنظمة المصاعد
من موردين عالميين،.
</p>

<div class="partners-logos">
  <div class="partner-box">
    <img src="public/images/fuji-logo.png" alt="FUJI Japan">
    <div class="partner-name">FUJI – Japan</div>
    <div class="partner-desc">مصاعد كهربائية – أنظمة MRL & Passenger</div>
  </div>

  <div class="partner-box">
    <img src="public/images/vertilift-logo.png" alt="VertiLift Italy">
    <div class="partner-name">VertiLift – Italy</div>
    <div class="partner-desc">مصاعد أوروبية – حلول حديثة</div>
  </div>
</div>

<!-- نبذة عن المؤسسة والمشاريع -->
<div style="margin-top:20px; border-top:1px solid #e5e7eb; padding-top:15px;">

  <strong>مشاريعنا داخل المملكة العربية السعودية</strong>
  <p style="font-size:12px; line-height:1.6; color:#374151; margin-top:6px;">
     RKL وقد نفذت أعمالها
    في عدة مناطق داخل المملكة العربية السعودية.
  </p>

<p style="font-size:11.5px; line-height:1.7; color:#374151; margin-top:10px; text-align:justify">
يعرض الجدول أعلاه ملخصًا لأعمال <strong>مؤسسة آر كي ال RKL</strong> في مختلف
مناطق المملكة العربية السعودية، ويشمل عدد المصاعد التي تم توريدها
وتركيبها وتشغيلها ضمن مشاريع سكنية وتجارية وطبية وتعليمية.

وتعكس هذه البيانات الانتشار الجغرافي الواسع لأعمال المؤسسة،
وقدرتها على تنفيذ المشاريع وفق أعلى معايير الجودة والسلامة،
وبما يتوافق مع متطلبات الجهات المالكة والاستشارية في مختلف المناطق.
</p>

<p style="font-size:11.5px; line-height:1.7; color:#374151; margin-top:6px; text-align:justify" dir="ltr">
The above table presents a summary of <strong>RKL</strong> elevator projects
across various regions of the Kingdom of Saudi Arabia, including the
number of elevators supplied, installed, and commissioned for residential,
commercial, medical, and educational developments.

This regional distribution reflects RKL’s extensive geographical presence
and its capability to deliver projects in compliance with international
quality and safety standards, meeting the requirements of clients,
consultants, and regulatory authorities across the Kingdom.
</p>

</div>
</div> <!-- نهاية .page -->

<!-- =================================================
 PAGE 4 | General Technical Specifications (Fixed)
================================================= -->
      
<div class="page">

  <div class="page-header">


  <!-- شعار ثابت -->
  <img src="/public/images/logo.png" class="header-logo" alt="RKL Logo">

  <div class="header-text">
    <div class="company-name">RKL للمصاعد والسلالم الكهربائية</div>
    <div class="company-sub">
      السجل التجاري: 1010709355 – الرقم الضريبي: 302250422600003<br>
      السليمانية – الرياض – هاتف: 0114774021 – WWW.RKL.SA
    </div>
  </div>

  <div class="header-meta">
    رقم العرض: <strong class="bind_quote_number">—</strong><br>
    تاريخ العرض: <strong class="bind_offer_date">—</strong>
  </div>

</div>

<div class="section-title">رابعاً: المواصفات القياسية الثابتة لنظام المصعد</div>

<table class="info-table">
<thead>
<tr>
  <th style="width:40px">م</th>
  <th>البند</th>
  <th>الوصف</th>
  <th>ملاحظات</th>
</tr>
</thead>

<tbody>

<!-- ===== Drive & Control System ===== -->
<tr><td>1</td><td>Drive System</td><td>VVVF – Variable Voltage Variable Frequency</td><td>تشغيل ناعم واقتصادي</td></tr>
<tr><td>2</td><td>Power Saver</td><td>Included</td><td>توفير استهلاك الطاقة</td></tr>
<tr><td>3</td><td>Anti-vibration & Motion Smoothing</td><td>Included</td><td>تقليل الاهتزاز والضوضاء</td></tr>
<tr><td>4</td><td>Speed Governor</td><td>Included</td><td>مطابق EN81</td></tr>
<tr><td>5</td><td>Overload Protection</td><td>Included</td><td>حماية من زيادة الحمولة</td></tr>
<tr><td>6</td><td>Auto Park Function</td><td>Included</td><td>إيقاف تلقائي عند عدم الاستخدام</td></tr>

<!-- ===== Doors System ===== -->
<tr><td>7</td><td>Door Type</td><td>Automatic</td><td></td></tr>
<tr><td>8</td><td>Door Opening</td><td>Center Opening</td><td></td></tr>
<tr><td>9</td><td>Door Material</td><td>Stainless Steel</td><td>باب الكابينة</td></tr>
<tr><td>10</td><td>Landing Door Material</td><td>Stainless Steel</td><td>أبواب الأدوار</td></tr>

<!-- ===== COP & HOP ===== -->
<tr><td>11</td><td>COP Type</td><td>Hairline Stainless Steel</td><td></td></tr>
<tr><td>12</td><td>COP Buttons</td><td>ANOD / Push Button</td><td></td></tr>
<tr><td>13</td><td>Display</td><td>LCD Display</td><td></td></tr>
<tr><td>14</td><td>Display Size</td><td>4.3 Inch LCD</td><td></td></tr>
<tr><td>15</td><td>Language</td><td>English</td><td></td></tr>
<tr><td>16</td><td>HOP Type</td><td>Hairline Stainless Steel</td><td></td></tr>
<tr><td>17</td><td>Indicators</td><td>Location & Direction Indicator</td><td></td></tr>

<!-- ===== Electrical ===== -->
<tr><td>18</td><td>Power Supply</td><td>380V – 60Hz – 3 Phase</td><td>التغذية الرئيسية</td></tr>
<tr><td>19</td><td>Lighting Power</td><td>220V – 60Hz</td><td>إنارة الكابينة</td></tr>

<!-- ===== Safety Systems ===== -->
<tr><td>20</td><td>ARD</td><td>Automatic Rescue Device</td><td>إنزال تلقائي عند انقطاع التيار</td></tr>
<tr><td>21</td><td>Fireman Key</td><td>Included</td><td>وضع الطوارئ للحريق</td></tr>
<tr><td>22</td><td>Two-way Intercom System</td><td>Included</td><td>اتصال داخلي للطوارئ</td></tr>
<tr><td>23</td><td>Emergency Car Light</td><td>Included</td><td></td></tr>
<tr><td>24</td><td>Emergency Alarm Bell</td><td>Included</td><td></td></tr>
<tr><td>25</td><td>Electric Blower</td><td>Included</td><td>تهوية الكابينة</td></tr>
<tr><td>26</td><td>Fire & Earthquake Sensor Ready</td><td>Included</td><td>جاهز للربط مع أنظمة المبنى</td></tr>
<tr><td>27</td><td>Car Top Safety Guard</td><td>Included (for travel &gt; 450cm)</td><td></td></tr>
<tr><td>28</td><td>Door Lock Monitoring</td><td>Included</td><td></td></tr>
<tr><td>29</td><td>Door Opening Prevention</td><td>Included</td><td>منع الفتح أثناء الحركة</td></tr>
<tr><td>30</td><td>Full Height Sensor</td><td>Included</td><td></td></tr>
<tr><td>31</td><td>Safe Landing System</td><td>Included</td><td></td></tr>
<tr><td>32</td><td>Self-diagnostic Electronic Devices</td><td>Included</td><td>تشخيص الأعطال ذاتياً</td></tr>
<tr><td>33</td><td>Phase / Voltage Protection</td><td>Included</td><td>حماية الجهد والفازات</td></tr>
<tr><td>34</td><td>Buffer in Pit</td><td>Included</td><td></td></tr>
<tr><td>35</td><td>Governor & Safety Gear</td><td>Included</td><td>مطابق EN81</td></tr>

</tbody>
</table>


  
</div>
     

<!-- =================================================
 PAGE 5 | EN81 Layout & Dimensional Drawings (ONE PAGE)
================================================= -->
<div class="page en81-page">

  <!-- ================= HEADER ================= -->
  <div class="page-header">
    <img src="/public/images/logo.png" class="header-logo" alt="RKL Logo">

    <div class="header-text">
      <div class="company-name">RKL للمصاعد والسلالم الكهربائية</div>
      <div class="company-sub">
        السجل التجاري: 1010709355 – الرقم الضريبي: 302250422600003<br>
        السليمانية – الرياض – هاتف: 0114774021 – WWW.RKL.SA
      </div>
    </div>

    <div class="header-meta">
      رقم العرض: <strong class="bind_quote_number">—</strong><br>
      تاريخ العرض: <strong class="bind_offer_date">—</strong>
    </div>
  </div>

  <!-- ================= TITLE ================= -->
<div class="section-title center" style="margin-top:10px; border-bottom: 2px solid #1e3a8a; padding-bottom: 5px;">
    خامساً: مخطط استرشادي هندسي لمقاسات بئر المصعد والكابينة (EN 81)<br>
    <span style="font-size: 12px; color: #64748b; font-weight: normal;">Indicative Engineering Layout – EN 81-20/50 Standards</span>
</div>

<div style="display:flex; flex-direction:column; gap:12px; margin-top:15px;">


   <div style="flex: 0.85;">

        <table class="tech-table" style="width: 100%; border-collapse: collapse; font-size: 11px; background: white;">
            <thead>
                <tr style="background: #1e3a8a; color: white;">
                    <th style="padding: 8px; border: 1px solid #ddd;">البند الفني</th>
                    <th style="padding: 8px; border: 1px solid #ddd;">المقاس (mm)</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td style="padding: 6px; border: 1px solid #ddd; font-weight: bold;">عرض وعمق البئر (HW x HD)</td>
                    <td style="padding: 6px; border: 1px solid #ddd; color: #1e3a8a; text-align: center;" data-bind="shaftSize">—</td>
                </tr>
                <tr>
                    <td style="padding: 6px; border: 1px solid #ddd; font-weight: bold;">عرض وعمق الكابينة (CW x CD)</td>
                    <td style="padding: 6px; border: 1px solid #ddd; color: #1e3a8a; text-align: center;" data-bind="cabinSize">—</td>
                </tr>
                <tr>
                    <td style="padding: 6px; border: 1px solid #ddd; font-weight: bold;">عمق الحفرة (Pit)</td>
                    <td style="padding: 6px; border: 1px solid #ddd; color: #ef4444; text-align: center;" data-bind="pit">—</td>
                </tr>
                <tr>
                    <td style="padding: 6px; border: 1px solid #ddd; font-weight: bold;">الخلوص العلوي (O.H)</td>
                    <td style="padding: 6px; border: 1px solid #ddd; color: #ef4444; text-align: center;" data-bind="oh">—</td>
                </tr>
                <tr style="background: #f8fafc;">
                    <td colspan="2" style="padding: 8px; font-size: 10px; color: #64748b; font-style: italic;">* المقاسات تخضع للمراجعة النهائية بعد مطابقة الموقع.</td>
                </tr>
            </tbody>
        </table>
    </div>

    <div style="flex: 2.15; background: #fdfdfd; border: 1px solid #e2e8f0; border-radius: 8px; padding: 10px;">
     <svg id="en81Svg" viewBox="0 0 980 340" xmlns="http://www.w3.org/2000/svg" style="width: 100%; height: auto;">
  <defs>
    <marker id="arrow" viewBox="0 0 10 10" refX="5" refY="5" markerWidth="6" markerHeight="6" orient="auto-start-reverse">
      <path d="M 0 0 L 10 5 L 0 10 z" fill="#64748b" />
    </marker>
    <style>
      .lbl{font-family:Arial, sans-serif; fill:#1e3a8a}
      .dim{font-family:Arial, sans-serif; fill:#475569}
      .soft{fill:#f1f5f9; stroke:#2563eb; stroke-width:1.5}
      .frame{fill:none; stroke:#1e293b; stroke-width:2}
      .guide{stroke:#94a3b8; stroke-width:2}
      .dimline{stroke:#64748b; stroke-width:0.9}
      .warn{fill:#ef4444; font-family:Arial, sans-serif;}
    </style>
  </defs>

  <!-- ===================== LEFT: SECTION VIEW ===================== -->
  <g transform="translate(40,40)">
    <text x="70" y="-15" text-anchor="middle" class="lbl" font-size="12" font-weight="bold">SECTION VIEW</text>

    <!-- rails/walls -->
    <line x1="0"  y1="0" x2="0"  y2="240" class="guide"/>
    <line x1="140" y1="0" x2="140" y2="240" class="guide"/>

    <!-- cabin block -->
    <rect x="35" y="70" width="70" height="110" rx="3" class="soft"/>
    <text x="70" y="130" text-anchor="middle" class="lbl" font-size="10">CABIN</text>

    <!-- PIT / OH arrows -->
    <g class="dimline" marker-end="url(#arrow)" marker-start="url(#arrow)">
      <line x1="165" y1="200" x2="165" y2="240"/>
      <line x1="165" y1="0"   x2="165" y2="40"/>
    </g>
    <text x="172" y="225" class="warn" font-size="10">PIT</text>
    <text x="172" y="25"  class="warn" font-size="10">OH</text>

    <!-- numeric labels -->
    <text x="168" y="238" class="warn" font-size="9" id="svgPitTxt" text-anchor="start">—</text>
    <text x="168" y="38"  class="warn" font-size="9" id="svgOhTxt"  text-anchor="start">—</text>
  </g>

  <!-- ===================== MIDDLE: PLAN VIEW ===================== -->
  <g transform="translate(290,55)">
    <text x="130" y="-15" text-anchor="middle" class="lbl" font-size="12" font-weight="bold">PLAN VIEW</text>

    <!-- shaft outer -->
    <rect x="0" y="0" width="260" height="180" class="frame"/>

    <!-- cabin inner -->
    <rect x="55" y="25" width="150" height="120" rx="3" fill="#eff6ff" stroke="#2563eb" stroke-width="1.5"/>

    <!-- dimension lines HW / HD -->
    <g class="dimline" marker-end="url(#arrow)" marker-start="url(#arrow)">
      <line x1="0" y1="205" x2="260" y2="205"/>
      <line x1="285" y1="0" x2="285" y2="180"/>
    </g>
    <text x="130" y="222" text-anchor="middle" class="dim" font-size="11" font-weight="bold">
      HW (Width): <tspan id="svgHwTxt">—</tspan>
    </text>
    <text x="305" y="90" transform="rotate(90 305,90)" text-anchor="middle" class="dim" font-size="11" font-weight="bold">
      HD (Depth): <tspan id="svgHdTxt">—</tspan>
    </text>

    <!-- CWxCD label -->
    <text x="130" y="92" text-anchor="middle" fill="#2563eb" font-size="10" font-weight="bold">
      CW x CD: <tspan id="svgCwCdTxt">—</tspan>
    </text>

    <!-- entrance -->
    <rect x="70" y="175" width="120" height="10" fill="#1e3a8a" rx="2"/>
    <text x="130" y="172" text-anchor="middle" fill="#1e3a8a" font-size="9" font-weight="bold">ENTRANCE</text>
  </g>

  <!-- ===================== RIGHT: ELEVATION (FLOORS) ===================== -->
  <g transform="translate(610,25)">
    <text x="155" y="0" text-anchor="middle" class="lbl" font-size="12" font-weight="bold">ELEVATION VIEW</text>

    <!-- shaft vertical frame -->
    <rect x="70" y="25" width="170" height="280" class="frame"/>
    <!-- guide line for floors -->
    <line x1="70" y1="25" x2="240" y2="25"  class="guide"/>
    <line x1="70" y1="305" x2="240" y2="305" class="guide"/>

    <!-- dynamic floors container -->
    <g id="svgFloors"></g>

    <!-- cabin in elevation (moves by JS, default middle) -->
    <rect id="svgCabElev" x="105" y="135" width="100" height="70" rx="3" class="soft"/>
    <text x="155" y="175" text-anchor="middle" class="lbl" font-size="10">CABIN</text>

    <!-- left dimension: TH (Travel Height) -->
    <g class="dimline" marker-end="url(#arrow)" marker-start="url(#arrow)">
      <line x1="50" y1="25" x2="50" y2="305"/>
    </g>
    <text x="42" y="168" transform="rotate(-90 42,168)" text-anchor="middle" class="dim" font-size="11" font-weight="bold">
      TH: <tspan id="svgThTxt">—</tspan>
    </text>

    <!-- right dimension: FH (Floor Height) -->
    <g class="dimline" marker-end="url(#arrow)" marker-start="url(#arrow)">
      <line id="svgFhLine" x1="260" y1="255" x2="260" y2="305"/>
    </g>
    <text x="270" y="285" class="dim" font-size="11" font-weight="bold">
      FH: <tspan id="svgFhTxt">—</tspan>
    </text>

    <!-- bottom PIT & top OH labels -->
    <text x="155" y="330" text-anchor="middle" class="warn" font-size="10">
      PIT: <tspan id="svgPit2Txt">—</tspan>
    </text>
    <text x="155" y="18" text-anchor="middle" class="warn" font-size="10">
      OH: <tspan id="svgOh2Txt">—</tspan>
    </text>

    <!-- floors count -->
    <text x="155" y="315" text-anchor="middle" class="dim" font-size="10" font-weight="bold">
      Stops / Floors: <tspan id="svgStopsTxt">—</tspan>
    </text>
  </g>
</svg>


            <g transform="translate(240, 60)">
                <text x="75" y="-15" text-anchor="middle" font-size="12" font-weight="bold" fill="#1e3a8a">PLAN VIEW</text>
                
                <rect x="0" y="0" width="150" height="150" fill="none" stroke="#1e293b" stroke-width="2" />
                
                <rect x="30" y="20" width="90" height="100" fill="#eff6ff" stroke="#2563eb" stroke-width="1.5" rx="2" />
                
                <g stroke="#64748b" stroke-width="0.8" marker-end="url(#arrow)" marker-start="url(#arrow)">
                    <line x1="0" y1="165" x2="150" y2="165" /> <line x1="165" y1="0" x2="165" y2="150" /> </g>
                <text x="75" y="180" text-anchor="middle" font-size="10" font-weight="bold" fill="#475569">HW (Width)</text>
                <text x="175" y="80" transform="rotate(90 175,80)" text-anchor="middle" font-size="10" font-weight="bold" fill="#475569">HD (Depth)</text>
                
                <text x="75" y="75" text-anchor="middle" font-size="9" fill="#2563eb">CW x CD</text>
                
                <rect x="35" y="145" width="80" height="8" fill="#1e3a8a" rx="2" />
                <text x="75" y="142" text-anchor="middle" font-size="8" fill="#1e3a8a" font-weight="bold">ENTRANCE</text>
            </g>
        </svg>
    </div>
</div>

<div style="margin-top: 15px; padding: 10px; background: #fffcf0; border-right: 4px solid #f59e0b; font-size: 10.5px; color: #92400e;">
    <strong>ملاحظة فنية:</strong> المخطط أعلاه يعبر عن التوزيع القياسي للمكونات. يتم تزويد العميل بمخطط تنفيذي نهائي (Shop Drawing) بعد توقيع العقد واعتماد مقاسات الموقع الفعلية من قبل مهندسينا.
</div>


  <!-- ================= SHORT EXPLANATION ================= -->
 <div style="margin-top:18px; padding:12px 15px; border:1px solid #e5e7eb; border-radius:10px; background:#f9fafb; font-size:11px; line-height:1.7;">

<strong style="color:#1e3a8a">التفسير الهندسي للمخطط:</strong><br><br>

• يوضح المخطط أعلاه التوزيع القياسي لبئر المصعد والكابينة وفق متطلبات المواصفة الأوروبية EN 81-20/50 المعتمدة دولياً.<br>

• تم اعتماد أبعاد البئر (HW × HD) بما يضمن خلوصات أمان كافية للهيكل المعدني ومسارات الحركة.<br>

• تم احتساب عمق الحفرة (Pit) والخلوص العلوي (O.H) لضمان حماية فنيي الصيانة وفق متطلبات السلامة التشغيلية.<br>

• يمثل الرسم الجانبي عدد الأدوار الفعلي ومسافة الارتفاع الصافي (Travel Height – TH) وارتفاع الدور الواحد (FH).<br>

• جميع المقاسات تعتبر إرشادية وتخضع للمراجعة النهائية بعد الرفع المساحي للموقع واعتماد المخططات التنفيذية (Shop Drawings).<br><br>

<div dir="ltr" style="font-size:10.5px; color:#475569;">
This engineering layout illustrates the standard shaft and cabin dimensions in compliance with EN 81-20/50.  
All dimensions are subject to final site verification and approved shop drawings prior to manufacturing.
</div>


</div>

</div>

   

<!-- =================================================
 PAGE 6 | EN81 Standard Dimensions Table
================================================= -->
<div class="page en81-annex-page">

  <div class="page-header">
    <img src="/public/images/logo.png" class="header-logo" alt="RKL Logo">

    <div class="header-text">
      <div class="company-name">RKL للمصاعد والسلالم الكهربائية</div>
      <div class="company-sub">
        السجل التجاري: 1010709355 – الرقم الضريبي: 302250422600003<br>
        السليمانية – الرياض – هاتف: 0114774021 – WWW.RKL.SA
      </div>
    </div>

    <div class="header-meta">
      رقم العرض: <strong class="bind_quote_number">—</strong><br>
      تاريخ العرض: <strong class="bind_offer_date">—</strong>
    </div>
  </div>

  <div class="section-title center">
    ملحق (ب): جدول المقاسات القياسية المعتمدة حسب EN81<br>
    <span class="subtitle">EN81 Standard Shaft & Cabin Dimensions</span>
  </div>




<p style="font-size:12px; line-height:1.7; color:#374151; margin-bottom:10px">
يعتمد تصميم ومقاسات بئر المصعد والكابينة الواردة في هذا العرض على
<strong>المعايير الأوروبية EN81</strong> المعتمدة دوليًا.
وبناءً عليه، فإن المصعد المختار من قبل العميل سيتم تنفيذه بمقاسات
مطابقة لجدول الاعتماد الدولي EN81 أو بما يتوافق مع حالة الموقع والمخططات
التنفيذية المعتمدة، دون الإخلال بمتطلبات السلامة أو الأداء.
</p>

<div class="section-title">
  ملحق (ب): جدول المقاسات القياسية المعتمدة حسب EN81
</div>

<table id="en81-table" class="standard-table">
  <thead>
    <tr>
      <th>الحمولة (kg)</th>
      <th>عدد المصاعد</th>
      <th>مقاس الكابينة (mm)</th>
      <th>مقاس البئر (mm)</th>
      <th>عرض الباب (mm)</th>
      <th>Pit (mm)</th>
      <th>OH (mm)</th>
    </tr>
  </thead>
  <tbody>

    <!-- 450 KG -->
    <tr
      data-capacity="450"
      data-cabin="1000x1100"
      data-shaft="1500x1700"
      data-door="700"
      data-pit="1200"
      data-oh="3500"
    >
      <td>450</td>
      <td class="en81-count">0</td>
      <td>1000 × 1100</td>
      <td>1500 × 1700</td>
      <td>700</td>
      <td>1200</td>
      <td>3500</td>
    </tr>

    <!-- 630 KG -->
    <tr
      data-capacity="630"
      data-cabin="1100x1400"
      data-shaft="1600x1800"
      data-door="800"
      data-pit="1200"
      data-oh="3500"
    >
      <td>630</td>
      <td class="en81-count">0</td>
      <td>1100 × 1400</td>
      <td>1600 × 1800</td>
      <td>800</td>
      <td>1200</td>
      <td>3500</td>
    </tr>

    <!-- 800 KG -->
    <tr
      data-capacity="800"
      data-cabin="1350x1400"
      data-shaft="1600x2000"
      data-door="900"
      data-pit="1300"
      data-oh="3600"
    >
      <td>800</td>
      <td class="en81-count">0</td>
      <td>1350 × 1400</td>
      <td>1600 × 2000</td>
      <td>900</td>
      <td>1300</td>
      <td>3600</td>
    </tr>

    <!-- 1000 KG -->
    <tr
      data-capacity="1000"
      data-cabin="1600x1500"
      data-shaft="1800x2200"
      data-door="900"
      data-pit="1400"
      data-oh="3700"
    >
      <td>1000</td>
      <td class="en81-count">0</td>
      <td>1600 × 1500</td>
      <td>1800 × 2200</td>
      <td>900</td>
      <td>1400</td>
      <td>3700</td>
    </tr>

    <!-- 1275 KG -->
    <tr
      data-capacity="1275"
      data-cabin="1800x1600"
      data-shaft="1900x2400"
      data-door="1100"
      data-pit="1400"
      data-oh="3800"
    >
      <td>1275</td>
      <td class="en81-count">0</td>
      <td>1800 × 1600</td>
      <td>1900 × 2400</td>
      <td>1100</td>
      <td>1400</td>
      <td>3800</td>
    </tr>

    <!-- 1600 KG -->
    <tr
      data-capacity="1600"
      data-cabin="1800x2000"
      data-shaft="2400x2600"
      data-door="1100"
      data-pit="1500"
      data-oh="4000"
    >
      <td>1600</td>
      <td class="en81-count">0</td>
      <td>1800 × 2000</td>
      <td>2400 × 2600</td>
      <td>1100</td>
      <td>1500</td>
      <td>4000</td>
    </tr>

  </tbody>
</table>


<p style="font-size:11px; color:#6b7280; margin-top:8px">
  جميع القيم الواردة في الجدول أعلاه هي قيم إرشادية وفق معيار EN81،
  وتخضع للتعديل بما يتوافق مع حالة الموقع والمخططات التنفيذية النهائية
  (Final Shop Drawings) المعتمدة من الاستشاري والجهات المختصة.
</p>

   <!-- =========================
  ANNEX (C) | Cabin Interior Design
  يوضع تحت ملحق (ب) مباشرة
========================= -->

<div class="annexC-wrap" id="annexC">

  <div class="annexC-title">ملحق (ج): تصميم الكابينة الداخلية</div>
  <div class="annexC-subtitle">
    Cabin Interior Finishing & Flooring Specification
  </div>

  <table class="standard-table" id="annexC-table">
    <thead>
      <tr>
        <th style="width:50%">نوع التشطيب الداخلي للكابينة</th>
        <th style="width:50%">تشطيب الأرضية</th>
      </tr>
    </thead>
    <tbody>
      <tr data-cabin="SS304-Hairline" data-floor="Vinyl">
        <td>ستانلس ستيل 304 – Hairline</td>
        <td>فينيل</td>
      </tr>

      <tr data-cabin="SS304-Mirror" data-floor="Granite">
        <td>ستانلس ستيل 304 – مرايا</td>
        <td>جرانيت</td>
      </tr>

      <tr data-cabin="Mirror-SS304" data-floor="Marble">
        <td>مرايا + ستانلس</td>
        <td>رخام</td>
      </tr>

      <tr data-cabin="Wood-SS304" data-floor="Aluminum-Checker">
        <td>خشبي + ستانلس</td>
        <td>ألمنيوم Checker Plate</td>
      </tr>

      <tr data-cabin="Custom" data-floor="Custom">
        <td>تصميم خاص (Custom Design)</td>
        <td>حسب اختيار العميل</td>
      </tr>
    </tbody>
  </table>

  <p style="font-size:11px; margin-top:8px; color:#6b7280;">
    يتم تمييز الصف المختار وفق بيانات عرض السعر المعتمدة.
  </p>

</div>





</div>


<!-- =================================================
 PAGE 7 | Financial Summary & Payment Schedule
================================================= -->
<div class="page">

  <div class="page-header">


  <!-- شعار ثابت -->
  <img src="/public/images/logo.png" class="header-logo" alt="RKL Logo">

  <div class="header-text">
    <div class="company-name">RKL للمصاعد والسلالم الكهربائية</div>
    <div class="company-sub">
      السجل التجاري: 1010709355 – الرقم الضريبي: 302250422600003<br>
      السليمانية – الرياض – هاتف: 0114774021 – WWW.RKL.SA
    </div>
  </div>

  <div class="header-meta">
    رقم العرض: <strong class="bind_quote_number">—</strong><br>
    تاريخ العرض: <strong class="bind_offer_date">—</strong>
  </div>

</div>




<!-- ===============================
  سابعاً: ملخص القيمة المالية
================================ -->
<div class="section-title">سابعاً: ملخص القيمة المالية</div>

<!-- ===============================
  7-1) ملخص عرض السعر والبنود
================================ -->
<div class="section-title">7-1) ملخص عرض السعر والبنود</div>

<table id="items-table">
  <thead>
    <tr>
      <th style="width:40%">وصف البند</th>
      <th style="width:10%">الكمية</th>
      <th style="width:20%">سعر الوحدة (SAR)</th>
      <th style="width:20%">الإجمالي (SAR)</th>
      <th style="width:10%">✖</th>
    </tr>
  </thead>
  <tbody>
    <!-- بند رئيسي تلقائي من عرض السعر -->
    <tr>
      <td class="item-desc auto-main-item"></td>

      <td><input type="number" class="qty" value="1" min="1"></td>
      <td><input type="number" class="unit" value="0" min="0"></td>
      <td class="row-total">0.00</td>
      <td style="text-align:center">—</td>
    </tr>
  </tbody>

  <tfoot>
    <tr style="background:#f8fafc;font-weight:bold">
      <td colspan="3" style="text-align:right">الإجمالي قبل الضريبة</td>
      <td id="itemsSubtotal">SAR 0.00</td>
      <td></td>
    </tr>
  </tfoot>
</table>

<div style="margin-top:8px">
  <button type="button" onclick="addExtraRow()">➕ إضافة بند إضافي</button>
</div>

<!-- ===============================
  7-2) تعديل السعر قبل الضريبة (اختياري)
================================ -->
<div class="price-adjust-section">

  <div class="section-title">7-2) تعديل السعر قبل الضريبة (اختياري)</div>

  <select id="adjustmentType">
    <option value="none">بدون تعديل</option>
    <option value="discount">خصم</option>
    <option value="increase">زيادة</option>
  </select>

  <input type="number" id="adjustmentValue" placeholder="أدخل المبلغ">

</div>


<!-- ===============================
  7-3) جدول الدفعات المقترح
================================ -->
<div class="section-title">7-3) جدول الدفعات المقترح</div>

<table>
  <tbody>
    <tr><td>عند توقيع العقد</td><td>50%</td><td class="pay50">—</td></tr>
    <tr><td>عند الانتهاء من الأعمال الميكانيكية</td><td>25%</td><td class="pay25">—</td></tr>
    <tr><td>بعد الانتهاء من الأعمال الكهربائية والتشغيل</td><td>20%</td><td class="pay20">—</td></tr>
    <tr><td>عند التسليم النهائي للمصعد</td><td>5%</td><td class="pay5">—</td></tr>

    <tr><th>الإجمالي قبل التعديل</th><th></th><th class="subtotalBefore">—</th></tr>
    <tr><th>قيمة الخصم / الزيادة</th><th></th><th class="adjustmentAmount">—</th></tr>
    <tr><th>الإجمالي بعد التعديل</th><th></th><th class="subtotalAfter">—</th></tr>
    <tr><th>ضريبة القيمة المضافة (15%)</th><th></th><th class="vatAmount">—</th></tr>
    <tr style="background:#f0f9ff;font-weight:bold">
      <th>الإجمالي النهائي (شامل الضريبة)</th>
      <th>100%</th>
      <th class="grandTotal">—</th>
    </tr>
  </tbody>
</table>

<div class="contract-terms">
  <h4>٨) بنود رئيسية للعقد (قابلة للتعديل)</h4>

<ol>

<li>
يُعد هذا العرض جزءًا لا يتجزأ ومكمّلًا لعقد توريد وتركيب وتشغيل المصعد،
ويُعمل به بعد اعتماده وتوقيعه من الطرفين.
</li>

<li>
جميع الأسعار الواردة في هذا العرض بالريال السعودي وتشمل ضريبة القيمة المضافة
بنسبة (15%) ما لم يُذكر خلاف ذلك صراحةً.
</li>

<li>
مدة تنفيذ المشروع تبدأ من تاريخ استلام الدفعة الأولى واعتماد المخططات
والمقاسات النهائية من قبل الاستشاري أو المالك.
</li>

<li>
يلتزم الطرف الأول بتوفير التغذية الكهربائية المناسبة (3 فاز – 380 فولت)
وتنفيذ جميع الأعمال المدنية الخاصة بالبئر وفتحات الأبواب وفق المخططات المعتمدة.
</li>

<li>
في حال وجود أي تعديل بالموقع بعد اعتماد المخططات التنفيذية،
يتم إصدار عرض سعر إضافي (Variation Order) لاعتماده قبل التنفيذ.
</li>

<li>
لا يتحمل الطرف الثاني أي مسؤولية عن التأخير الناتج عن:
تأخر الدفعات، أو تأخر الأعمال المدنية، أو عدم جاهزية الموقع.
</li>

<li>
في حال تأخر الدفعات المستحقة، يحق للطرف الثاني إيقاف الأعمال مؤقتًا
دون تحمل أي مسؤولية عن الآثار الناتجة عن ذلك.
</li>

<li>
لا يتحمل الطرف الثاني مسؤولية الأعطال الناتجة عن:
سوء الاستخدام، أو العبث، أو تدخل جهات غير معتمدة،
أو تقلبات الجهد الكهربائي غير المستقر.
</li>

<li>
تبدأ فترة الضمان من تاريخ التسليم الابتدائي،
ولا تشمل قطع الاستهلاك أو الأعطال الناتجة عن سوء الاستخدام.
</li>

<li>
لا يشمل هذا العرض أي أعمال مدنية أو معمارية
ما لم يتم النص عليها صراحةً في جدول البنود المالية.
</li>

<li>
تخضع جميع المخططات التنفيذية لاعتماد نهائي من المكتب الفني للطرف الثاني
قبل بدء التصنيع.
</li>

<li>
في حال إلغاء المشروع بعد بدء التصنيع،
يتم احتساب قيمة المواد المصنّعة وأي التزامات مالية قائمة.
</li>

<li>
مدة سريان هذا العرض (30) يومًا من تاريخ الإصدار،
ويُعد لاغيًا تلقائيًا بعد انتهاء المدة دون تعميد رسمي.
</li>

<li>
تكون ولاية القضاء للمحاكم المختصة في المملكة العربية السعودية.
</li>

<li>
يُعد توقيع هذا العرض بمثابة إقرار بمراجعة كافة البنود الفنية والمالية
والموافقة عليها دون تحفظ.
</li>

</ol>

</div>

   <!-- =================================================
 FINAL PAGE | Contact & Corporate Confidence Page
================================================= -->
<div class="page final-contact-page">

  <div style="text-align:center; margin-bottom:25px;">
    <img src="/public/images/logo.png" 
         style="width:90px; margin-bottom:10px;">
    <h2 style="margin:0; font-size:20px; color:#1e3a8a;">
      آر كي ال RKL للمصاعد والسلالم الكهربائية
    </h2>
    <div style="font-size:12px; color:#6b7280;">
      Elevators & Escalators Solutions
    </div>
  </div>

  <!-- صورة الفريق -->
  <div style="text-align:center; margin-bottom:25px;">
    <img src="/public/images/final_page.png"
         style="width:100%; max-height:180mm; object-fit:cover; border-radius:12px; border:1px solid #e5e7eb;">
  </div>

  <!-- رسالة الثقة -->
  <div style="margin-top:20px; font-size:13px; line-height:1.9; text-align:justify;">
    <strong style="color:#1e3a8a;">رسالة إلى عملائنا الكرام:</strong><br><br>

    في مؤسسة <strong>RKL</strong> نؤمن أن المصعد ليس مجرد وسيلة نقل،
    بل هو عنصر أمان وثقة واستدامة في كل مشروع.

    نحن نلتزم بتقديم حلول هندسية متكاملة،
    تعتمد على أعلى معايير الجودة والسلامة الدولية (EN81)،
    ونحرص على أن يكون كل مشروع يعكس اسمنا وسمعتنا في السوق السعودي.

    خبرتنا الممتدة، وشراكاتنا العالمية،
    وفريقنا الفني المتخصص،
    هي ضمانكم الحقيقي لنجاح المشروع واستمراريته.

    <br><br>

    <div dir="ltr" style="font-size:12px; color:#475569;">
      At RKL, we believe an elevator is not just transportation —
      it is safety, reliability, and long-term value.
      Our commitment to quality, engineering excellence,
      and international standards ensures every project
      is delivered with precision and confidence.
    </div>
  </div>

  <!-- معلومات التواصل -->
  <div style="margin-top:35px; border-top:2px solid #1e3a8a; padding-top:20px;">

    <div style="display:flex; justify-content:space-between; align-items:center;">

      <div style="font-size:14px; line-height:2;">
        📞 <strong>الهاتف:</strong> 0114774021  
        <span style="color:#16a34a;">(متوفر واتساب)</span><br>

        📧 <strong>البريد الإلكتروني:</strong> sales@rkl.sa<br>

        🌐 <strong>الموقع الإلكتروني:</strong> www.rkl.sa<br>

        📍 <strong>العنوان:</strong> السليمانية – الرياض
      </div>

      <!-- QR Code -->
      <div>
        <img src="/mnt/data/WhatsApp Image 2025-09-16 at 01.40.11_56b7bc3f.jpg"
             style="width:120px; border:1px solid #e5e7eb; padding:5px; border-radius:8px;">
        <div style="text-align:center; font-size:11px; margin-top:6px; color:#6b7280;">
          امسح الرمز للتواصل مباشرة
        </div>
      </div>

    </div>

  </div>

  <!-- ختم احترافي -->
  <div style="margin-top:40px; text-align:center; font-size:12px; color:#6b7280;">
    RKL © جميع الحقوق محفوظة – مؤسسة سعودية معتمدة  
    السجل التجاري: 1010709355  
    الرقم الضريبي: 302250422600003
  </div>

</div>



<!-- زر طباعة عام -->
<div style="text-align:center; margin-top:10px;">
  <button class="btn-print" onclick="printWithName()">طباعة / حفظ PDF</button>
    <div id="warn_no_data" class="warning" style="display:none;">
      لم يتم العثور على عرض سعر محفوظ في السجل. الرجاء العودة إلى نموذج التسعير وحفظ عرض السعر أولاً.
    </div>
</div>

   
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

<script src="/public/rkl-map.js"></script>
<script src="/public/rkl-summary.js"></script>



<script>
/* =================================================
   Helper: bind text safely
================================================= */
const bindAll = (selector, value) => {
  document.querySelectorAll(selector).forEach(el => {
    el.textContent =
      (value !== undefined && value !== null && value !== '')
        ? value
        : '—';
  });
};

const bind = (selector, value) => {
  document.querySelectorAll(selector).forEach(el => {
    el.textContent =
      (value !== undefined && value !== null && value !== '')
        ? value
        : '—';
  });
};

/* =================================================
   تحميل عرض السعر من LocalStorage
================================================= */
const quotes = JSON.parse(localStorage.getItem('rkl_quotes') || '[]');
const currentIndex = localStorage.getItem('rkl_current_quote_index');
window.q = quotes[currentIndex ?? quotes.length - 1];

   /* ==========================================
   توليد وصف البند الرئيسي تلقائياً
========================================== */
function generateMainItemDescription(q){

  const lifts     = q.liftsCount || '—';
  const brand     = q.brandLabel || '—';
  const machine   = q.machineType || '';
  const capacity  = q.capacity || '—';
  const speed     = q.speed || '—';
  const stops     = q.stops || q.floors || '—';
  const project   = q.projectName || '—';
  const location  = q.projectLocation || '—';

  return `
توريد وتركيب وتشغيل عدد ${lifts} مصعد كهربائي
من نوع ${brand} ${machine ? '– ' + machine : ''}
بحمولة ${capacity} بسرعة ${speed}
بعدد ${stops} وقفات
لصالح مشروع ${project}
في موقع ${location}
وفق المواصفات الفنية المعتمدة في هذا العرض.
  `.replace(/\n\s+/g,' ').trim();
}

/* تعبئة البند الرئيسي */
document.addEventListener("DOMContentLoaded", function(){
  if(!q) return;

  const descCell = document.querySelector('.auto-main-item');
  if(descCell){
    descCell.textContent = generateMainItemDescription(q);
  }
});


   /* =================================================
   EN81 Annex (B): تعبئة عدد المصاعد لكل صنف من سجل العروض
   المطلوب: جمع عدد المصاعد حسب الحمولة من rkl_quotes
================================================= */
function normDim(v){
  return String(v || '')
    .replace(/\s+/g,'')
    .replace('×','x')
    .toLowerCase();
}

function fillEN81CountsFromCurrentQuote(){
  if(!window.q) return;

  // صفّر
  document.querySelectorAll('#en81-table .en81-count').forEach(td => td.textContent = '0');
  document.querySelectorAll('#en81-table tbody tr').forEach(tr => tr.classList.remove('en81-active','en81-match'));

  const dist = q.en81Distribution || null;

  // إذا ما في distribution (عروض قديمة)، fallback على liftsCount على صف واحد مطابق
  document.querySelectorAll('#en81-table tbody tr[data-capacity]').forEach(tr => {

    const rowKey = [
      String(tr.dataset.capacity || ''),
      normDim(tr.dataset.cabin),
      normDim(tr.dataset.shaft),
      normDim(tr.dataset.door),
      normDim(tr.dataset.pit),
      normDim(tr.dataset.oh)
    ].join('|');

    let val = 0;

    if(dist){
      // مفاتيحنا مخزنة بدون تحويل × إلى x داخل التخزين؟
      // عملنا التخزين cabin/shaft بدون × (حسب النص)، لذلك نطبع نفس normDim
      // نعيد بناء مفتاح مثل التخزين
      const cap = String(tr.dataset.capacity || '');
      const key2 = [
        cap,
        String(tr.querySelectorAll('td')[2]?.textContent || '').replace(/\s+/g,'').replace('×','x').toLowerCase(),
        String(tr.querySelectorAll('td')[3]?.textContent || '').replace(/\s+/g,'').replace('×','x').toLowerCase(),
        String(tr.dataset.door || '').replace(/\s+/g,''),
        String(tr.dataset.pit || '').replace(/\s+/g,''),
        String(tr.dataset.oh || '').replace(/\s+/g,'')
      ].join('|');

      // حاول بالمفتاحين (احتياط)
      val = Number(dist[rowKey] || dist[key2] || 0);
    }

    // fallback (عرض قديم): لو يطابق صف واحد حسب q.cabinSize/q.shaftSize...
    if(!dist && window.q){
      const sel = {
        capacity: normDim(q.capacity),
        cabin: normDim(q.cabinSize),
        shaft: normDim(q.shaftSize),
        door: normDim(q.doorSize || q.doors),
        pit: normDim(q.pit),
        oh: normDim(q.oh)
      };
      const rowData = {
        capacity: normDim(tr.dataset.capacity),
        cabin: normDim(tr.dataset.cabin),
        shaft: normDim(tr.dataset.shaft),
        door: normDim(tr.dataset.door),
        pit: normDim(tr.dataset.pit),
        oh: normDim(tr.dataset.oh)
      };
      const isMatch =
        rowData.capacity === sel.capacity &&
        rowData.cabin === sel.cabin &&
        rowData.shaft === sel.shaft &&
        rowData.door === sel.door &&
        rowData.pit === sel.pit &&
        rowData.oh === sel.oh;

      if(isMatch) val = Number(q.liftsCount || 1);
    }

    const cell = tr.querySelector('.en81-count');
    if(cell) cell.textContent = String(val);

    if(val > 0) tr.classList.add('en81-active');
  });
}




if (!q) {
  alert('لا يوجد عرض سعر لعرضه');
}

/* 🔴 شغّل الربط مباشرة */
highlightEN81Row();

/* =================================================
   (1) بيانات العرض العامة
================================================= */
bindAll('.bind_quote_number', q.quoteNumber);
bindAll('.bind_offer_date', q.timestamp?.slice(0, 10));


/* =================================================
   (2) بيانات العميل
================================================= */
bind('.bind_customer_name', q.customerName);
bind('.bind_customer_type', q.customerDetails?.customer_type || '—');
bind('.bind_contact_person', q.customerDetails?.contact_person || '—');
bind('.bind_cr_number', q.customerDetails?.cr_number || '—');
bind('.bind_tax_number', q.customerDetails?.tax_number || '—');
bind('.bind_customer_phone', q.customerDetails?.mobile || q.customerDetails?.phone || '—');
bind('.bind_customer_email', q.customerDetails?.email || '—');

/* =================================================
   (3) عنوان العميل
================================================= */
bind('.bind_city', q.customerDetails?.city || '—');
bind('.bind_district', q.customerDetails?.district || '—');
bind('.bind_street', q.customerDetails?.street || '—');
bind('.bind_building_number', q.customerDetails?.building_no || '—');
bind('.bind_postal_code', q.customerDetails?.postal_code || '—');
bind('.bind_national_address', q.customerDetails?.full_address || '—');

/* =================================================
   (4) بيانات المشروع
================================================= */
bind('.bind_project_name', q.projectName || '—');
bind('.bind_project_location', q.projectLocation || '—');

/* =================================================
   (5) بيانات المصاعد – FINAL STABLE
================================================= */

bind('.bind_brand', q.brandLabel);
bind('.bind_usage', 'Passenger Elevator');

bind('.bind_lifts', q.liftsCount);
bind('.bind_capacity', q.capacity);
bind('.bind_speed', q.speed);

// عدد التوقفات
bind('.bind_stops', q.stops || q.floors);

// الارتفاعات
bind('.bind_fh', q.floorHeight ? q.floorHeight + ' mm' : null);
bind('.bind_th', q.travelHeight ? q.travelHeight + ' mm' : null);

// نظام التركيب
bind('.bind_machine_type', q.machineType || 'MRL – Machine Room Less');

/* =================================================
   EN81: تظليل الصف حسب مواصفات المصعد
================================================= */
function highlightEN81Row() {
  if (!window.q) return;

  // دالة تنظيف القيم
  const norm = v =>
    String(v || '')
      .replace(/\s+/g, '')
      .replace('×', 'x')
      .toLowerCase();

  const selected = {
    capacity: norm(q.capacity),
    cabin: norm(q.cabinSize),
    shaft: norm(q.shaftSize),
    door: norm(q.doorSize || q.doors || q.door),

    pit: norm(q.pit),
    oh: norm(q.oh)
  };

  document.querySelectorAll('#en81-table tr').forEach(row => {

    const rowData = {
      capacity: norm(row.dataset.capacity),
      cabin: norm(row.dataset.cabin),
      shaft: norm(row.dataset.shaft),
      door: norm(row.dataset.door),
      pit: norm(row.dataset.pit),
      oh: norm(row.dataset.oh)
    };

    const isMatch =
      rowData.capacity === selected.capacity &&
      rowData.cabin    === selected.cabin &&
      rowData.shaft    === selected.shaft &&
      rowData.door     === selected.door &&
      rowData.pit      === selected.pit &&
      rowData.oh       === selected.oh;

    if (isMatch) {
      row.classList.add('en81-match');

      const countCell = row.querySelector('.en81-count');
      if (countCell) {
        countCell.textContent = q.liftsCount || 1;
      }
    }
  });
}
function toNum(v){
  const n = Number(String(v ?? '').replace(/[^\d.]/g,''));
  return Number.isFinite(n) ? n : 0;
}

function splitWxH(dim){
  // يقبل "1800x1600" أو "1800 × 1600"
  const s = String(dim || '').replace('×','x').replace(/\s+/g,'');
  const parts = s.split('x');
  return {
    w: parts[0] || '—',
    h: parts[1] || '—'
  };
}

function renderEN81Diagram(){
  if(!window.q) return;

  // قيم أساسية
  const pit = q.pit ?? '—';
  const oh  = q.oh  ?? '—';
  const th  = q.travelHeight ? (String(q.travelHeight).includes('mm') ? q.travelHeight : q.travelHeight + ' mm') : '—';
  const fh  = q.floorHeight  ? (String(q.floorHeight).includes('mm')  ? q.floorHeight  : q.floorHeight  + ' mm') : '—';
  const stops = q.stops || q.floors || '—';

  // HW/HD و CW/CD
  const shaft = splitWxH(q.shaftSize);
  const cabin = splitWxH(q.cabinSize);

  // تعبئة نصوص الـ SVG
  const setTxt = (id, val) => { const el = document.getElementById(id); if(el) el.textContent = val; };

  setTxt('svgPitTxt',  String(pit));
  setTxt('svgOhTxt',   String(oh));
  setTxt('svgPit2Txt', String(pit));
  setTxt('svgOh2Txt',  String(oh));

  setTxt('svgThTxt',   String(th));
  setTxt('svgFhTxt',   String(fh));
  setTxt('svgStopsTxt', String(stops));

  setTxt('svgHwTxt', shaft.w);
  setTxt('svgHdTxt', shaft.h);
  setTxt('svgCwCdTxt', `${cabin.w} x ${cabin.h}`);

  // رسم خطوط الأدوار داخل ELEVATION
  const floorsG = document.getElementById('svgFloors');
  if(!floorsG) return;
  floorsG.innerHTML = '';

  // منطقة الارتفاع داخل الإطار (من y=25 إلى y=305)
  const yTop = 25, yBot = 305, xL = 70, xR = 240;
  const floorsCount = Math.max(2, toNum(stops) || 2); // حد أدنى 2 حتى يبان شكل الأدوار
  const step = (yBot - yTop) / (floorsCount - 1);

  for(let i=0; i<floorsCount; i++){
    const y = yBot - (i * step);

    // خط الدور
    const line = document.createElementNS('http://www.w3.org/2000/svg','line');
    line.setAttribute('x1', xL);
    line.setAttribute('x2', xR);
    line.setAttribute('y1', y);
    line.setAttribute('y2', y);
    line.setAttribute('stroke', '#cbd5e1');
    line.setAttribute('stroke-width', '1');
    floorsG.appendChild(line);

    // اسم الدور (F0, F1...)
    const t = document.createElementNS('http://www.w3.org/2000/svg','text');
    t.setAttribute('x', xR + 8);
    t.setAttribute('y', y + 4);
    t.setAttribute('fill', '#475569');
    t.setAttribute('font-size', '9');
    t.textContent = `F${i}`;
    floorsG.appendChild(t);
  }

  // تحريك كابينة الإليفيشن لمنتصف المسار تقريباً
  const cab = document.getElementById('svgCabElev');
  if(cab){
    const midY = yTop + (yBot - yTop) * 0.45;
    cab.setAttribute('y', Math.max(yTop + 10, Math.min(midY, yBot - 80)));
  }

  // FH line طولها يعتمد على خطوة الأدوار (تقريب بصري)
  const fhLine = document.getElementById('svgFhLine');
  if(fhLine){
    const y2 = yBot;
    const y1 = yBot - step;
    fhLine.setAttribute('y1', y1);
    fhLine.setAttribute('y2', y2);
  }
}

// شغّلها بعد تحميل الصفحة وربط q
document.addEventListener("DOMContentLoaded", function(){
  try { renderEN81Diagram(); } catch(e) {}
});

 function escHtml(s){
    return String(s ?? '').replace(/[&<>"']/g, m => ({
      '&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'
    }[m]));
  }


function highlightAnnexCRow() {
  if (!window.q) return;

  const cabinSelected = String(q.cabinDesign || '').trim();
  const floorSelected = String(q.floorFinish || '').trim();

  document.querySelectorAll('#annexC-table tbody tr').forEach(row => {

    const rowCabin = row.dataset.cabin;
    const rowFloor = row.dataset.floor;

    const match =
      rowCabin === cabinSelected ||
      rowFloor === floorSelected;

    if (match) {
      row.classList.add('annexC-active');
    }
  });
}

/* شغّلها بعد تحميل البيانات */
highlightAnnexCRow();

  // بعد highlightEN81Row مباشرة
  try { renderAnnexC(); } catch(e) {}

/* =================================================
   (3) البيانات الفنية الرئيسية – ربط نهائي صحيح
================================================= */

bind('.bind_brand', q.brandLabel);                 // ماركة المصعد / النظام

bind('.bind_capacity', q.capacity);               // الحمولة
bind('.bind_speed', q.speed);                     // السرعة
bind('.bind_stops', q.stops);                     // عدد التوقفات
bind('.bind_lifts', q.liftsCount);                // عدد المصاعد
bind('.bind_machine_type', q.machineType);        // نوع الماكينة

bind('.bind_cabin_design', q.cabinDesign);        // تشطيب داخلي
bind('.bind_floor_finish', q.floorFinish);        // أرضية الكابينة

bind('.bind_dim_shaft', q.shaftSize);              // مقاس البئر
bind('.bind_dim_cabin', q.cabinSize);              // مقاس الكابينة

bind('.bind_pit', q.pit);                          // PIT
bind('.bind_oh', q.oh);                            // OH

bind('.bind_fh', q.floorHeight);                   // FH
bind('.bind_th', q.travelHeight);                  // TH



/* =================================================
   Helper: format currency (SAR)
================================================= */
function formatCurrency(value) {
  const v = Number(value) || 0;
  return v.toLocaleString('en-US', {
    minimumFractionDigits: 2,
    maximumFractionDigits: 2
  }) + ' SAR';
}

/* =================================================
   (5 + 6 + 6-1 + 7) الحساب المالي الكامل
================================================= */

// ✅ الإجمالي الشامل القادم من سجل عروض الأسعار
const grandTotal = Number(q.totalWithVat || 0);

// ✅ عدد المصاعد
const units = Number(q.liftsCount || 1);

// ✅ نسبة الضريبة
const vatRate = Number(q.vatRate || 15);

   /* =================================================
   مخطط المقاسات – فك القيم بالأرقام
================================================= */
if (!q.shaftSize) q.shaftSize = "1800 x 1600";


// Cabin: "1100 x 1000"
if (q.cabinSize) {
  const [cw, cd] = q.cabinSize.split('x').map(v => v.trim());
  bind('.bind_cabin_width', cw);
  bind('.bind_cabin_depth', cd);
}

// Shaft: "1800 x 1600"
if (q.shaftSize) {
  const [hw, hd] = q.shaftSize.split('x').map(v => v.trim());
  bind('.bind_shaft_width', hw);
  bind('.bind_shaft_depth', hd);
}


// ✅ السعر قبل الضريبة (عكسي)
const baseSubtotal = grandTotal / (1 + vatRate / 100);




/* ✅ تشغيل أولي */
recalcFinancialSummary();

/* ✅ إعادة الحساب عند أي تعديل */
document.getElementById('adjust_type')?.addEventListener('change', recalcFinancialSummary);
document.getElementById('adjust_value')?.addEventListener('input', recalcFinancialSummary);
</script>


<script>
function renderPricingTable(q) {
  const tbody = document.querySelector("#pricing-table tbody");
  if (!tbody || !q.items) return;

  tbody.innerHTML = "";

  q.items.forEach(item => {
    const tr = document.createElement("tr");
    tr.innerHTML = `
      <td>${item.description}</td>
      <td style="text-align:center">${item.quantity}</td>
      <td>${item.unitPrice.toLocaleString()} SAR</td>
      <td>${item.total.toLocaleString()} SAR</td>
    `;
    tbody.appendChild(tr);
  });

  document.querySelector(".bind_subtotal").textContent =
    q.subtotal.toLocaleString() + " SAR";

  document.querySelector(".bind_vat").textContent =
    q.vatAmount.toLocaleString() + " SAR";

  document.querySelector(".bind_total").textContent =
    q.totalWithVat.toLocaleString() + " SAR";
}
</script>
<script>
function renderPayments(q) {
  const tbody = document.querySelector("#payments-table tbody");
  if (!tbody || !q.payments) return;

  tbody.innerHTML = "";

  q.payments.forEach(p => {
    const tr = document.createElement("tr");
    tr.innerHTML = `
      <td>${p.label}</td>
      <td style="text-align:center">${p.percent}%</td>
      <td>${p.amount.toLocaleString()} SAR</td>
    `;
    tbody.appendChild(tr);
  });
}
</script>


<script>
function syncEditableFieldsToStorage() {
  const index = localStorage.getItem('rkl_current_quote_index');
  if (index === null) return;

  const quotes = JSON.parse(localStorage.getItem('rkl_quotes') || '[]');
  const q = quotes[index];
  if (!q) return;

  // ✅ البيانات المعدلة يدويًا
  q.brandLabel   = document.querySelector('.bind_brand')?.textContent?.trim() || q.brandLabel;
  q.capacity     = document.querySelector('.bind_capacity')?.textContent?.trim() || q.capacity;
  q.speed        = document.querySelector('.bind_speed')?.textContent?.trim() || q.speed;
  q.floors       = document.querySelector('.bind_floors')?.textContent?.trim() || q.floors;
  q.cabinSize    = document.querySelector('.bind_dim_cabin')?.textContent?.trim() || q.cabinSize;
  q.shaftSize    = document.querySelector('.bind_dim_shaft')?.textContent?.trim() || q.shaftSize;
  q.pit          = document.querySelector('.bind_pit')?.textContent?.trim() || q.pit;
  q.oh           = document.querySelector('.bind_oh')?.textContent?.trim() || q.oh;

  quotes[index] = q;
  localStorage.setItem('rkl_quotes', JSON.stringify(quotes));
}
</script>


<script>
function printWithName() {
  syncEditableFieldsToStorage();

  const quoteNo = document.querySelector('.bind_quote_number')?.textContent?.trim() || 'quotation';
  const cleanNo = quoteNo.replace(/[^\w\d-]/g, '');

  document.title = `RKL_Quotation_${cleanNo}`;
  window.print();

  setTimeout(() => {
    document.title = 'RKL Elevator Offer';
  }, 1000);
}

</script>



<script>
/* ===============================
   أدوات مساعدة
===============================*/
function formatSAR(v){
  return 'SAR ' + (Number(v)||0).toLocaleString('en-US',{
    minimumFractionDigits:2,
    maximumFractionDigits:2
  });
}

/* ===============================
   إعادة حساب البنود + الدفعات
===============================*/
function recalcPricing(){
  const rows = document.querySelectorAll('#items-table tbody tr');
  let subtotal = 0;

  rows.forEach(row=>{
    const qty  = row.querySelector('.qty');
    const unit = row.querySelector('.unit');
    const totalCell = row.querySelector('.row-total');

    if(!qty || !unit || !totalCell) return;

    const rowTotal = (Number(qty.value)||0) * (Number(unit.value)||0);
    totalCell.textContent = rowTotal.toFixed(2);
    subtotal += rowTotal;
  });

  // إجمالي جدول البنود
  document.getElementById('itemsSubtotal').textContent = formatSAR(subtotal);

  // التعديل قبل الضريبة
  const adjTypeEl = document.getElementById('adjustmentType');
  const adjValEl  = document.getElementById('adjustmentValue');

  let adjAmount = 0;
  if(adjTypeEl && adjValEl){
    const adjVal = Number(adjValEl.value||0);
    if(adjTypeEl.value === 'discount') adjAmount = -adjVal;
    if(adjTypeEl.value === 'increase') adjAmount =  adjVal;
  }

  const afterAdj = subtotal + adjAmount;
  const vat      = afterAdj * 0.15;
  const total    = afterAdj + vat;

  // ربط جدول الدفعات
  document.querySelector('.subtotalBefore').textContent = formatSAR(subtotal);
  document.querySelector('.adjustmentAmount').textContent = formatSAR(adjAmount);
  document.querySelector('.subtotalAfter').textContent = formatSAR(afterAdj);
  document.querySelector('.vatAmount').textContent = formatSAR(vat);
  document.querySelector('.grandTotal').textContent = formatSAR(total);

  document.querySelector('.pay50').textContent = formatSAR(total * 0.50);
  document.querySelector('.pay25').textContent = formatSAR(total * 0.25);
  document.querySelector('.pay20').textContent = formatSAR(total * 0.20);
  document.querySelector('.pay5').textContent  = formatSAR(total * 0.05);
}

/* ===============================
   إضافة بند إضافي
===============================*/
function addExtraRow(){
  const tbody = document.querySelector('#items-table tbody');
  const tr = document.createElement('tr');

  tr.innerHTML = `
    <td contenteditable="true">بند إضافي</td>
    <td><input type="number" class="qty" value="1" min="1"></td>
    <td><input type="number" class="unit" value="0" min="0"></td>
    <td class="row-total">0.00</td>
    <td style="text-align:center">
      <button onclick="this.closest('tr').remove();recalcPricing()">✖</button>
    </td>
  `;

  tbody.appendChild(tr);
  recalcPricing();
}

/* ===============================
   مراقبة التغييرات
===============================*/
document.addEventListener('input',e=>{
  if(
    e.target.closest('#items-table') ||
    e.target.id === 'adjustmentType' ||
    e.target.id === 'adjustmentValue'
  ){
    recalcPricing();
  }
});

/* ===============================
   تعبئة البند الرئيسي تلقائيًا
===============================*/
window.addEventListener('load', () => {

  if (!window.q) return;

  const quoteNumber = q.quoteNumber || '—';
  const liftsCount  = Number(q.liftsCount || 1);

  /* ✅ سعر الوحدة قبل الضريبة / لكل مصعد */
  const unitPriceBeforeVat =
    q.totalBeforeVatPerLift
      ? Number(q.totalBeforeVatPerLift)
      : (
          (Number(q.totalWithVat || 0) / 1.15) /
          Math.max(liftsCount, 1)
        );

  const firstRow = document.querySelector('#items-table tbody tr:first-child');
  if (!firstRow) return;

  const desc = firstRow.querySelector('td[contenteditable]');
  const qty  = firstRow.querySelector('.qty');
  const unit = firstRow.querySelector('.unit');

  if (desc) {
    desc.textContent =
`توريد وتركيب وتشغيل مصعد/مصاعد كهربائية حسب المواصفات الفنية المعتمدة
والمذكورة تفصيلاً في هذا العرض.`;
  }

  if (qty)  qty.value  = liftsCount;
  if (unit) unit.value = unitPriceBeforeVat.toFixed(2); // ✅ صح

  recalcPricing();
});


</script>

<script>
document.addEventListener('DOMContentLoaded', () => {

  const index = localStorage.getItem('rkl_current_quote_index');
  if (index === null) return;

  const quotes = JSON.parse(localStorage.getItem('rkl_quotes') || '[]');
  const q = quotes[index];
  if (!q) return;

  // تعبئة جدول EN81
  document.querySelectorAll('[data-bind]').forEach(el => {
    const key = el.getAttribute('data-bind');
    if (q[key] !== undefined && q[key] !== null && q[key] !== '') {
      el.textContent = q[key];
    }
  });

});
</script>

<style>
/* ===============================
   PRINT STYLE – OFFICIAL RKL
=============================== */
@media print {

  /* لون الورقة */
  body {
    background: #f5f1e6 !important; /* بني فاتح رسمي */
    -webkit-print-color-adjust: exact !important;
    print-color-adjust: exact !important;
  }

  /* خلفية الشعار */
  body::before {
    content: "";
    position: fixed;
    top: 50%;
    left: 50%;
    width: 420px;
    height: 420px;
    background: url("/public/images/logo.png") no-repeat center center;
    background-size: contain;
    opacity: 0.06; /* شفافية راقية */
    transform: translate(-50%, -50%);
    z-index: 0;
    pointer-events: none;
  }

  /* تأكيد أن المحتوى فوق الخلفية */
  .page,
  .print-page,
  table,
  div,
  section {
    position: relative;
    z-index: 1;
    background: transparent !important;
  }

  /* منع أي فواصل صفحات غير مرغوبة */
  .en81-grid,
  .tech-table,
  .plan-view,
  .section-view,
  .print-footer {
    page-break-inside: avoid;
  }

}
</style>


</body>
</html>

















