<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
   
<style>

/* =================================================
   إعدادات عامة + Editable
=================================================*/
body[contenteditable="true"] {
  cursor: text;
}
[contenteditable="true"]:focus {
  outline: none;
}
.editable-highlight:hover {
  background: rgba(59,130,246,0.06);
}
.pdf-cover {
  padding: 0 !important;
}

.fixed-pdf-img {
  width: 100%;
  height: auto;
  display: block;
}

@media print {
  .page {
    page-break-after: always;
    min-height: auto;
  }
}

table {
  break-inside: avoid;
}

/* =================================================
   تنسيق العرض على الشاشة
=================================================*/
body {
  font-family: "Cairo", system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
  background: #f3f4f6;
  margin: 0;
  padding: 20px;
  color: #111827;
}

.page {
  max-width: 900px;
  margin: 0 auto 30px auto;
  background: #ffffff;
  box-shadow: 0 0 8px rgba(15,23,42,0.08);
  padding: 25px 35px;
  position: relative;
   justify-content: center;   /* توسيط عمودي */
  align-items: center;       /* توسيط رأسي */
}


/* =================================================
   Header موحد للصفحات الداخلية
=================================================*/
.page-header {
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  border-bottom: 2px solid #e5e7eb;
  padding-bottom: 8px;
  margin-bottom: 12px;
  font-size: 12px;
}

.header-left {
  text-align: right;
}

.header-right {
  text-align: left;
}


.logo-box {
  text-align: right;
  font-size: 12px;
}

.logo-title {
  font-weight: 700;
  font-size: 18px;
}

.logo-sub {
  font-size: 11px;
  color: #6b7280;
  line-height: 1.5;
}

.offer-meta {
  text-align: left;
  font-size: 11px;
  line-height: 1.6;
}

/* =================================================
   العناوين والجداول
=================================================*/
h1.main-title {
  text-align: center;
  font-size: 18px;
  margin: 8px 0 15px;
}

.section-title {
  font-weight: 700;
  font-size: 14px;
  margin: 18px 0 8px;
  border-right: 4px solid #2563eb;
  padding-right: 6px;
}

table {
  width: 100%;
  border-collapse: collapse;
  font-size: 12px;
}
   .partners-logos {
  display: flex;
  gap: 40px;
  justify-content: center;
  margin: 25px 0 40px;
}

.partner-box {
  text-align: center;
  max-width: 220px;
}

.partner-box img {
  max-height: 70px;
  margin-bottom: 10px;
}

.partner-name {
  font-weight: 600;
  font-size: 14px;
}

.partner-desc {
  font-size: 12px;
  color: #555;
}


th, td {
  border: 1px solid #d1d5db;
  padding: 6px 8px;
  vertical-align: top;
}

th {
  background: #f9fafb;
  font-weight: 600;
}

/* =================================================
   جداول المواصفات
=================================================*/
.spec-table th:nth-child(1),
.spec-table td:nth-child(1) {
  width: 6%;
  text-align: center;
}
.spec-table th:nth-child(2),
.spec-table td:nth-child(2) {
  width: 44%;
}
.spec-table th:nth-child(3),
.spec-table td:nth-child(3) {
  width: 18%;
  text-align: center;
}
.spec-table th:nth-child(4),
.spec-table td:nth-child(4) {
  width: 32%;
}

/* =================================================
   تقسيمات وملاحظات
=================================================*/
.two-col {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 12px;
}

.small-note {
  font-size: 11px;
  color: #6b7280;
}

.terms p {
  font-size: 11.5px;
  margin: 4px 0;
  text-align: justify;
}

.signature-row {
  margin-top: 25px;
  display: flex;
  justify-content: space-between;
  font-size: 12px;
}

/* =================================================
   الرسومات والمخططات
=================================================*/
.diagram-container {
  margin-top: 15px;
  display: flex;
  justify-content: center;
}

/* Shaft + Cabin */
.shaft {
  position: relative;
  border: 2px solid #4b5563;
  width: 260px;
  height: 340px;
  background: #f9fafb;
  display: flex;
  align-items: center;
  justify-content: center;
}

.cabin {
  border: 2px solid #10b981;
  background: #ecfdf5;
  width: 65%;
  height: 55%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 11px;
  text-align: center;
}

/* مخطط متكامل */
.full-diagram {
  position: relative;
  width: 260px;
  height: 420px;
  border: 2px solid #374151;
  background: #f9fafb;
}

.oh-area,
.pit-area {
  width: 100%;
  text-align: center;
  font-size: 11px;
  color: #374151;
  position: absolute;
}

.oh-area { top: -26px; }
.pit-area { bottom: -26px; }

.full-diagram .cabin {
  position: absolute;
  top: 28%;
  left: 17%;
  width: 65%;
  height: 45%;
}

/* مخطط هندسي كامل */
.diagram-page {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 40px;
  margin-top: 30px;
  align-items: center;
}

.shaft-vertical {
  position: relative;
  width: 160px;
  height: 420px;
  border: 2px solid #475569;
  background: #f8fafc;
}

.car-vertical {
  position: absolute;
  top: 25%;
  left: 50%;
  transform: translateX(-50%);
  width: 70%;
  height: 45%;
  border: 2px solid #10b981;
  background: #ecfdf5;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 12px;
}

/* =================================================
   زر الطباعة والترقيم
=================================================*/
.btn-print {
  display: inline-block;
  margin: 10px auto 0;
  padding: 8px 18px;
  font-size: 13px;
  background: #2563eb;
  color: #ffffff;
  border-radius: 4px;
  border: none;
  cursor: pointer;
}

.page-index {
  position: absolute;
  left: 35px;
  bottom: 8px;
  font-size: 11px;
  color: #9ca3af;
}

/* =================================================
   الطباعة – A4 احترافية
=================================================*/
@media print {

  @page {
    size: A4;
    margin: 20mm 15mm 20mm 15mm;
  }

  body {
    margin: 0;
    padding: 0;
    background: #fff;
    font-family: "Cairo","Tajawal",Arial,sans-serif;
    -webkit-print-color-adjust: exact !important;
    print-color-adjust: exact !important;
  }

  .page {
    page-break-after: always;
    break-after: page;
    min-height: auto;        /* ✅ إزالة السبب الرئيسي */
    box-shadow: none;
  }

  .btn-print {
    display: none !important;
  }

  table, tr, td, th,
  svg, .diagram-page {
    page-break-inside: avoid;
    break-inside: avoid;
  }

  /* Watermark للطباعة فقط */
  .page::before {
    content: "";
    position: absolute;
    top: 50%;
    left: 50%;
    width: 380px;
    height: 380px;
    background: url("/public/images/logo.png") no-repeat center;

    background-size: contain;
    opacity: 0.04;
    transform: translate(-50%, -50%);
    z-index: 0;
  }

  .page > * {
    position: relative;
    z-index: 1;
  }
}
</style>


</head>
<body>

   <body contenteditable="true" spellcheck="false">

 


<!-- ================= صفحة غلاف 1 ================= -->
<div class="page pdf-cover">
  <img src="/public/images/FIRST_PAGE_RKL1.png" class="fixed-pdf-img">
</div>

<!-- ================= صفحة غلاف 2 ================= -->
<div class="page pdf-cover">
  <img src="/public/images/FIRST_PAGE_RKL2.png" class="fixed-pdf-img">
</div>




<!-- ================= صفحة 1: تعريف RKL + ملف العميل ================= -->
<div class="page">
    <div class="header">
        <div class="logo-box editable" contenteditable="true">
            <div class="logo-title">RKL للمصاعد والسلالم الكهربائية</div>
            <div class="logo-sub">
                السجل التجاري: 1010709355 – الرقم الضريبي: 302250422600003<br/>
                العنوان: السليمانية – الرياض – هاتف: 0114774021 – WWW.RKL.SA
            </div>
        </div>
        <div class="offer-meta">
            <div>رقم العرض: <span class="bind_quote_number">—</span></div>
            <div>تاريخ العرض: <span class="bind_offer_date">—</span></div>
        </div>
    </div>

    <h1 class="main-title">عرض سعر توريد وتركيب وتشغيل مصعد كهربائي</h1>

    <div class="section-title">أولاً: نبذة عن مؤسسة آر كي ال RKL</div>
    <p class="small-note editable" contenteditable="true">
        مؤسسة سعودية متخصصة في توريد وتركيب وصيانة المصاعد والسلالم الكهربائية، تعمل وفق أعلى معايير الجودة
        والسلامة، وتمتلك شراكات مع مصانع عالمية، مع خبرة في تنفيذ مشاريع حكومية وخاصة في مختلف مناطق المملكة.
    </p>

<div class="section-title">ثانياً: ملف العميل</div>
<table>
  <tbody>
    <tr>
      <th>اسم العميل</th>
      <td class="bind_customer_name">—</td>
      <th>اسم المشروع</th>
      <td class="bind_project_name">—</td>
    </tr>

   <tr>
  <th>اسم المخوّل بالتوقيع</th>
  <td class="bind_contact_person">—</td>
  <th>موقع المشروع</th>
  <td class="bind_project_location">—</td>
</tr>

    <tr>
      <th>السجل التجاري</th>
      <td class="bind_cr_number">—</td>
      <th>الرقم الضريبي</th>
      <td class="bind_tax_number">—</td>
    </tr>

    <tr>
      <th>نوع المصعد</th>
      <td>Passenger</td>
      <th>عدد المصاعد</th>
      <td class="bind_lifts">—</td>
    </tr>

    <tr>
      <th>الماركة / النظام</th>
      <td class="bind_brand">—</td>
      <th>نظام التركيب</th>
      <td>MRL (Machine Room-Less)</td>
    </tr>

    <tr>
      <th>الحمولة</th>
      <td class="bind_capacity">—</td>
      <th>عدد التوقفات</th>
      <td class="bind_floors">—</td>
    </tr>

    <tr>
      <th>الاستخدام</th>
      <td class="bind_usage">—</td>
      <th>بلد المنشأ</th>
      <td class="bind_origin">—</td>
    </tr>

    <tr>
      <th>مدة التوريد</th>
      <td>8 – 12 أسبوع</td>
      <th>مدة التركيب</th>
      <td>30 – 45 يوم</td>
    </tr>

    <tr>
      <th>المطابقة الدولية</th>
      <td>EN-81</td>
      <th>المطابقة المحلية</th>
      <td>SABER</td>
    </tr>
  </tbody>
</table>






    <div class="page-index">Page 1</div>
</div>

    <!-- ================= Page 2: RKL Coverage ================= -->
<div class="page">

<div class="page-header">
  <div class="header-right">
    <div>رقم العرض: <span class="bind_quote_number">—</span></div>
    <div>تاريخ العرض: <span class="bind_offer_date">—</span></div>
  </div>

  <div class="header-left">
    <strong>RKL للمصاعد والسلالم الكهربائية</strong><br>
    السجل التجاري: 1010709355<br>
    الرقم الضريبي: 302250422600003<br>
    www.rkl.sa – 0114774021
  </div>
</div>



  <div style="display:flex;gap:30px;margin-top:20px;align-items:flex-start">

    <!-- صورة الخريطة -->
    <div style="width:50%">
      <img
        src="/public/images/ksa-map.png"
        alt="RKL Coverage Map"
        style="width:100%;border-radius:10px;border:1px solid #e5e7eb"
      />
      <div style="font-size:11px;color:#6b7280;margin-top:6px;text-align:center">
        التوزيع الجغرافي لأعمال RKL داخل المملكة العربية السعودية
      </div>
    </div>

    <!-- جدول المناطق -->
    <div style="width:50%">
      <h4 style="margin:0 0 10px 0">
        ثالثا ملخص الأعمال حسب المناطق
      </h4>

      <table>
        <thead>
          <tr>
            <th>المنطقة</th>
            <th>Region</th>
            <th>عدد المصاعد</th>
            <th>Elevators</th>
          </tr>
        </thead>
         <tbody>
  <tr>
    <td>421</td>
    <td>421</td>
    <td>Riyadh</td>
    <td>الرياض</td>
  </tr>
  <tr>
    <td>98</td>
    <td>98</td>
    <td>Makkah</td>
    <td>مكة المكرمة</td>
  </tr>
  <tr>
    <td>72</td>
    <td>72</td>
    <td>Eastern Region</td>
    <td>المنطقة الشرقية</td>
  </tr>
  <tr>
    <td>34</td>
    <td>34</td>
    <td>Madinah</td>
    <td>المدينة المنورة</td>
  </tr>
  <tr>
    <td>26</td>
    <td>26</td>
    <td>Qassim</td>
    <td>القصيم</td>
  </tr>
  <tr>
    <td>19</td>
    <td>19</td>
    <td>Tabuk</td>
    <td>تبوك</td>
  </tr>
  <tr>
    <td>17</td>
    <td>17</td>
    <td>Hail</td>
    <td>حائل</td>
  </tr>
  <tr>
    <td>23</td>
    <td>23</td>
    <td>Najran</td>
    <td>نجران</td>
  </tr>
  <tr>
    <td>41</td>
    <td>41</td>
    <td>Asir & Jazan</td>
    <td>عسير وجازان</td>
  </tr>
</tbody>


      </table>
    </div>

  </div>
   <!-- =========================
     الاعتمادات والشراكات
========================= -->
<div class="section-title">الاعتمادات والشراكات الدولية</div>

<p class="section-text">
مؤسسة <strong>RKL للمصاعد والسلالم الكهربائية</strong> معتمدة في توريد وتنفيذ أنظمة المصاعد
من موردين عالميين، وتعمل وفق أعلى معايير الجودة الأوروبية واليابانية،
وبشراكات تقنية مباشرة مع الشركات المصنعة.
</p>

<div class="partners-logos">
  <div class="partner-box">
    <img src="public/images/fuji-logo.png" alt="FUJI Japan">
    <div class="partner-name">FUJI – Japan</div>
    <div class="partner-desc">مصاعد كهربائية – أنظمة MRL & Passenger</div>
  </div>

  <div class="partner-box">
    <img src="public/images/vertilift-logo.png" alt="VertiLift Italy">
    <div class="partner-name">VertiLift – Italy</div>
    <div class="partner-desc">مصاعد أوروبية – حلول حديثة</div>
  </div>
</div>

<!-- نبذة عن المؤسسة والمشاريع -->
<div style="margin-top:20px; border-top:1px solid #e5e7eb; padding-top:15px;">

  <strong>مشاريعنا داخل المملكة العربية السعودية</strong>
  <p style="font-size:12px; line-height:1.6; color:#374151; margin-top:6px;">
    مؤسسة RKL للمصاعد والسلالم الكهربائية هي مؤسسة سعودية متخصصة في توريد،
    تركيب، تحديث، وصيانة المصاعد الكهربائية بمختلف أنواعها. تمتلك المؤسسة خبرة عملية
    واسعة في تنفيذ المشاريع السكنية، التجارية، الطبية، والتعليمية، وقد نفذت أعمالها
    في عدة مناطق داخل المملكة العربية السعودية.
  </p>

  <p style="font-size:12px; line-height:1.6; color:#374151;">
    تضم سابقة أعمال المؤسسة عددًا كبيرًا من المصاعد التي تم تنفيذها وتشغيلها بنجاح،
    مع الالتزام الكامل بمعايير الجودة والسلامة المعتمدة، وتقديم حلول فنية موثوقة
    تتناسب مع متطلبات كل مشروع.
  </p>

  <hr style="border:none;border-top:1px dashed #d1d5db;margin:10px 0">

  <strong>About RKL Projects in Saudi Arabia</strong>
  <p style="font-size:12px; line-height:1.6; color:#374151; margin-top:6px;">
    RKL Elevators & Escalators is a Saudi-based company specialized in the supply,
    installation, modernization, and maintenance of elevators. The company has
    extensive experience in delivering residential, commercial, medical, and
    educational projects across multiple regions within the Kingdom of Saudi Arabia.
  </p>

  <p style="font-size:12px; line-height:1.6; color:#374151;">
    RKL’s portfolio includes a large number of successfully delivered elevators,
    fully compliant with international quality and safety standards, providing
    reliable long-term performance and user comfort.
  </p>

</div>

  <div class="page-index">Page 2</div>
</div>


<!-- ================= صفحة 3: المواصفات الفنية العامة ================= -->
<div class="page">

<div class="page-header">
  <div class="header-right">
    <div>رقم العرض: <span class="bind_quote_number">—</span></div>
    <div>تاريخ العرض: <span class="bind_offer_date">—</span></div>
  </div>

  <div class="header-left">
    <strong>RKL للمصاعد والسلالم الكهربائية</strong><br>
    السجل التجاري: 1010709355<br>
    الرقم الضريبي: 302250422600003<br>
    www.rkl.sa – 0114774021
  </div>
</div>


  <div class="section-title">رابعا البيانات الفنية الرئيسية</div>
    <table class="spec-table">
        <thead>
        <tr>
            <th>م</th>
            <th>البند</th>
            <th>القيمة</th>
            <th>ملاحظات</th>
        </tr>
        </thead>
        <tbody>
        <tr>
            <td>1</td>
            <td>ماركة المصعد / النظام</td>
            <td class="bind_brand">—</td>
            <td class="editable" contenteditable="true">حسب العرض المعتمد</td>
        </tr>
        <tr>
            <td>2</td>
            <td>نوع الماكينة</td>
            <td class="editable" contenteditable="true">Traction – MRL</td>
            <td>حسب اتفاق المورد</td>
        </tr>
        <tr>
            <td>3</td>
            <td>الحمولة الاسمية (kg)</td>
            <td class="bind_capacity">—</td>
            <td>حسب عدد الأشخاص المطلوب</td>
        </tr>
        <tr>
            <td>4</td>
            <td>السرعة (m/s)</td>
            <td class="bind_speed">—</td>
            <td>ركاب</td>
        </tr>
        <tr>
            <td>5</td>
            <td>عدد التوقفات (Stops)</td>
            <td class="bind_floors">—</td>
            <td>حسب مخططات المشروع</td>
        </tr>
        <tr>
            <td>6</td>
            <td>عدد المصاعد بهذه المواصفات</td>
            <td class="bind_lifts">—</td>
            <td></td>
        </tr>
   <tr>
  <td>7</td>
  <td>نظام التشغيل والتحكم</td>
  <td>VVVF – Inverter Control</td>
  <td>تشغيل ناعم وتوفير عالي للطاقة</td>
</tr>
           <tr>
  <td>8</td>
  <td>طريقة فتح الأبواب</td>
  <td>Automatic – Center / Side Opening</td>
  <td>حسب التصميم المعتمد</td>
</tr>
     
       
      
        <tr>
            <td>9</td>
            <td>تشطيب الكابينة الداخلية</td>
            <td class="bind_cabin_design">Standard</td>
            <td class="editable" contenteditable="true">يمكن تعديلها إلى تصميم خاص</td>
        </tr>
        <tr>
            <td>10</td>
            <td>تشطيب أرضية الكابينة</td>
            <td class="bind_floor_finish">Standard</td>
            <td class="editable" contenteditable="true">جرانيت / رخام حسب الاتفاق</td>
        </tr>
        </tbody>
    </table>

    <div class="page-index">Page 3</div>
</div>
<!-- ================= صفحة 4: مخطط استرشادي هندسي ================= -->
<div class="page">

<div class="page-header">
  <div class="header-right">
    <div>رقم العرض: <span class="bind_quote_number">—</span></div>
    <div>تاريخ العرض: <span class="bind_offer_date">—</span></div>
  </div>

  <div class="header-left">
    <strong>RKL للمصاعد والسلالم الكهربائية</strong><br>
    السجل التجاري: 1010709355<br>
    الرقم الضريبي: 302250422600003<br>
    www.rkl.sa – 0114774021
  </div>
</div>


<div class="section-title">
  خامسًا: مخطط استرشادي هندسي لمقاسات البئر والكابينة (EN81)
</div>

<div style="display:grid; grid-template-columns: 340px 1fr; gap:24px; margin-top:20px">

<table class="tech-table">
  <thead>
    <tr>
      <th>م</th>
      <th>البند</th>
      <th>القيمة (mm)</th>
       <th>الملاحظات</th>
    </tr>
  </thead>
  <tbody>
      <tr>
            <td>1</td>
            <td>مقاس بئر المصعد (mm)</td>
            <td class="bind_dim_shaft">—</td>
            <td>طبقاً لجدول EN81 أو حالة الموقع</td>
        </tr>

       <tr>
            <td>2</td>
            <td>مقاس الكابينة (mm)</td>
            <td class="bind_dim_cabin">—</td>
            <td>طبقاً لجدول EN81 أو التصميم المعتمد</td>
        </tr>

   
       
      </td>
    </tr>

    <tr>
            <td>3</td>
            <td>عمق الحفرة Pit</td>
            <td class="bind_pit">—</td>
            <td></td>
        </tr>
   <tr>
            <td>4</td>
            <td>الابواب </td>
            <td>طبقاً لجدول EN81 أو التصميم المعتمد</td>
            <td></td>
        </tr>

     <tr>
            <td>5</td>
            <td>ارتفاع أعلى البئر OH</td>
            <td class="bind_oh">—</td>
            <td></td>
        </tr>
  </tbody>
</table>


   

  <!-- ✅ المخطط الهندسي -->
  <svg width="520" height="420" viewBox="0 0 520 420"
       xmlns="http://www.w3.org/2000/svg"
       style="border:1px solid #d1d5db; background:#fff">

    <!-- ===== SECTION VIEW ===== -->
    <text x="130" y="20" font-size="13" font-weight="700" text-anchor="middle">
      SECTION VIEW
    </text>

    <!-- Shaft -->
    <rect x="50" y="40" width="160" height="280"
          fill="none" stroke="#1f2937" stroke-width="2"/>

    <!-- Cabin -->
    <rect x="75" y="130" width="110" height="120"
          fill="#ecfdf5" stroke="#059669" stroke-width="2"/>

    <text x="130" y="195" font-size="11" text-anchor="middle">
      CABIN
    </text>

    <!-- OH -->
    <line x1="50" y1="30" x2="210" y2="30" stroke="#1f2937"/>
    <text x="130" y="18" font-size="11" text-anchor="middle">
      OH = <tspan class="bind_oh">—</tspan> mm
    </text>

    <!-- PIT -->
    <line x1="50" y1="330" x2="210" y2="330" stroke="#1f2937"/>
    <text x="130" y="360" font-size="11" text-anchor="middle">
      PIT = <tspan class="bind_pit">—</tspan> mm
    </text>

    <!-- ===== PLAN VIEW ===== -->
    <text x="385" y="20" font-size="13" font-weight="700" text-anchor="middle">
      PLAN VIEW
    </text>

    <!-- Shaft plan -->
    <rect x="300" y="60" width="180" height="160"
          fill="none" stroke="#1f2937" stroke-width="2"/>

    <!-- Cabin plan -->
    <rect x="330" y="90" width="120" height="100"
          fill="#ecfdf5" stroke="#059669" stroke-width="2"/>

    <text x="390" y="145" font-size="11" text-anchor="middle">
      CABIN
    </text>

    <text x="390" y="245" font-size="11" text-anchor="middle">
      HW = <tspan class="bind_shaft_width">—</tspan> mm
      &nbsp;|&nbsp;
      HD = <tspan class="bind_shaft_depth">—</tspan> mm
    </text>

    <text x="390" y="270" font-size="11" text-anchor="middle" fill="#065f46">
      <tspan class="bind_dim_cabin">—</tspan>
    </text>
  </svg>

</div>




</div>




   

  <div class="page-index">Page 4</div>
</div>

<!-- ================= صفحة 5: ميزات الأمان + مخطط المقاسات ================= -->
<div class="page">

<div class="page-header">
  <div class="header-right">
    <div>رقم العرض: <span class="bind_quote_number">—</span></div>
    <div>تاريخ العرض: <span class="bind_offer_date">—</span></div>
  </div>

  <div class="header-left">
    <strong>RKL للمصاعد والسلالم الكهربائية</strong><br>
    السجل التجاري: 1010709355<br>
    الرقم الضريبي: 302250422600003<br>
    www.rkl.sa – 0114774021
  </div>
</div>


  <div class="section-title">سادسا ميزات الأمان القياسية</div>
    <table class="spec-table">
        <thead>
        <tr>
            <th>#</th>
            <th>الميزة</th>
            <th>الكود</th>
            <th>الوصف بالعربية</th>
        </tr>
        </thead>
        <tbody class="editable" contenteditable="true">
        <tr><td>1</td><td>Automatic Rescue Device</td><td>ARD</td><td>جهاز إنقاذ تلقائي عند انقطاع التيار</td></tr>
        <tr><td>2</td><td>Fireman Key</td><td>FIRE</td><td>مفتاح حريق لإرجاع المصعد للدور الأرضي</td></tr>
        <tr><td>3</td><td>Two-way Intercom</td><td>INT</td><td>نظام اتصال داخلي بين الكابينة وغرفة الماكينة</td></tr>
        <tr><td>4</td><td>Emergency Light & Alarm</td><td>EMG</td><td>إنارة وجرس إنذار للطوارئ</td></tr>
        <tr><td>5</td><td>Light Curtain</td><td>DOOR SAFE</td><td>حساسات أمان على باب المصعد</td></tr>
        <tr><td>6</td><td>Overload Protection</td><td>OL</td><td>نظام حماية من زيادة الحمولة</td></tr>
        <tr><td>7</td><td>Speed Governor</td><td>GOV</td><td>منظم سرعة لسلامة الحركة</td></tr>
        <tr><td>8</td><td>Power Saver</td><td>PSAVE</td><td>نظام توفير الطاقة عند الخمول</td></tr>
        </tbody>
    </table>

<div class="page-index">Page 5</div>
</div>


<!-- ================= صفحة 6: القيمة المالية + الدفعات + البنود ================= -->
<div class="page">

 <div class="page-header">
  <div class="header-right">
    <div>رقم العرض: <span class="bind_quote_number">—</span></div>
    <div>تاريخ العرض: <span class="bind_offer_date">—</span></div>
  </div>

  <div class="header-left">
    <strong>RKL للمصاعد والسلالم الكهربائية</strong><br>
    السجل التجاري: 1010709355<br>
    الرقم الضريبي: 302250422600003<br>
    www.rkl.sa – 0114774021
  </div>
</div>

  <div class="section-title">سابعا ملخص القيمة المالية</div>
<div class="before-vat-adjustment">

  <div class="section-title">
    ٦-١) تعديل السعر قبل الضريبة (اختياري)
  </div>

  <table>
    <tbody>
      <tr>
        <th style="width:35%">نوع التعديل</th>
        <td style="width:65%">
          <select id="adjust_type">
            <option value="">— بدون تعديل —</option>
            <option value="percent_add">زيادة بنسبة (%)</option>
            <option value="percent_minus">خصم بنسبة (%)</option>
            <option value="fixed_add">زيادة بمبلغ ثابت</option>
            <option value="fixed_minus">خصم بمبلغ ثابت</option>
          </select>
        </td>
      </tr>

      <tr>
        <th>قيمة التعديل</th>
        <td>
          <input
            type="number"
            id="adjust_value"
            placeholder="أدخل النسبة أو المبلغ"
            style="width:100%"
          />
          <div class="small-note">
            * يتم احتساب التعديل على المبلغ قبل الضريبة فقط
          </div>
        </td>
      </tr>
    </tbody>
  </table>

</div>



    <div class="section-title">٧) جدول الدفعات المقترح</div>
<table>
  <thead>
    <tr>
      <th style="width:45%">البيان</th>
      <th style="width:15%">النسبة</th>
      <th style="width:40%">المبلغ بالريال السعودي</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>عند توقيع العقد</td>
      <td>50%</td>
      <td class="bind_pay_50">—</td>
    </tr>
    <tr>
      <td>عند الانتهاء من الأعمال الميكانيكية</td>
      <td>25%</td>
      <td class="bind_pay_25">—</td>
    </tr>
    <tr>
      <td>بعد الانتهاء من الأعمال الكهربائية والتشغيل</td>
      <td>20%</td>
      <td class="bind_pay_20">—</td>
    </tr>
    <tr>
      <td>عند التسليم النهائي للمصعد</td>
      <td>5%</td>
      <td class="bind_pay_5">—</td>
    </tr>

    <!-- ✅ ملخص مالي تفصيلي -->
    <tr>
      <th>الإجمالي قبل التعديل (قبل الضريبة)</th>
      <th>—</th>
      <th class="bind_subtotal_before_vat">—</th>
    </tr>

    <tr>
      <th>قيمة الخصم / الزيادة</th>
      <th>—</th>
      <th class="bind_adjustment_amount">—</th>
    </tr>

    <tr>
      <th>الإجمالي بعد التعديل (قبل الضريبة)</th>
      <th>—</th>
      <th class="bind_subtotal_after_adjustment">—</th>
    </tr>

    <tr>
      <th>ضريبة القيمة المضافة (15%)</th>
      <th>—</th>
      <th class="bind_vat_amount">—</th>
    </tr>

    <tr>
      <th style="background:#f0f9ff;font-weight:bold">
        الإجمالي النهائي (شامل ضريبة القيمة المضافة)
      </th>
      <th>100%</th>
      <th class="bind_total_with_vat" style="font-weight:bold">—</th>
    </tr>
  </tbody>
</table>


    <div class="section-title">٨) بنود رئيسية للعقد (قابلة للتعديل)</div>
    <div class="terms editable" contenteditable="true">
        <p>١- يعتبر هذا العرض جزءًا لا يتجزأ من عقد توريد وتركيب وتشغيل المصعد في حال اعتماده والتوقيع عليه من قبل الطرفين.</p>
        <p>٢- الأسعار الواردة أعلاه بالريال السعودي وتشمل ضريبة القيمة المضافة بنسبة ١٥٪ ما لم يُذكر خلاف ذلك.</p>
        <p>٣- يلتزم الطرف الأول بتوفير التغذية الكهربائية ٣ فاز ٣٨٠ فولت وأعمال البئر والأبواب المدنية حسب المخططات المعتمدة.</p>
        <p>٤- يلتزم الطرف الثاني بتنفيذ الأعمال وفق المواصفات الفنية المعتمدة والشروط الواردة في هذا العرض.</p>
        <p>٥- في حال تأخر الدفعات عن مواعيدها يحق للطرف الثاني إيقاف الأعمال مؤقتًا إلى حين استلام المستحقات دون مسؤولية عن التأخير.</p>
        <p>٦- في حال حدوث أي نزاع - لا قدر الله - تكون ولاية القضاء للمحاكم المختصة في المملكة العربية السعودية.</p>
        <p>٧- يعتبر العرض لاغيًا إذا لم يتم توقيعه وسداد الدفعة الأولى خلال مدة سريان العرض المتفق عليها.</p>
    </div>

<!-- زر طباعة عام -->
<div style="text-align:center; margin-top:10px;">
  <button class="btn-print" onclick="printWithName()">طباعة / حفظ PDF</button>
    <div id="warn_no_data" class="warning" style="display:none;">
      لم يتم العثور على عرض سعر محفوظ في السجل. الرجاء العودة إلى نموذج التسعير وحفظ عرض السعر أولاً.
    </div>
</div>

   
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

<script src="/public/rkl-map.js"></script>
<script src="/public/rkl-summary.js"></script>



<script>
/* =================================================
   Helper: bind text safely
================================================= */
const bind = (selector, value) => {
  const el = document.querySelector(selector);
  if (el) el.textContent = (value !== undefined && value !== null && value !== '') ? value : '—';
};

/* =================================================
   تحميل عرض السعر من LocalStorage
================================================= */
const quotes = JSON.parse(localStorage.getItem('rkl_quotes') || '[]');
const currentIndex = localStorage.getItem('rkl_current_quote_index');
const q = quotes[currentIndex ?? quotes.length - 1];

if (!q) {
  alert('لا يوجد عرض سعر لعرضه');
}

/* =================================================
   (1) بيانات العرض العامة
================================================= */
bind('.bind_quote_number', q.quoteNumber);
bind('.bind_offer_date', q.timestamp?.slice(0, 10));
bind('.bind_customer_name', q.customerName);
   bind('.bind_project_location', q.projectLocation || '—');
bind('.bind_project_name',q.projectName + (q.projectLocation ? ' – ' + q.projectLocation : ''));

/* =================================================
   (2) ملف العميل – بيانات محسوبة من عرض السعر
================================================= */
bind('.bind_customer_name', q.customerName);
bind('.bind_project_name',q.projectName + (q.projectLocation ? ' – ' + q.projectLocation : ''));
bind('.bind_contact_person', q.customerDetails?.contact_person || '—');
bind('.bind_cr_number', q.customerDetails?.cr_number || '—');
bind('.bind_tax_number', q.customerDetails?.tax_number || '—');

/* ===== بيانات المصعد ===== */
bind('.bind_brand', q.brandLabel);
bind('.bind_capacity', q.capacity);
bind('.bind_speed', q.speed);
bind('.bind_floors', q.floors);
bind('.bind_lifts', q.liftsCount);

/* ===== عناصر ذكية جديدة ===== */
bind('.bind_usage', inferUsage(q.projectName));
bind('.bind_origin', inferOrigin(q.brandLabel));


/* =================================================
   (3) البيانات الفنية الرئيسية
================================================= */
bind('.bind_brand', q.brandLabel);
bind('.bind_capacity', q.capacity);
bind('.bind_speed', q.speed);
bind('.bind_floors', q.floors);
bind('.bind_lifts', q.liftsCount);
bind('.bind_machine_type', q.machineType);
bind('.bind_cabin_design', q.cabinDesign);
bind('.bind_floor_finish', q.floorFinish);
bind('.bind_dim_shaft', q.shaftSize);
bind('.bind_dim_cabin', q.cabinSize);
bind('.bind_pit', q.pit);
bind('.bind_oh', q.oh);


function inferUsage(projectName = '') {
  if (!projectName) return '—';
  const name = projectName.toLowerCase();

  if (name.includes('مستشفى') || name.includes('medical')) return 'طبي';
  if (name.includes('مدرسة') || name.includes('school')) return 'تعليمي';
  if (name.includes('مول') || name.includes('commercial')) return 'تجاري';
  if (name.includes('سكن') || name.includes('residential')) return 'سكني';

  return 'عام';
}

function inferOrigin(brandLabel = '') {
  if (brandLabel.includes('JAPAN')) return 'اليابان';
  if (brandLabel.includes('ITALY')) return 'إيطاليا';
  if (brandLabel.includes('EU')) return 'الاتحاد الأوروبي';
  return 'حسب عرض المصنع';
}



/* =================================================
   Helper: format currency (SAR)
================================================= */
function formatCurrency(value) {
  const v = Number(value) || 0;
  return v.toLocaleString('en-US', {
    minimumFractionDigits: 2,
    maximumFractionDigits: 2
  }) + ' SAR';
}

/* =================================================
   (5 + 6 + 6-1 + 7) الحساب المالي الكامل
================================================= */

// ✅ الإجمالي الشامل القادم من سجل عروض الأسعار
const grandTotal = Number(q.totalWithVat || 0);

// ✅ عدد المصاعد
const units = Number(q.liftsCount || 1);

// ✅ نسبة الضريبة
const vatRate = Number(q.vatRate || 15);

   /* =================================================
   مخطط المقاسات – فك القيم بالأرقام
================================================= */

// Cabin: "1100 x 1000"
if (q.cabinSize) {
  const [cw, cd] = q.cabinSize.split('x').map(v => v.trim());
  bind('.bind_cabin_width', cw);
  bind('.bind_cabin_depth', cd);
}

// Shaft: "1700 x 1500"
if (q.shaftSize) {
  const [sw, sd] = q.shaftSize.split('x').map(v => v.trim());
 // لازم تكون القيمة: "1700 x 1500"
q.shaftSize = "1700 x 1500";
q.cabinSize = "1100 x 1000";

}

// Door: "700 x 2100" أو "700"
if (q.doorSize) {
  const [dw, dh] = q.doorSize.split('x').map(v => v.trim());
  bind('.bind_door_width', dw);
  bind('.bind_door_height', dh || '—');
}


// ✅ السعر قبل الضريبة (عكسي)
const baseSubtotal = grandTotal / (1 + vatRate / 100);

function recalcFinancialSummary() {
  const type  = document.getElementById('adjust_type')?.value || '';
  const value = Number(document.getElementById('adjust_value')?.value || 0);

  let adjustedSubtotal = baseSubtotal;

  if (type === 'percent_add') {
    adjustedSubtotal += baseSubtotal * (value / 100);
  } else if (type === 'percent_minus') {
    adjustedSubtotal -= baseSubtotal * (value / 100);
  } else if (type === 'fixed_add') {
    adjustedSubtotal += value;
  } else if (type === 'fixed_minus') {
    adjustedSubtotal -= value;
  }

  const vatAmount  = adjustedSubtotal * (vatRate / 100);
  const finalTotal = adjustedSubtotal + vatAmount;

  // ✅ الملخص
  bind('.bind_subtotal_before_vat', formatCurrency(baseSubtotal));
  bind('.bind_adjustment_amount', formatCurrency(adjustedSubtotal - baseSubtotal));
  bind('.bind_subtotal_after_adjustment', formatCurrency(adjustedSubtotal));
  bind('.bind_vat_amount', formatCurrency(vatAmount));
  bind('.bind_total_with_vat', formatCurrency(finalTotal));

  // ✅ جدول الدفعات
  bind('.bind_pay_50', formatCurrency(finalTotal * 0.50));
  bind('.bind_pay_25', formatCurrency(finalTotal * 0.25));
  bind('.bind_pay_20', formatCurrency(finalTotal * 0.20));
  bind('.bind_pay_5',  formatCurrency(finalTotal * 0.05));
}


/* ✅ تشغيل أولي */
recalcFinancialSummary();

/* ✅ إعادة الحساب عند أي تعديل */
document.getElementById('adjust_type')?.addEventListener('change', recalcFinancialSummary);
document.getElementById('adjust_value')?.addEventListener('input', recalcFinancialSummary);
</script>


<script>
function renderPricingTable(q) {
  const tbody = document.querySelector("#pricing-table tbody");
  if (!tbody || !q.items) return;

  tbody.innerHTML = "";

  q.items.forEach(item => {
    const tr = document.createElement("tr");
    tr.innerHTML = `
      <td>${item.description}</td>
      <td style="text-align:center">${item.quantity}</td>
      <td>${item.unitPrice.toLocaleString()} SAR</td>
      <td>${item.total.toLocaleString()} SAR</td>
    `;
    tbody.appendChild(tr);
  });

  document.querySelector(".bind_subtotal").textContent =
    q.subtotal.toLocaleString() + " SAR";

  document.querySelector(".bind_vat").textContent =
    q.vatAmount.toLocaleString() + " SAR";

  document.querySelector(".bind_total").textContent =
    q.totalWithVat.toLocaleString() + " SAR";
}
</script>
<script>
function renderPayments(q) {
  const tbody = document.querySelector("#payments-table tbody");
  if (!tbody || !q.payments) return;

  tbody.innerHTML = "";

  q.payments.forEach(p => {
    const tr = document.createElement("tr");
    tr.innerHTML = `
      <td>${p.label}</td>
      <td style="text-align:center">${p.percent}%</td>
      <td>${p.amount.toLocaleString()} SAR</td>
    `;
    tbody.appendChild(tr);
  });
}
</script>

<script>
function syncEditableFieldsToStorage() {
  const index = localStorage.getItem('rkl_current_quote_index');
  if (index === null) return;

  const quotes = JSON.parse(localStorage.getItem('rkl_quotes') || '[]');
  const q = quotes[index];
  if (!q) return;

  // ✅ البيانات المعدلة يدويًا
  q.brandLabel   = document.querySelector('.bind_brand')?.textContent?.trim() || q.brandLabel;
  q.capacity     = document.querySelector('.bind_capacity')?.textContent?.trim() || q.capacity;
  q.speed        = document.querySelector('.bind_speed')?.textContent?.trim() || q.speed;
  q.floors       = document.querySelector('.bind_floors')?.textContent?.trim() || q.floors;
  q.cabinSize    = document.querySelector('.bind_dim_cabin')?.textContent?.trim() || q.cabinSize;
  q.shaftSize    = document.querySelector('.bind_dim_shaft')?.textContent?.trim() || q.shaftSize;
  q.pit          = document.querySelector('.bind_pit')?.textContent?.trim() || q.pit;
  q.oh           = document.querySelector('.bind_oh')?.textContent?.trim() || q.oh;

  quotes[index] = q;
  localStorage.setItem('rkl_quotes', JSON.stringify(quotes));
}
</script>


<script>
function printWithName() {
  syncEditableFieldsToStorage();

  const quoteNo = document.querySelector('.bind_quote_number')?.textContent?.trim() || 'quotation';
  const cleanNo = quoteNo.replace(/[^\w\d-]/g, '');

  document.title = `RKL_Quotation_${cleanNo}`;
  window.print();

  setTimeout(() => {
    document.title = 'RKL Elevator Offer';
  }, 1000);
}

</script>




</body>
</html>




































































