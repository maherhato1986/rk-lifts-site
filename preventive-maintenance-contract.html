<!DOCTYPE html>
<html lang="ar" dir="rtl">


<head>
  <link rel="icon" type="image/png" href="/public/images/logo.png">

<meta charset="UTF-8">
<title>Ø¹Ù‚Ø¯ ØµÙŠØ§Ù†Ø© ÙˆÙ‚Ø§Ø¦ÙŠØ© Ù„Ù„Ù…ØµØ§Ø¹Ø¯</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
 /* ===============================
   ØªØ­Ø³ÙŠÙ† Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ø¹Ø§Ù…Ø©
=============================== */
body{
  background:#f3f4f6;
}

.container{
  max-width:1100px;
  margin:30px auto;
  background:#ffffff;
  padding:35px 40px;
  border-radius:14px;
  box-shadow:0 10px 30px rgba(0,0,0,0.08);
}

/* ===============================
   Ø§Ù„Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ
=============================== */
.page-header{
  text-align:center;
  margin-bottom:35px;
}

.page-header h2{
  font-size:26px;
  font-weight:800;
  color:#0f766e;
}

.page-header p{
  font-size:13px;
  color:#6b7280;
}
  .print-logo{ width:38px }
.print-header{
  margin-bottom: 16px;
}


/* ===============================
   Ø§Ù„Ø£Ù‚Ø³Ø§Ù… (Cards)
=============================== */
.section{
  background:#f9fafb;
  border:1px solid #e5e7eb;
  border-radius:12px;
  padding:25px;
  margin-bottom:25px;
}

.section h3{
  margin:0 0 18px;
  font-size:18px;
  font-weight:700;
  color:#0f766e;
  border-bottom:1px solid #e5e7eb;
  padding-bottom:8px;
}

/* ===============================
   Grid Ø§Ø­ØªØ±Ø§ÙÙŠ
=============================== */
.grid{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(220px,1fr));
  gap:18px 22px;
}

/* ===============================
   Ø§Ù„Ø­Ù‚ÙˆÙ„
=============================== */
label{
  display:block;
  font-size:13px;
  font-weight:600;
  color:#374151;
  margin-bottom:6px;
}

input,
select,
textarea{
  width:100%;
  padding:10px 12px;
  border-radius:8px;
  border:1px solid #d1d5db;
  font-family:"Cairo",sans-serif;
  font-size:14px;
}

input:focus,
select:focus,
textarea:focus{
  outline:none;
  border-color:#0f766e;
  box-shadow:0 0 0 2px rgba(15,118,110,0.15);
}

textarea{
  min-height:90px;
  resize:vertical;
}

/* ===============================
   Ø£Ø²Ø±Ø§Ø±
=============================== */
button{
  background:#0f766e;
  color:#fff;
  border:none;
  padding:10px 18px;
  border-radius:10px;
  font-size:14px;
  font-weight:600;
  cursor:pointer;
  transition:0.25s;
}

button:hover{
  background:#115e59;
}

/* ===============================
   Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„
=============================== */
#customerInfo{
  background:#ecfeff;
  border:1px dashed #0f766e;
  padding:15px 18px;
  border-radius:10px;
  font-size:14px;
}

#customerInfo .user-data{
  color:#0f766e;
  font-weight:700;
}

/* ===============================
   Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø³Ø¬Ù„
=============================== */
table{
  border-radius:10px;
  overflow:hidden;
  font-size:13px;
}

thead{
  background:#0f766e;
  color:#fff;
}

thead th{
  font-weight:600;
}

tbody tr:nth-child(even){
  background:#f9fafb;
}

/* ===============================
   ØªØ­Ø³ÙŠÙ† Ø§Ù„Ø·Ø¨Ø§Ø¹Ø©
=============================== */
@media print{
  body{
    background:#fff;
  }

  /* ===============================
     Ø´Ø¹Ø§Ø± Ø´ÙØ§Ù Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø·Ø¨Ø§Ø¹Ø©
  =============================== */
  body::before{
    content:"";
    position:fixed;
    top:50%;
    left:50%;
    width:420px;
    height:420px;
    background:url('/public/images/logo.png') no-repeat center center;
    background-size:contain;
    opacity:0.05;   /* Ø¯Ø±Ø¬Ø© Ø§Ù„Ø´ÙØ§ÙÙŠØ© */
    transform:translate(-50%, -50%);
    z-index:-1;
  }

  .container{
    box-shadow:none;
    border-radius:0;
    padding:0;
  }

  .section{
    border:none;
    background:#fff;
    padding:0;
  }
}
.cover-title{
  font-size:28px;
  letter-spacing:0.5px;
}
.cover-line{
  width:120px;
  height:2px;
  background:#0f766e;
  margin:14px auto 25px;
}
.contract p{
  margin: 4px 0;
}
.contract p strong{
  color:#0f766e;
}
.contract-value{
  background:#f8fafc;
  border:1px solid #e5e7eb;
  border-radius:10px;
  padding:18px;
  margin:25px 0;
}
.contract-value b{
  color:#0f766e;
}

  .contract-summary{
  background:#f8fafc;
  border:1px solid #e5e7eb;
  border-radius:12px;
  padding:18px 20px;
  margin:22px 0;
}

.contract-summary h4{
  margin:0 0 14px;
  text-align:center;
  font-size:16px;
  font-weight:700;
  color:#0f766e;
  border-bottom:1px solid #e5e7eb;
  padding-bottom:8px;
}

.contract-summary table{
  width:100%;
  border-collapse:collapse;
  font-size:14px;
}

.contract-summary td{
  padding:8px 6px;
}

.contract-summary tr:not(:last-child){
  border-bottom:1px dashed #e5e7eb;
}

.contract-summary .label{
  color:#374151;
}

.contract-summary .value{
  text-align:left;
  font-weight:600;
}

.contract-summary .total{
  font-size:15px;
  font-weight:800;
  color:#0f766e;
}

.contract-summary .words{
  margin-top:10px;
  font-size:13px;
  color:#374151;
}

/* =================================================
   Mobile Responsive Support â€“ RKL
================================================= */

/* Ù…Ù†Ø¹ ØªÙƒØ¨ÙŠØ± iOS Ø¯Ø§Ø®Ù„ Ø§Ù„Ø­Ù‚ÙˆÙ„ */
input,
select,
textarea,
button {
  font-size: 16px;
  touch-action: manipulation;
}

/* Ù„Ù Ø§Ù„Ø¬Ø¯Ø§ÙˆÙ„ Ù„Ù„ØªÙ…Ø±ÙŠØ± Ø§Ù„Ø£ÙÙ‚ÙŠ */
.table-wrap {
  width: 100%;
  overflow-x: auto;
  -webkit-overflow-scrolling: touch;
}

/* ===============================
   Mobile Layout
=============================== */
@media (max-width: 768px) {

  /* Ø§Ù„Ø­Ø§ÙˆÙŠØ© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© */
  .container {
    margin: 10px auto;
    padding: 16px 14px;
    border-radius: 10px;
  }

  /* Ø§Ù„Ø¹Ù†ÙˆØ§Ù† */
  .page-header {
    margin-bottom: 20px;
  }

  .page-header h2 {
    font-size: 20px;
    line-height: 1.4;
  }

  .page-header p {
    font-size: 12px;
  }

  /* Ø§Ù„ÙƒØ±ÙˆØª */
  .section {
    padding: 16px;
    margin-bottom: 18px;
  }

  .section h3 {
    font-size: 16px;
    margin-bottom: 14px;
  }

  /* Ø§Ù„Ù†Ù…Ø§Ø°Ø¬ â€“ Ø¹Ù…ÙˆØ¯ ÙˆØ§Ø­Ø¯ */
  .grid {
    grid-template-columns: 1fr !important;
    gap: 12px;
  }

  /* Ø§Ù„Ø­Ù‚ÙˆÙ„ */
  label {
    font-size: 12px;
  }

  input,
  select,
  textarea {
    padding: 12px;
    font-size: 16px;
  }

  textarea {
    min-height: 110px;
  }

  /* Ø§Ù„Ø£Ø²Ø±Ø§Ø± */
  button {
    width: 100%;
    padding: 12px;
    font-size: 15px;
    border-radius: 10px;
  }

  /* Ø£Ø²Ø±Ø§Ø± Ù…ØªØ¹Ø¯Ø¯Ø© */
  .actions {
    flex-direction: column;
    gap: 8px;
  }

  /* Ø§Ù„Ø¬Ø¯Ø§ÙˆÙ„ */
  table {
    min-width: 780px;
  }

  /* Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ø¹Ù‚Ø¯ */
  #reviewBox p {
    font-size: 14px;
    line-height: 1.6;
  }

  /* ØªØ±ÙˆÙŠØ³Ø© Ø§Ù„Ø·Ø¨Ø§Ø¹Ø© Ø¯Ø§Ø®Ù„ Ø§Ù„Ù…Ø¹Ø§ÙŠÙ†Ø© */
  .print-header h1 {
    font-size: 18px;
  }
}

/* ===============================
   Small Phones
=============================== */
@media (max-width: 420px) {

  .page-header h2 {
    font-size: 18px;
  }

  .section h3 {
    font-size: 15px;
  }

  button {
    font-size: 14px;
  }
}


</style>
</head>

<body>
 

<div class="container">

<div class="page-header">


  <div class="header-text">
    <h2>Ø¹Ù‚Ø¯ ØµÙŠØ§Ù†Ø© ÙˆÙ‚Ø§Ø¦ÙŠØ© Ù„Ù„Ù…ØµØ§Ø¹Ø¯</h2>
<p>Ù†Ù…ÙˆØ°Ø¬ Ø¥Ø¹Ø¯Ø§Ø¯ ÙˆØªÙˆÙ„ÙŠØ¯ Ø¹Ù‚Ø¯ ØµÙŠØ§Ù†Ø© Ø§Ø­ØªØ±Ø§ÙÙŠ</p>

    <p>Ø¢Ø± ÙƒÙŠ Ø§Ù„ RKL Ù„Ù„Ù…ØµØ§Ø¹Ø¯ ÙˆØ§Ù„Ø³Ù„Ø§Ù„Ù… Ø§Ù„ÙƒÙ‡Ø±Ø¨Ø§Ø¦ÙŠØ©</p>
    <p class="small">
      Ø§Ù„Ø³Ø¬Ù„ Ø§Ù„ØªØ¬Ø§Ø±ÙŠ: 1010709355 | Ù‡Ø§ØªÙ: 0114774021
    </p>
  </div>
</div>

<!-- ================== Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„ ================== -->
<div class="section">
  <h3>Ø£ÙˆÙ„Ø§Ù‹: Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„</h3>

  <div class="grid" style="align-items:end">
    <div>
      <label>Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø¹Ù…ÙŠÙ„</label>
      <select id="customerSelect">
        <option value="">-- Ø§Ø®ØªØ± Ø§Ù„Ø¹Ù…ÙŠÙ„ --</option>
      </select>
      <div style="margin-top:8px;font-size:12px;color:#6b7280">
        Ø¥Ø°Ø§ Ù„Ù… ÙŠØ¸Ù‡Ø± Ø¹Ù…ÙŠÙ„Ùƒ Ù‡Ù†Ø§ØŒ ØªØ£ÙƒØ¯ Ø£Ù†Ù‡ Ù…Ø­ÙÙˆØ¸ Ù…Ù† ØµÙØ­Ø© Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡.
      </div>
    </div>

    <div>
      <label>Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„</label>
      <div id="customerInfo">â€”</div>
    </div>
  </div>
</div>

<!-- ================== Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ØµØ§Ø¹Ø¯ ================== -->
<div class="section">
  <h3>Ø«Ø§Ù†ÙŠØ§Ù‹: Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ØµØ§Ø¹Ø¯</h3>

  <div class="grid">
    <div>
      <label>Ø¹Ø¯Ø¯ Ø§Ù„Ù…ØµØ§Ø¹Ø¯</label>
      <input id="lifts" type="number" min="1">
    </div>

    <div>
      <label>Ù†ÙˆØ¹ Ø§Ù„Ù…ØµØ¹Ø¯</label>
      <select id="elevatorType">
        <option value="passenger">Ø±ÙƒØ§Ø¨</option>
        <option value="service">Ø®Ø¯Ù…Ø©</option>
        <option value="panoramic">Ø¨Ø§Ù†ÙˆØ±Ø§Ù…ÙŠ</option>
      </select>
    </div>

    <div>
      <label>Ù…Ø§Ø±ÙƒØ© Ø§Ù„Ù…ØµØ¹Ø¯</label>
      <select id="brandSelect" onchange="toggleOtherBrand()">
        <option value="">-- Ø§Ø®ØªØ± --</option>
        <option value="Otis">Otis</option>
        <option value="KONE">KONE</option>
        <option value="Mitsubishi">Mitsubishi</option>
        <option value="Schindler">Schindler</option>
        <option value="Fuji">Fuji</option>
        <option value="Local">ØªØ¬Ù…ÙŠØ¹ Ù…Ø­Ù„ÙŠ</option>
        <option value="Other">Ø£Ø®Ø±Ù‰</option>
      </select>
    </div>

    <div id="otherBrandBox" style="display:none">
      <label>Ø§Ø³Ù… Ø§Ù„Ù…Ø§Ø±ÙƒØ© / Ø§Ù„ØªÙˆØ¶ÙŠØ­</label>
      <input id="brandOther" placeholder="Ù…Ø«Ø§Ù„: Ù…ØµØ¹Ø¯ Ø±ÙƒØ§Ø¨ â€“ Ù…Ø´Ø±ÙˆØ¹ Ø¨Ø±Ø¬ Ø§Ù„Ø³Ù„Ø§Ù…">
    </div>

    <div>
      <label>Ø­Ù…ÙˆÙ„Ø© Ø§Ù„Ù…ØµØ¹Ø¯ (ÙƒØ¬Ù…)</label>
      <select id="capacity">
        <option value="">-- Ø§Ø®ØªØ± --</option>
        <option value="3000">150 â€“ 320</option>
        <option value="3500">350 â€“ 550</option>
        <option value="4000">600 â€“ 900</option>
        <option value="4500">901 â€“ 1100</option>
        <option value="5000">1101 â€“ 1500</option>
        <option value="5500">1501 â€“ 1750</option>
      </select>
    </div>

    <div>
      <label>Ø¹Ø¯Ø¯ Ø§Ù„Ø·ÙˆØ§Ø¨Ù‚</label>
      <input id="floors" type="number" min="1">
    </div>

    <div>
      <label>Ù†ÙˆØ¹ Ø§Ù„Ù…Ø¨Ù†Ù‰</label>
      <select id="building">
        <option value="private">Ø®Ø§Øµ</option>
        <option value="government">Ø­ÙƒÙˆÙ…ÙŠ</option>
      </select>
    </div>
  </div>
</div>

<!-- ================== Ù†ÙˆØ¹ Ø§Ù„Ø®Ø¯Ù…Ø© ================== -->
<div class="section">
  <h3>Ø«Ø§Ù„Ø«Ø§Ù‹: Ù†ÙˆØ¹ Ø§Ù„Ø®Ø¯Ù…Ø©</h3>

  <div class="grid">
    <div>
      <label>Ø§Ø®ØªØ± Ù†ÙˆØ¹ Ø§Ù„Ø®Ø¯Ù…Ø©</label>
      <select id="serviceType" onchange="toggleServiceType()">
        <option value="annual" selected>Ø¹Ù‚Ø¯ ØµÙŠØ§Ù†Ø© ÙˆÙ‚Ø§Ø¦ÙŠØ© Ø³Ù†ÙˆÙŠ</option>
        <option value="once">Ø²ÙŠØ§Ø±Ø© Ù„Ù…Ø±Ø© ÙˆØ§Ø­Ø¯Ø©</option>
      </select>
    </div>

    <div>
      <label>Ù…Ù„Ø§Ø­Ø¸Ø©</label>
      <div style="background:#ecfeff;border:1px dashed #0f766e;padding:12px;border-radius:10px;font-size:13px">
        Ø¹Ù†Ø¯ Ø§Ø®ØªÙŠØ§Ø± "Ø²ÙŠØ§Ø±Ø© Ù„Ù…Ø±Ø© ÙˆØ§Ø­Ø¯Ø©" Ø³ÙŠØªÙ… Ø¹Ø±Ø¶ Ù†Ù…ÙˆØ°Ø¬ Ù…ØªØ·Ù„Ø¨Ø§Øª Ø§Ù„Ø²ÙŠØ§Ø±Ø© ÙˆØ¥Ø®ÙØ§Ø¡ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø¹Ù‚Ø¯ Ø§Ù„Ø³Ù†ÙˆÙŠ.
      </div>
    </div>
  </div>
</div>

<!-- ================== ØµÙ†Ø¯ÙˆÙ‚ Ø§Ù„Ø¹Ù‚Ø¯ Ø§Ù„Ø³Ù†ÙˆÙŠ (ÙŠØ¸Ù‡Ø± ÙÙ‚Ø· Ø¹Ù†Ø¯ annual) ================== -->
<div id="annualBox">




  <!-- ================== Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø¹Ù‚Ø¯ Ø§Ù„Ø³Ù†ÙˆÙŠ ================== -->
  <div class="section">
    <h3>Ø±Ø§Ø¨Ø¹Ø§Ù‹: Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø¹Ù‚Ø¯ Ø§Ù„Ø³Ù†ÙˆÙŠ</h3>

    <div id="editableContract" class="contract">
      <div class="grid">
        <div>
          <label>Ù„ØºØ© Ø§Ù„Ø¹Ù‚Ø¯</label>
          <select id="lang">
            <option value="">-- Ø§Ø®ØªØ± --</option>
            <option value="ar">Ø¹Ø±Ø¨ÙŠ</option>
            <option value="en">English</option>
            <option value="both">Ø¹Ø±Ø¨ÙŠ + English</option>
          </select>
        </div>

        <div>
          <label>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¹Ù‚Ø¯</label>
          <input id="contractDate" type="date">
        </div>

        <div>
          <label>Ù…Ø¯Ø© Ø§Ù„Ø¹Ù‚Ø¯</label>
          <select id="duration">
            <option value="1">Ø³Ù†Ø© ÙˆØ§Ø­Ø¯Ø©</option>
          </select>
        </div>

        <div>
          <label>Ù…Ø¯ÙŠÙ†Ø© Ø§Ù„Ù…Ø´Ø±ÙˆØ¹</label>
          <select id="projectCity">
            <option value="riyadh">Ø§Ù„Ø±ÙŠØ§Ø¶</option>
            <option value="near">Ù…Ø¯Ù† Ù‚Ø±ÙŠØ¨Ø© Ù…Ù† Ø§Ù„Ø±ÙŠØ§Ø¶</option>
            <option value="medium">Ù…Ø¯Ù† Ù…ØªÙˆØ³Ø·Ø© Ø§Ù„Ø¨Ø¹Ø¯</option>
            <option value="far">Ù…Ø¯Ù† Ø¨Ø¹ÙŠØ¯Ø©</option>
            <option value="remote">Ù…Ø¯Ù† Ù†Ø§Ø¦ÙŠØ©</option>
          </select>
        </div>

        <div>
          <label>ØªØ¬Ø¯ÙŠØ¯ ØªÙ„Ù‚Ø§Ø¦ÙŠ</label>
          <select id="renewal">
            <option value="yes">Ù†Ø¹Ù…</option>
            <option value="no">Ù„Ø§</option>
          </select>
        </div>
      </div>
    </div>
  </div>

  <!-- ================== Ù†Ø·Ø§Ù‚ Ø§Ù„ØµÙŠØ§Ù†Ø© (Ø§Ù„Ø¹Ù‚Ø¯ Ø§Ù„Ø³Ù†ÙˆÙŠ) ================== -->
  <div class="section">
    <h3>Ø®Ø§Ù…Ø³Ø§Ù‹: Ù†Ø·Ø§Ù‚ Ø§Ù„ØµÙŠØ§Ù†Ø© (Ø§Ù„Ø¹Ù‚Ø¯ Ø§Ù„Ø³Ù†ÙˆÙŠ)</h3>

    <div class="grid">
      <div>
        <label>Ø¹Ø¯Ø¯ Ø§Ù„Ø²ÙŠØ§Ø±Ø§Øª Ø§Ù„Ø¯ÙˆØ±ÙŠØ©</label>
        <select id="visits">
          <option value="monthly">Ø²ÙŠØ§Ø±Ø© Ø´Ù‡Ø±ÙŠØ©</option>
          <option value="bimonthly">Ø²ÙŠØ§Ø±Ø© ÙƒÙ„ Ø´Ù‡Ø±ÙŠÙ†</option>
        </select>
      </div>

      <div>
        <label>ØªØ¯Ø±ÙŠØ¨ Ø¥Ù†Ù‚Ø§Ø° Ø§Ù„Ù…Ø­ØªØ¬Ø²ÙŠÙ†</label>
        <select id="training">
          <option value="yes">Ù†Ø¹Ù…</option>
          <option value="no">Ù„Ø§</option>
        </select>
      </div>

      <div>
        <label>Ù‚Ø·Ø¹ Ø§Ù„ØºÙŠØ§Ø±</label>
        <select id="spareParts">
          <option value="excluded">ØºÙŠØ± Ù…Ø´Ù…ÙˆÙ„Ø©</option>
          <option value="included">Ù…Ø´Ù…ÙˆÙ„Ø© (Ø¨Ø¹Ø±Ø¶ Ø®Ø§Øµ)</option>
        </select>
      </div>

      <div>
        <label>Ø®Ø¯Ù…Ø© Ø§Ù„Ø·ÙˆØ§Ø±Ø¦</label>
        <select id="emergency">
          <option value="normal">Ø£ÙˆÙ‚Ø§Øª Ø§Ù„Ø¯ÙˆØ§Ù…</option>
          <option value="extended">Ø®Ø§Ø±Ø¬ Ø§Ù„Ø¯ÙˆØ§Ù… (Ø¥Ø¶Ø§ÙÙŠ)</option>
        </select>
      </div>
    </div>

    <label style="margin-top:15px">Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ©</label>
    <textarea id="notes"></textarea>
  </div>

</div>
<div id="onceBox" style="display:none">

  <div class="section">
    <h3>Ø±Ø§Ø¨Ø¹Ø§Ù‹: Ù…ØªØ·Ù„Ø¨Ø§Øª Ø²ÙŠØ§Ø±Ø© Ù„Ù…Ø±Ø© ÙˆØ§Ø­Ø¯Ø©</h3>

    <div class="grid">
      <div>
        <label>Ù†ÙˆØ¹ Ø§Ù„Ø²ÙŠØ§Ø±Ø©</label>
        <select id="onceVisitType">
          <option value="">-- Ø§Ø®ØªØ± --</option>
          <option value="inspection">ÙØ­Øµ ÙˆØªØ´Ø®ÙŠØµ</option>
          <option value="repair">ØµÙŠØ§Ù†Ø©/Ø¥ØµÙ„Ø§Ø­</option>
          <option value="rescue">Ø§Ø­ØªØ¬Ø§Ø²/Ø¥Ù†Ù‚Ø§Ø°</option>
        </select>
      </div>

      <div>
        <label>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø²ÙŠØ§Ø±Ø© Ø§Ù„Ù…Ù‚ØªØ±Ø­</label>
        <input id="onceDate" type="date">
      </div>

      <div>
        <label>Ø§Ù„Ø£ÙˆÙ„ÙˆÙŠØ©</label>
        <select id="onceUrgency">
          <option value="normal">Ø¹Ø§Ø¯ÙŠ</option>
          <option value="urgent">Ù…Ø³ØªØ¹Ø¬Ù„</option>
        </select>
      </div>

      <div>
        <label>Ù‡Ù„ ÙŠÙˆØ¬Ø¯ ØªÙˆÙ‚Ù ÙƒØ§Ù…Ù„ØŸ</label>
        <select id="onceStopped">
          <option value="no">Ù„Ø§</option>
          <option value="yes">Ù†Ø¹Ù…</option>
        </select>
      </div>

      <div style="grid-column:1/-1">
        <label>ÙˆØµÙ Ø§Ù„Ù…Ø´ÙƒÙ„Ø© / Ø§Ù„Ù…Ø·Ù„ÙˆØ¨</label>
        <textarea id="onceIssue" placeholder="Ø§ÙƒØªØ¨ ÙˆØµÙ Ù…Ø®ØªØµØ± Ù„Ù„Ù…Ø´ÙƒÙ„Ø© Ø£Ùˆ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨..."></textarea>
      </div>

      <div>
        <label>Ø³Ø¹Ø± Ø§Ù„Ø²ÙŠØ§Ø±Ø© (Ù‚Ø¨Ù„ Ø§Ù„Ø¶Ø±ÙŠØ¨Ø©) â€” ÙŠØ¯ÙˆÙŠ</label>
        <input id="oncePrice" type="number" min="0" step="0.01" placeholder="Ù…Ø«Ø§Ù„: 450">
      </div>
    </div>

  </div>

</div>



</div>
<button onclick="previewPricing()" style="margin-top:10px;background:#2563eb">
  ğŸ“Š Ø¹Ø±Ø¶ Ø§Ù„Ø­Ø³Ø¨Ø©
</button>

<button id="saveBtn" onclick="saveContract()" style="margin-top:10px;display:none">
  ğŸ’¾ Ø§Ø¹ØªÙ…Ø§Ø¯ ÙˆØ­ÙØ¸ Ø§Ù„Ø¹Ù‚Ø¯
</button>


<!-- ================== Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ø¹Ù‚Ø¯ ================== -->
<div class="section" id="reviewSection" style="display:none">
<h3>Ø®Ø§Ù…Ø³Ø§Ù‹: Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ø¹Ù‚Ø¯</h3>
<div class="review-box" id="reviewBox"></div>

</div>

</div>
<!-- ================== Ø³Ø¬Ù„ Ø§Ù„Ø®Ø¯Ù…Ø§Øª ================== -->
<div class="section">
  <h3>Ø³Ø¬Ù„ Ø§Ù„ØµÙŠØ§Ù†Ø© (Ø¹Ù‚ÙˆØ¯ Ø³Ù†ÙˆÙŠØ© + Ø²ÙŠØ§Ø±Ø§Øª Ù„Ù…Ø±Ø© ÙˆØ§Ø­Ø¯Ø©)</h3>

  <!-- Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø¹Ù‚ÙˆØ¯ Ø§Ù„Ø³Ù†ÙˆÙŠØ© -->
  <h4 style="margin:10px 0;color:#0f766e">Ø£) Ø§Ù„Ø¹Ù‚ÙˆØ¯ Ø§Ù„Ø³Ù†ÙˆÙŠØ© Ø§Ù„Ù…Ø¹ØªÙ…Ø¯Ø©</h4>
  <div class="table-wrap">
    <table border="1" width="100%" cellpadding="8" style="border-collapse:collapse">
      <thead style="background:#f3f4f6">
        <tr>
          <th>#</th>
          <th>Ø±Ù‚Ù… Ø§Ù„Ø¹Ù‚Ø¯</th>
          <th>Ø§Ù„Ø¹Ù…ÙŠÙ„</th>
          <th>Ø¹Ø¯Ø¯ Ø§Ù„Ù…ØµØ§Ø¹Ø¯</th>
          <th>Ù‚ÙŠÙ…Ø© Ø§Ù„Ø¹Ù‚Ø¯</th>
          <th>Ø§Ù„Ù„ØºØ©</th>
          <th>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¹Ù‚Ø¯</th>
          <th>Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
        </tr>
      </thead>
      <tbody id="annualContractsTable"></tbody>
    </table>
  </div>

  <!-- Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø²ÙŠØ§Ø±Ø§Øª -->
  <h4 style="margin:18px 0 10px;color:#0f766e">Ø¨) Ø§Ù„Ø²ÙŠØ§Ø±Ø§Øª Ù„Ù…Ø±Ø© ÙˆØ§Ø­Ø¯Ø© (Ø¹Ø±Ø¶ Ø³Ø¹Ø± / ØªÙ‚Ø±ÙŠØ±)</h4>
  <div class="table-wrap">
    <table border="1" width="100%" cellpadding="8" style="border-collapse:collapse">
      <thead style="background:#f3f4f6">
        <tr>
          <th>#</th>
          <th>Ø±Ù‚Ù… Ø§Ù„Ø²ÙŠØ§Ø±Ø©</th>
          <th>Ø§Ù„Ø¹Ù…ÙŠÙ„</th>
          <th>Ø¹Ø¯Ø¯ Ø§Ù„Ù…ØµØ§Ø¹Ø¯</th>
          <th>Ù‚ÙŠÙ…Ø© Ø§Ù„Ø²ÙŠØ§Ø±Ø©</th>
          <th>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø²ÙŠØ§Ø±Ø©</th>
          <th>Ù†ÙˆØ¹ Ø§Ù„Ø²ÙŠØ§Ø±Ø©</th>
          <th>Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
        </tr>
      </thead>
      <tbody id="onceVisitsTable"></tbody>
    </table>
  </div>
</div>


<script>
let customer = null;

/* =========================================================
   ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ Ù…Ù† Ø§Ù„ØªØ®Ø²ÙŠÙ† (Ù†ÙØ³ ÙÙƒØ±Ø© elevator-quote)
   - Ø¬Ø±Ù‘Ø¨ Ø£ÙƒØ«Ø± Ù…Ù† Ù…ÙØªØ§Ø­ Ø´Ø§Ø¦Ø¹ Ø¹Ø´Ø§Ù† Ù…Ø§ ØªØªØ¹Ø·Ù„ Ù„Ùˆ Ø§Ø®ØªÙ„Ù Ø§Ø³Ù… Ø§Ù„ØªØ®Ø²ÙŠÙ†
========================================================= */
function getCustomersFromStorage(){
  const possibleKeys = [
    'rkl_customers',
    'customers',
    'rkl_customers_list',
    'rkl_customer_list'
  ];

  for(const key of possibleKeys){
    try{
      const raw = localStorage.getItem(key);
      if(!raw) continue;
      const arr = JSON.parse(raw);
      if(Array.isArray(arr) && arr.length) return arr;
    }catch(e){}
  }
  return [];
}

function renderCustomerInfo(c){
  const box = document.getElementById('customerInfo');
  if(!c){
    box.innerHTML = 'â€”';
    return;
  }

  box.innerHTML = `
    Ø§Ù„Ø¹Ù…ÙŠÙ„: <span class="user-data">${c.customer_name || c.name || 'â€”'}</span>
    <p><b>Ø§Ù„Ø¬ÙˆØ§Ù„:</b> ${c.mobile || c.phone || 'â€”'}</p>
    <p><b>Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©:</b> ${c.city || 'â€”'}</p>
    <p><b>Ø§Ù„Ø¹Ù†ÙˆØ§Ù†:</b> ${(c.full_address || c.address || 'â€”')}</p>
  `;
}

function fillCustomerSelect(){
  const select = document.getElementById('customerSelect');
  const customers = getCustomersFromStorage();

  // ØªÙØ±ÙŠØº Ø§Ù„Ø®ÙŠØ§Ø±Ø§Øª
  select.innerHTML = `<option value="">-- Ø§Ø®ØªØ± Ø§Ù„Ø¹Ù…ÙŠÙ„ --</option>`;

  // ØªØ¹Ø¨Ø¦Ø© Ø§Ù„Ø®ÙŠØ§Ø±Ø§Øª
  customers.forEach((c, idx) => {
    const name = c.customer_name || c.name || `Ø¹Ù…ÙŠÙ„ ${idx+1}`;
    const city = c.city ? ` - ${c.city}` : '';
    const opt = document.createElement('option');
    opt.value = String(idx);
    opt.textContent = `${name}${city}`;
    select.appendChild(opt);
  });

  // Ø¥Ù† ÙƒØ§Ù† Ù‡Ù†Ø§Ùƒ Ø¹Ù…ÙŠÙ„ Ù…ÙØ­Ø¯Ø¯ Ø³Ø§Ø¨Ù‚Ù‹Ø§
  const saved = localStorage.getItem('rkl_selected_customer');
  if(saved){
    try{
      const savedObj = JSON.parse(saved);
      const savedName = savedObj.customer_name || savedObj.name || '';
      const foundIndex = customers.findIndex(x => (x.customer_name || x.name || '') === savedName);
      if(foundIndex > -1){
        select.value = String(foundIndex);
        customer = customers[foundIndex];
        renderCustomerInfo(customer);
        return;
      }
    }catch(e){}
  }

  // Ø¥Ø°Ø§ Ù…Ø§ ÙÙŠ ØªØ­Ø¯ÙŠØ¯ Ø³Ø§Ø¨Ù‚: Ø§Ø¹Ø±Ø¶ Ø£ÙˆÙ„ Ø¹Ù…ÙŠÙ„ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)
  if(customers.length){
    select.value = "0";
    customer = customers[0];
    localStorage.setItem('rkl_selected_customer', JSON.stringify(customer));
    renderCustomerInfo(customer);
  }else{
    renderCustomerInfo(null);
  }
}

document.addEventListener('DOMContentLoaded', () => {
  fillCustomerSelect();

  document.getElementById('customerSelect').addEventListener('change', (e) => {
    const customers = getCustomersFromStorage();
    const idx = Number(e.target.value);

    if(!e.target.value){
      customer = null;
      localStorage.removeItem('rkl_selected_customer');
      renderCustomerInfo(null);
      return;
    }

    customer = customers[idx] || null;
    if(customer){
      localStorage.setItem('rkl_selected_customer', JSON.stringify(customer));
    }
    renderCustomerInfo(customer);
  });
});


  function generateFullContractText(){

  const lang = document.getElementById('lang').value;
  const date = document.getElementById('contractDate').value;
  const lifts = document.getElementById('lifts').value;
const brandSelect = document.getElementById('brandSelect').value;
const brandOther  = document.getElementById('brandOther')?.value || '';

let brand = '';

if (brandSelect === 'Local') {
  brand = 'local';
} else if (brandSelect === 'Other') {
  brand = brandOther.trim().toLowerCase() || 'other';
} else {
  brand = brandSelect.toLowerCase();
}


  const buildingType = document.getElementById('building').value === 'government'
    ? 'Ø­ÙƒÙˆÙ…ÙŠ'
    : 'Ø®Ø§Øµ';

  const city = customer.city || 'â€”';
  const address = customer.full_address || city;
  const mobile = customer.mobile || 'â€”';

 const calc = window.finalCalcOverride || calculateTotal();


/* ================== Ø§Ù„Ù†Øµ Ø§Ù„Ø¹Ø±Ø¨ÙŠ ================== */
const ar = `
Ø¨Ø¹ÙˆÙ† Ø§Ù„Ù„Ù‡ ÙˆØªÙˆÙÙŠÙ‚Ù‡ØŒ ÙÙ‚Ø¯ ØªÙ… ÙÙŠ ÙŠÙˆÙ… ${date} Ø¥Ø¨Ø±Ø§Ù… Ù‡Ø°Ø§ Ø§Ù„Ø¹Ù‚Ø¯ Ø¨ÙŠÙ† ÙƒÙ„Ù Ù…Ù†:

Ø£ÙˆÙ„Ù‹Ø§: Ø§Ù„Ø·Ø±Ù Ø§Ù„Ø£ÙˆÙ„  
Ù…Ø¤Ø³Ø³Ø© Ø¢Ø± ÙƒÙŠ Ø§Ù„ RKL Ù„Ù„Ù…ØµØ§Ø¹Ø¯ ÙˆØ§Ù„Ø³Ù„Ø§Ù„Ù… Ø§Ù„ÙƒÙ‡Ø±Ø¨Ø§Ø¦ÙŠØ©  
Ø³Ø¬Ù„ ØªØ¬Ø§Ø±ÙŠ Ø±Ù‚Ù…: (1010709355)  
Ø±Ù‚Ù… Ø§Ù„ØªØ¹Ø±ÙŠÙ Ø§Ù„Ø¶Ø±ÙŠØ¨ÙŠ: (302250422600003)  
Ø§Ù„Ø¹Ù†ÙˆØ§Ù†: Ø­ÙŠ Ø§Ù„Ø³Ù„ÙŠÙ…Ø§Ù†ÙŠØ© â€“ Ù…Ø¯ÙŠÙ†Ø© Ø§Ù„Ø±ÙŠØ§Ø¶ â€“ Ø§Ù„Ù…Ù…Ù„ÙƒØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©  
Ù‡Ø§ØªÙ: 0114774021  
ÙˆÙŠÙØ´Ø§Ø± Ø¥Ù„ÙŠÙ‡Ø§ Ù„Ø§Ø­Ù‚Ù‹Ø§ Ø¨Ù€ (Ø§Ù„Ø·Ø±Ù Ø§Ù„Ø£ÙˆÙ„)

Ø«Ø§Ù†ÙŠÙ‹Ø§: Ø§Ù„Ø·Ø±Ù Ø§Ù„Ø«Ø§Ù†ÙŠ  
Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„: ${customer.customer_name}  
Ø±Ù‚Ù… Ø§Ù„Ø¬ÙˆØ§Ù„: ${mobile}  
Ø§Ù„Ø¹Ù†ÙˆØ§Ù†: ${address}  
ÙˆÙŠÙØ´Ø§Ø± Ø¥Ù„ÙŠÙ‡ Ù„Ø§Ø­Ù‚Ù‹Ø§ Ø¨Ù€ (Ø§Ù„Ø·Ø±Ù Ø§Ù„Ø«Ø§Ù†ÙŠ)

### ØªÙ…Ù‡ÙŠØ¯:
Ù†Ø¸Ø±Ù‹Ø§ Ù„Ø±ØºØ¨Ø© Ø§Ù„Ø·Ø±Ù Ø§Ù„Ø«Ø§Ù†ÙŠ ÙÙŠ Ø§Ù„ØªØ¹Ø§Ù‚Ø¯ Ø¹Ù„Ù‰ Ø£Ø¹Ù…Ø§Ù„ Ø§Ù„ØµÙŠØ§Ù†Ø© Ø§Ù„ÙˆÙ‚Ø§Ø¦ÙŠØ© Ø§Ù„Ø¯ÙˆØ±ÙŠØ© Ù„Ø¹Ø¯Ø¯ (${lifts}) Ù…ØµØ¹Ø¯/Ù…ØµØ§Ø¹Ø¯ Ø±ÙƒØ§Ø¨ØŒ
Ù…Ù† Ù†ÙˆØ¹ (${brand})ØŒ ØªØ®Ø¯Ù… Ù…Ø¨Ù†Ù‰ (${buildingType}) Ø§Ù„ÙƒØ§Ø¦Ù† ÙÙŠ Ù…Ø¯ÙŠÙ†Ø© (${city})ØŒ
ÙˆØ­ÙŠØ« Ø¥Ù† Ø§Ù„Ø·Ø±Ù Ø§Ù„Ø£ÙˆÙ„ Ø¬Ù‡Ø© Ù…ØªØ®ØµØµØ© ÙˆÙ…Ø±Ø®ØµØ© ÙÙŠ Ø£Ø¹Ù…Ø§Ù„ ØµÙŠØ§Ù†Ø© Ø§Ù„Ù…ØµØ§Ø¹Ø¯ ÙˆØ§Ù„Ø³Ù„Ø§Ù„Ù… Ø§Ù„ÙƒÙ‡Ø±Ø¨Ø§Ø¦ÙŠØ©ØŒ
ÙÙ‚Ø¯ Ø§ØªÙÙ‚ Ø§Ù„Ø·Ø±ÙØ§Ù† â€“ ÙˆÙ‡Ù…Ø§ Ø¨ÙƒØ§Ù…Ù„ Ø£Ù‡Ù„ÙŠØªÙ‡Ù…Ø§ Ø§Ù„Ø´Ø±Ø¹ÙŠØ© ÙˆØ§Ù„Ù†Ø¸Ø§Ù…ÙŠØ© â€“ Ø¹Ù„Ù‰ Ù…Ø§ ÙŠÙ„ÙŠ:

### Ø§Ù„Ù…Ø§Ø¯Ø© (1): Ù†Ø·Ø§Ù‚ Ø§Ù„Ø¹Ù‚Ø¯
ÙŠÙ„ØªØ²Ù… Ø§Ù„Ø·Ø±Ù Ø§Ù„Ø£ÙˆÙ„ Ø¨ØªÙ‚Ø¯ÙŠÙ… Ø®Ø¯Ù…Ø§Øª Ø§Ù„ØµÙŠØ§Ù†Ø© Ø§Ù„ÙˆÙ‚Ø§Ø¦ÙŠØ© Ø§Ù„Ø¯ÙˆØ±ÙŠØ© Ù„Ù„Ù…ØµØ§Ø¹Ø¯ Ø§Ù„Ù…Ø´Ù…ÙˆÙ„Ø© Ø¨Ø§Ù„Ø¹Ù‚Ø¯ØŒ ÙˆÙÙ‚Ù‹Ø§ Ù„Ù„Ù…Ø¹Ø§ÙŠÙŠØ± Ø§Ù„ÙÙ†ÙŠØ© Ø§Ù„Ù…Ø¹ØªÙ…Ø¯Ø© ÙˆØ£Ù†Ø¸Ù…Ø© Ø§Ù„Ø³Ù„Ø§Ù…Ø© Ø§Ù„Ù…Ø¹Ù…ÙˆÙ„ Ø¨Ù‡Ø§ ÙÙŠ Ø§Ù„Ù…Ù…Ù„ÙƒØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©.

### Ø§Ù„Ù…Ø§Ø¯Ø© (2): Ø£Ø¹Ù…Ø§Ù„ Ø§Ù„ØµÙŠØ§Ù†Ø© Ø§Ù„ÙˆÙ‚Ø§Ø¦ÙŠØ©
ØªØ´Ù…Ù„ Ø£Ø¹Ù…Ø§Ù„ Ø§Ù„ØµÙŠØ§Ù†Ø© Ø§Ù„ÙˆÙ‚Ø§Ø¦ÙŠØ© â€“ Ø¯ÙˆÙ† Ø­ØµØ± â€“ Ù…Ø§ ÙŠÙ„ÙŠ:
- Ø§Ù„ÙØ­Øµ Ø§Ù„Ø¯ÙˆØ±ÙŠ Ø§Ù„Ø´Ù‡Ø±ÙŠ Ù„Ø¬Ù…ÙŠØ¹ Ù…ÙƒÙˆÙ†Ø§Øª Ø§Ù„Ù…ØµØ¹Ø¯.
- ØªÙ†Ø¸ÙŠÙ ÙˆØªØ²ÙŠÙŠØª Ø§Ù„Ø£Ø¬Ø²Ø§Ø¡ Ø§Ù„Ù…ÙŠÙƒØ§Ù†ÙŠÙƒÙŠØ© Ø§Ù„Ù…ØªØ­Ø±ÙƒØ©.
- ÙØ­Øµ Ø£Ø¬Ù‡Ø²Ø© Ø§Ù„Ø£Ù…Ø§Ù† ÙˆØ£Ù†Ø¸Ù…Ø© Ø§Ù„ØªØ­ÙƒÙ….
- Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø³Ù„Ø§Ù…Ø© Ø§Ù„Ù…Ø­Ø±ÙƒØ§ØªØŒ Ø§Ù„ÙƒÙˆØ§Ø¨Ø­ØŒ Ø§Ù„Ø­Ø¨Ø§Ù„ØŒ ÙˆØ§Ù„Ø£Ø¨ÙˆØ§Ø¨.
- ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø§Ù„ÙÙ†ÙŠØ© ÙˆØ§Ù„ØªÙˆØµÙŠØ§Øª Ø§Ù„Ù„Ø§Ø²Ù…Ø©.

### Ø§Ù„Ù…Ø§Ø¯Ø© (3): Ø§Ù„Ø¨Ù„Ø§ØºØ§Øª ÙˆØ§Ù„Ø£Ø¹Ø·Ø§Ù„
ÙŠÙ„ØªØ²Ù… Ø§Ù„Ø·Ø±Ù Ø§Ù„Ø«Ø§Ù†ÙŠ Ø¨Ø¥Ø¨Ù„Ø§Øº Ø§Ù„Ø·Ø±Ù Ø§Ù„Ø£ÙˆÙ„ ÙÙˆØ± Ù…Ù„Ø§Ø­Ø¸Ø© Ø£ÙŠ Ø®Ù„Ù„ Ø£Ùˆ ØªÙˆÙ‚Ù ØºÙŠØ± Ø·Ø¨ÙŠØ¹ÙŠØŒ ÙˆÙŠÙ‚ÙˆÙ… Ø§Ù„Ø·Ø±Ù Ø§Ù„Ø£ÙˆÙ„ Ø¨Ø§ØªØ®Ø§Ø° Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø§Ù„Ù„Ø§Ø²Ù…Ø© Ù„Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù…ØµØ¹Ø¯ Ø¥Ù„Ù‰ ÙˆØ¶Ø¹ Ø§Ù„ØªØ´ØºÙŠÙ„ Ø§Ù„Ø·Ø¨ÙŠØ¹ÙŠ.

### Ø§Ù„Ù…Ø§Ø¯Ø© (4): Ø§Ù„Ø§Ø³ØªØ¬Ø§Ø¨Ø© Ù„Ù„Ø·ÙˆØ§Ø±Ø¦
ÙŠÙ„ØªØ²Ù… Ø§Ù„Ø·Ø±Ù Ø§Ù„Ø£ÙˆÙ„ Ø¨Ø§Ù„Ø§Ø³ØªØ¬Ø§Ø¨Ø© Ù„Ø¨Ù„Ø§ØºØ§Øª Ø§Ù„Ø£Ø¹Ø·Ø§Ù„ Ø§Ù„Ø·Ø§Ø±Ø¦Ø© Ø®Ù„Ø§Ù„ Ù…Ø¯Ø© Ø²Ù…Ù†ÙŠØ© Ù…Ø¹Ù‚ÙˆÙ„Ø© Ø­Ø³Ø¨ Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ ÙˆØ·Ø¨ÙŠØ¹Ø© Ø§Ù„Ø¹Ø·Ù„.

### Ø§Ù„Ù…Ø§Ø¯Ø© (5): ØªØ¯Ø±ÙŠØ¨ Ù…ÙˆØ¸ÙÙŠ Ø§Ù„Ø¹Ù…ÙŠÙ„
ÙŠÙ„ØªØ²Ù… Ø§Ù„Ø·Ø±Ù Ø§Ù„Ø£ÙˆÙ„ Ø¨ØªØ¯Ø±ÙŠØ¨ Ø¹Ø¯Ø¯ (1â€“2) Ù…Ù† Ù…ÙˆØ¸ÙÙŠ Ø§Ù„Ø·Ø±Ù Ø§Ù„Ø«Ø§Ù†ÙŠ Ø¹Ù„Ù‰ Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø¥Ù†Ù‚Ø§Ø° Ø§Ù„Ø±ÙƒØ§Ø¨ Ø§Ù„Ù…Ø­ØªØ¬Ø²ÙŠÙ† Ø¯Ø§Ø®Ù„ Ø§Ù„Ù…ØµØ¹Ø¯ ÙÙŠ Ø­Ø§Ù„Ø§Øª Ø§Ù„Ø·ÙˆØ§Ø±Ø¦.

### Ø§Ù„Ù…Ø§Ø¯Ø© (6): Ø§Ù„Ù…Ø³ØªÙ„Ø²Ù…Ø§Øª Ø§Ù„ØªØ´ØºÙŠÙ„ÙŠØ©
ÙŠØªØ¹Ù‡Ø¯ Ø§Ù„Ø·Ø±Ù Ø§Ù„Ø£ÙˆÙ„ Ø¨ØªÙˆÙÙŠØ± Ø§Ù„Ø²ÙŠÙˆØªØŒ Ø§Ù„Ø´Ø­ÙˆÙ…ØŒ ÙˆÙ…ÙˆØ§Ø¯ Ø§Ù„ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ù„Ø§Ø²Ù…Ø© Ù„Ø£Ø¹Ù…Ø§Ù„ Ø§Ù„ØµÙŠØ§Ù†Ø© Ø§Ù„ÙˆÙ‚Ø§Ø¦ÙŠØ©.

### Ø§Ù„Ù…Ø§Ø¯Ø© (7): Ù‚Ø·Ø¹ Ø§Ù„ØºÙŠØ§Ø±
Ù„Ø§ ÙŠØ´Ù…Ù„ Ù‡Ø°Ø§ Ø§Ù„Ø¹Ù‚Ø¯ ØªÙˆØ±ÙŠØ¯ Ø£Ùˆ Ø§Ø³ØªØ¨Ø¯Ø§Ù„ Ù‚Ø·Ø¹ Ø§Ù„ØºÙŠØ§Ø±ØŒ ÙˆÙŠØªØ­Ù…Ù„ Ø§Ù„Ø·Ø±Ù Ø§Ù„Ø«Ø§Ù†ÙŠ ØªÙƒÙ„ÙØ© Ø£ÙŠ Ù‚Ø·Ø¹ ØºÙŠØ§Ø± ÙŠØªÙ… Ø§Ø³ØªØ¨Ø¯Ø§Ù„Ù‡Ø§ØŒ ÙˆÙŠØªÙ… ØªØ³Ø¹ÙŠØ±Ù‡Ø§ Ø¨Ø¹Ø±Ø¶ Ø³Ø¹Ø± Ù…Ø³ØªÙ‚Ù„ ÙˆÙ…Ø¹ØªÙ…Ø¯.

### Ø§Ù„Ù…Ø§Ø¯Ø© (8): Ù‚ÙŠÙ…Ø© Ø§Ù„Ø¹Ù‚Ø¯
ÙŠÙ„ØªØ²Ù… Ø§Ù„Ø·Ø±Ù Ø§Ù„Ø«Ø§Ù†ÙŠ Ø¨Ø³Ø¯Ø§Ø¯ Ù‚ÙŠÙ…Ø© Ø§Ù„Ø¹Ù‚Ø¯ Ø§Ù„Ø³Ù†ÙˆÙŠ ÙˆÙÙ‚ Ø§Ù„Ø¨ÙŠØ§Ù† Ø§Ù„ØªØ§Ù„ÙŠ:


<div class="contract-summary">
  <h4>Ù…Ù„Ø®Øµ Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠØ© Ù„Ù„Ø¹Ù‚Ø¯</h4>
  <table>
    <tr>
      <td class="label">Ù‚ÙŠÙ…Ø© Ø§Ù„Ø¹Ù‚Ø¯ Ù‚Ø¨Ù„ Ø§Ù„Ø¶Ø±ÙŠØ¨Ø©</td>
      <td class="value">${(calc.total / 1.15).toFixed(2)} Ø±ÙŠØ§Ù„ Ø³Ø¹ÙˆØ¯ÙŠ</td>
    </tr>
    <tr>
      <td class="label">Ø¶Ø±ÙŠØ¨Ø© Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ù…Ø¶Ø§ÙØ© (15%)</td>
      <td class="value">${(calc.total - (calc.total / 1.15)).toFixed(2)} Ø±ÙŠØ§Ù„ Ø³Ø¹ÙˆØ¯ÙŠ</td>
    </tr>
    <tr>
      <td class="label total">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ù‚ÙŠÙ…Ø© Ø§Ù„Ø¹Ù‚Ø¯ Ø´Ø§Ù…Ù„ Ø§Ù„Ø¶Ø±ÙŠØ¨Ø©</td>
      <td class="value total">${calc.total.toFixed(2)} Ø±ÙŠØ§Ù„ Ø³Ø¹ÙˆØ¯ÙŠ</td>
    </tr>
  </table>
</div>

### Ø§Ù„Ù…Ø§Ø¯Ø© (9): Ù…Ø¯Ø© Ø§Ù„Ø¹Ù‚Ø¯
ØªØ³Ø±ÙŠ Ù…Ø¯Ø© Ù‡Ø°Ø§ Ø§Ù„Ø¹Ù‚Ø¯ Ù„Ù…Ø¯Ø© Ø³Ù†Ø© Ù…ÙŠÙ„Ø§Ø¯ÙŠØ© ÙˆØ§Ø­Ø¯Ø© ØªØ¨Ø¯Ø£ Ù…Ù†:
- ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©: ${date}
- ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡: ${(() => {
  const d = new Date(date);
  d.setFullYear(d.getFullYear() + 1);
  return d.toISOString().split('T')[0];
})()}

ÙˆÙŠØªØ¬Ø¯Ø¯ Ø§Ù„Ø¹Ù‚Ø¯ ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§ Ù…Ø§ Ù„Ù… ÙŠÙØ®Ø·Ø± Ø£Ø­Ø¯ Ø§Ù„Ø·Ø±ÙÙŠÙ† Ø§Ù„Ø¢Ø®Ø± Ø®Ø·ÙŠÙ‹Ø§ Ø¨Ø¹Ø¯Ù… Ø§Ù„Ø±ØºØ¨Ø© ÙÙŠ Ø§Ù„ØªØ¬Ø¯ÙŠØ¯ Ù‚Ø¨Ù„ (60) ÙŠÙˆÙ…Ù‹Ø§ Ù…Ù† ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡.

### Ø§Ù„Ù…Ø§Ø¯Ø© (10): Ø§Ù„Ø³Ø¯Ø§Ø¯ ÙˆØ§Ù„ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø¨Ù†ÙƒÙŠ
ØªÙØ³Ø¯Ø¯ Ø§Ù„Ø¯ÙØ¹Ø§Øª Ø¹Ø¨Ø± Ø§Ù„ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø¨Ù†ÙƒÙŠ Ø¥Ù„Ù‰ Ø§Ù„Ø­Ø³Ø§Ø¨ Ø§Ù„ØªØ§Ù„ÙŠ:
Ø§Ù„Ø¨Ù†Ùƒ: Ø§Ù„Ø¨Ù†Ùƒ Ø§Ù„Ø£Ù‡Ù„ÙŠ Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠ (SNB)  
Ø§Ø³Ù… Ø§Ù„Ø­Ø³Ø§Ø¨: Ø¢Ø± ÙƒÙŠ Ø§Ù„ RKL  
Ø±Ù‚Ù… Ø§Ù„Ø­Ø³Ø§Ø¨: 01400005531406  
Ø§Ù„Ø¢ÙŠØ¨Ø§Ù†: SA1710000001400005531406  

### Ø§Ù„Ù…Ø§Ø¯Ø© (11): Ø§Ù„Ø¥ÙŠÙ‚Ø§Ù Ø¨Ø³Ø¨Ø¨ Ø¹Ø¯Ù… Ø§Ù„Ø³Ø¯Ø§Ø¯
ÙŠØ­Ù‚ Ù„Ù„Ø·Ø±Ù Ø§Ù„Ø£ÙˆÙ„ Ø¥ÙŠÙ‚Ø§Ù Ø£Ø¹Ù…Ø§Ù„ Ø§Ù„ØµÙŠØ§Ù†Ø© Ù…Ø¤Ù‚ØªÙ‹Ø§ ÙÙŠ Ø­Ø§Ù„ ØªØ£Ø®Ø± Ø§Ù„Ø·Ø±Ù Ø§Ù„Ø«Ø§Ù†ÙŠ Ø¹Ù† Ø§Ù„Ø³Ø¯Ø§Ø¯ØŒ Ø¯ÙˆÙ† Ø£ÙŠ Ù…Ø³Ø¤ÙˆÙ„ÙŠØ© Ù‚Ø§Ù†ÙˆÙ†ÙŠØ©.

### Ø§Ù„Ù…Ø§Ø¯Ø© (12): Ø­Ø¯ÙˆØ¯ Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ÙŠØ©
Ù„Ø§ ÙŠØªØ­Ù…Ù„ Ø§Ù„Ø·Ø±Ù Ø§Ù„Ø£ÙˆÙ„ Ø£ÙŠ Ù…Ø³Ø¤ÙˆÙ„ÙŠØ© Ø¹Ù† Ø§Ù„Ø£Ø¹Ø·Ø§Ù„ Ø§Ù„Ù†Ø§ØªØ¬Ø© Ø¹Ù†:
- Ø³ÙˆØ¡ Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø£Ùˆ Ø§Ù„ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø²Ø§Ø¦Ø¯
- Ø§Ù„Ø¹Ø¨Ø« Ø£Ùˆ Ø§Ù„ØªØ®Ø±ÙŠØ¨
- Ø§Ù†Ù‚Ø·Ø§Ø¹ Ø£Ùˆ Ø¶Ø¹Ù Ø§Ù„ØªÙŠØ§Ø± Ø§Ù„ÙƒÙ‡Ø±Ø¨Ø§Ø¦ÙŠ
- Ø§Ù„ÙƒÙˆØ§Ø±Ø« Ø§Ù„Ø·Ø¨ÙŠØ¹ÙŠØ© Ø£Ùˆ Ø§Ù„Ø¸Ø±ÙˆÙ Ø§Ù„Ù‚Ø§Ù‡Ø±Ø©
- ØªØ¯Ø®Ù„ Ø£Ø·Ø±Ø§Ù ØºÙŠØ± Ù…Ø¹ØªÙ…Ø¯Ø©

### Ø§Ù„Ù…Ø§Ø¯Ø© (13): Ø§Ù„Ø³Ù„Ø§Ù…Ø©
ÙŠÙ„ØªØ²Ù… Ø§Ù„Ø·Ø±Ù Ø§Ù„Ø«Ø§Ù†ÙŠ Ø¨ØªÙˆÙÙŠØ± Ø¨ÙŠØ¦Ø© Ø¹Ù…Ù„ Ø¢Ù…Ù†Ø© Ø¯Ø§Ø®Ù„ Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ù…ØµØ§Ø¹Ø¯ ÙˆÙÙ‚ Ø§Ø´ØªØ±Ø§Ø·Ø§Øª Ø§Ù„Ø³Ù„Ø§Ù…Ø© Ø§Ù„Ù…Ø¹ØªÙ…Ø¯Ø©.

### Ø§Ù„Ù…Ø§Ø¯Ø© (14): Ø§Ù„Ø¥Ù†Ù‡Ø§Ø¡
ÙŠØ¬ÙˆØ² Ù„Ø£ÙŠ Ù…Ù† Ø§Ù„Ø·Ø±ÙÙŠÙ† Ø¥Ù†Ù‡Ø§Ø¡ Ø§Ù„Ø¹Ù‚Ø¯ Ø¨Ø¥Ø´Ø¹Ø§Ø± Ø®Ø·ÙŠ Ù…Ø³Ø¨Ù‚ Ù…Ø¯ØªÙ‡ (30) ÙŠÙˆÙ…Ù‹Ø§ØŒ Ù…Ø¹ ØªØ³ÙˆÙŠØ© Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø§Ù„ØªØ²Ø§Ù…Ø§Øª Ø§Ù„Ù…Ø§Ù„ÙŠØ© Ø­ØªÙ‰ ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¥Ù†Ù‡Ø§Ø¡.
### Ø§Ù„Ù…Ø§Ø¯Ø© (15): Ø§Ø³ØªØ­Ù‚Ø§Ù‚ ÙƒØ§Ù…Ù„ Ù‚ÙŠÙ…Ø© Ø§Ù„Ø¹Ù‚Ø¯
ÙŠÙ‚Ø± Ø§Ù„Ø·Ø±Ù Ø§Ù„Ø«Ø§Ù†ÙŠ ÙˆÙŠÙˆØ§ÙÙ‚ ØµØ±Ø§Ø­Ø©Ù‹ Ø¨Ø£Ù†Ù‡ Ø¨Ù…Ø¬Ø±Ø¯ Ø³Ø¯Ø§Ø¯ Ø£ÙŠ Ø¯ÙØ¹Ø© Ù…Ø§Ù„ÙŠØ© Ù…Ù† Ù‚ÙŠÙ…Ø© Ù‡Ø°Ø§ Ø§Ù„Ø¹Ù‚Ø¯ â€“ Ø³ÙˆØ§Ø¡ ÙƒØ§Ù†Øª Ø¯ÙØ¹Ø© Ø¬Ø²Ø¦ÙŠØ© Ø£Ùˆ Ø£ÙˆÙ„ÙŠØ© â€“ ÙØ¥Ù† Ø°Ù„Ùƒ ÙŠÙØ¹Ø¯ Ø¥Ù‚Ø±Ø§Ø±Ù‹Ø§ Ù†Ù‡Ø§Ø¦ÙŠÙ‹Ø§ Ø¨Ø§Ù„Ø§Ù„ØªØ²Ø§Ù… Ø¨ÙƒØ§Ù…Ù„ Ù‚ÙŠÙ…Ø© Ø§Ù„Ø¹Ù‚Ø¯ Ø§Ù„Ø³Ù†ÙˆÙŠØ©ØŒ ÙˆØªØµØ¨Ø­ Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠØ© Ù„Ù„Ø¹Ù‚Ø¯ Ù…Ø³ØªØ­Ù‚Ø© Ø§Ù„Ø³Ø¯Ø§Ø¯ Ù„Ù„Ø·Ø±Ù Ø§Ù„Ø£ÙˆÙ„ ÙƒØ§Ù…Ù„Ø©Ù‹ØŒ ÙˆÙ„Ø§ ÙŠØ­Ù‚ Ù„Ù„Ø·Ø±Ù Ø§Ù„Ø«Ø§Ù†ÙŠ Ø§Ù„Ù…Ø·Ø§Ù„Ø¨Ø© Ø¨Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ø¹Ù‚Ø¯ Ø£Ùˆ ØªØ®ÙÙŠØ¶ Ù‚ÙŠÙ…ØªÙ‡ Ø£Ùˆ ØªØ¹Ù„ÙŠÙ‚ Ø§Ù„Ø§Ù„ØªØ²Ø§Ù… Ø§Ù„Ù…Ø§Ù„ÙŠ Ù„Ø£ÙŠ Ø³Ø¨Ø¨ ÙƒØ§Ù† Ø¨Ø¹Ø¯ Ø§Ù„Ø³Ø¯Ø§Ø¯ Ø§Ù„Ø¬Ø²Ø¦ÙŠ.

### Ø§Ù„Ù…Ø§Ø¯Ø© (16): Ø§Ø­ØªØ³Ø§Ø¨ Ø§Ù„Ø²ÙŠØ§Ø±Ø§Øª ÙÙŠ Ø­Ø§Ù„ ØªÙˆÙ‚Ù Ø§Ù„Ù…ØµØ¹Ø¯
ÙŠÙ‚Ø± Ø§Ù„Ø·Ø±Ù Ø§Ù„Ø«Ø§Ù†ÙŠ ÙˆÙŠÙˆØ§ÙÙ‚ Ø¹Ù„Ù‰ Ø£Ù† Ø§Ù„Ø²ÙŠØ§Ø±Ø© Ø§Ù„Ù…ÙŠØ¯Ø§Ù†ÙŠØ© Ø§Ù„ØªÙŠ ÙŠÙ‚ÙˆÙ… Ø¨Ù‡Ø§ Ø§Ù„Ø·Ø±Ù Ø§Ù„Ø£ÙˆÙ„ ØªÙØ¹Ø¯ Ø²ÙŠØ§Ø±Ø© ØµÙŠØ§Ù†Ø© Ù…ÙƒØªÙ…Ù„Ø© Ø¶Ù…Ù† Ø¬Ø¯ÙˆÙ„ Ø§Ù„ØµÙŠØ§Ù†Ø© Ø§Ù„ÙˆÙ‚Ø§Ø¦ÙŠØ© Ø§Ù„Ù…ØªÙÙ‚ Ø¹Ù„ÙŠÙ‡ØŒ Ø­ØªÙ‰ ÙÙŠ Ø­Ø§Ù„ ÙƒØ§Ù† Ø§Ù„Ù…ØµØ¹Ø¯ Ù…ØªÙˆÙ‚ÙÙ‹Ø§ Ø¹Ù† Ø§Ù„Ø¹Ù…Ù„ØŒ Ø£Ùˆ ØªØ¨ÙŠÙ† Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø²ÙŠØ§Ø±Ø© ÙˆØ¬ÙˆØ¯ Ø¹Ø·Ù„ ÙŠØªØ·Ù„Ø¨ Ø§Ø³ØªØ¨Ø¯Ø§Ù„ Ù‚Ø·Ø¹ ØºÙŠØ§Ø± Ø£Ùˆ Ø£Ø¹Ù…Ø§Ù„ Ø¥Ø¶Ø§ÙÙŠØ© ØºÙŠØ± Ù…Ø´Ù…ÙˆÙ„Ø© ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„Ø¹Ù‚Ø¯.

ÙˆÙ„Ø§ ÙŠÙ„ØªØ²Ù… Ø§Ù„Ø·Ø±Ù Ø§Ù„Ø£ÙˆÙ„ Ø¨Ø¥Ø¹Ø§Ø¯Ø© Ø²ÙŠØ§Ø±Ø© Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø£Ùˆ ØªÙ†ÙÙŠØ° Ø£Ø¹Ù…Ø§Ù„ Ø¥Ø¶Ø§ÙÙŠØ© Ø¥Ù„Ø§ Ø¨Ø¹Ø¯ Ø§Ø¹ØªÙ…Ø§Ø¯ Ø¹Ø±Ø¶ Ø³Ø¹Ø± Ù…Ø³ØªÙ‚Ù„ Ù„ØªÙˆØ±ÙŠØ¯ Ø£Ùˆ Ø§Ø³ØªØ¨Ø¯Ø§Ù„ Ù‚Ø·Ø¹ Ø§Ù„ØºÙŠØ§Ø± Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©ØŒ ÙˆØªÙØ¹Ø¯ Ø§Ù„Ø²ÙŠØ§Ø±Ø© Ø§Ù„Ù…Ù†ÙØ°Ø© ÙÙŠ Ù‡Ø°Ù‡ Ø§Ù„Ø­Ø§Ù„Ø© Ø²ÙŠØ§Ø±Ø© Ù…Ø­ØªØ³Ø¨Ø© ÙˆÙ…ÙƒØªÙ…Ù„Ø© ÙˆÙ„Ø§ ØªÙØ¹Ø§Ø¯ Ù…Ø¬Ø§Ù†Ù‹Ø§.

### Ø§Ù„Ù…Ø§Ø¯Ø© (17): Ø§Ù„Ø§Ø®ØªØµØ§Øµ Ø§Ù„Ù‚Ø¶Ø§Ø¦ÙŠ
ÙÙŠ Ø­Ø§Ù„ Ù†Ø´ÙˆØ¡ Ø£ÙŠ Ù†Ø²Ø§Ø¹ â€“ Ù„Ø§ Ù‚Ø¯Ø± Ø§Ù„Ù„Ù‡ â€“ ÙŠÙƒÙˆÙ† Ø§Ù„Ø§Ø®ØªØµØ§Øµ Ø§Ù„Ù‚Ø¶Ø§Ø¦ÙŠ Ù„Ù„Ù…Ø­Ø§ÙƒÙ… Ø§Ù„Ù…Ø®ØªØµØ© ÙÙŠ Ø§Ù„Ù…Ù…Ù„ÙƒØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©.

ÙˆØ¨Ù‡Ø°Ø§ ØªÙ… ØªÙˆÙ‚ÙŠØ¹ Ù‡Ø°Ø§ Ø§Ù„Ø¹Ù‚Ø¯ Ø¨Ù…ÙˆØ§ÙÙ‚Ø© Ø§Ù„Ø·Ø±ÙÙŠÙ†ØŒ ÙˆÙŠÙØ¹Ø¯ Ù†Ø§ÙØ°Ù‹Ø§ ÙˆÙ…Ù„Ø²Ù…Ù‹Ø§ Ù…Ù† ØªØ§Ø±ÙŠØ® Ø§Ø¹ØªÙ…Ø§Ø¯Ù‡.
`;


/* ================== English Text ================== */
const en = `
By the grace of God, this Annual Preventive Maintenance Agreement was executed on ${date} between:

First Party  
RKL Elevators & Escalators  
Commercial Registration No.: 1010709355  
VAT No.: 302250422600003  
Address: Al Sulaymaniyah â€“ Riyadh â€“ Saudi Arabia  
Tel: 0114774021  
Hereinafter referred to as the â€œFirst Partyâ€

Second Party  
Customer Name: ${customer.customer_name}  
Mobile No.: ${mobile}  
Address: ${address}  
Hereinafter referred to as the â€œSecond Partyâ€

### Preamble:
Whereas the Second Party desires to engage the First Party for annual preventive maintenance services for (${lifts}) passenger elevator(s),
Brand (${brand}), serving a (${buildingType}) building located in (${city}),
and whereas the First Party is a duly licensed and qualified elevator maintenance contractor,
the parties hereby agree as follows:

### Article (1): Scope of Agreement
The First Party shall provide preventive maintenance services in accordance with applicable safety standards and regulations of the Kingdom of Saudi Arabia.

### Article (2): Preventive Maintenance Services
Preventive maintenance services shall include, but not be limited to:
- Monthly inspection of all elevator components
- Cleaning and lubrication of mechanical parts
- Inspection of safety devices and control systems
- Functional testing of motors, brakes, ropes, and doors
- Issuance of technical observations and recommendations

### Article (3): Fault Reporting
The Second Party shall promptly notify the First Party of any abnormal operation or stoppage.

### Article (4): Emergency Response
The First Party shall respond to emergency breakdowns within a reasonable time depending on site location and fault nature.

### Article (5): Training
The First Party shall provide rescue procedure training to one or two building staff nominated by the Second Party.

### Article (6): Consumables
The First Party shall supply lubricants, grease, and cleaning materials required for preventive maintenance.

### Article (7): Spare Parts
Spare parts replacement is excluded from this contract and shall be quoted separately upon approval by the Second Party.

### Article (8): Contract Value
The total annual contract value is SAR ${calc.total.toFixed(2)}, inclusive of 15% VAT, excluding spare parts.

### Article (9): Contract Term
This Agreement shall be valid for one calendar year from the commencement date and shall be automatically renewed unless terminated by written notice at least sixty (60) days prior to expiry.

### Article (10): Payment Method
Payments shall be made via bank transfer to:
Bank: Saudi National Bank (SNB)  
Account Name: RKL  
IBAN: SA1710000001400005531406  

### Article (11): Suspension
The First Party reserves the right to suspend services in case of delayed payment without liability.

### Article (12): Limitation of Liability
The First Party shall not be liable for failures resulting from misuse, overloading, power outages, vandalism, force majeure events, or unauthorized third-party intervention.

### Article (13): Safety Compliance
The Second Party shall ensure a safe working environment in accordance with safety regulations.

### Article (14): Termination
Either party may terminate this Agreement with thirty (30) daysâ€™ prior written notice, subject to settlement of all outstanding dues.

### Article (15): Full Contract Value Entitlement
The Second Party hereby acknowledges and agrees that upon payment of any partial or initial amount under this Agreement, the full annual contract value shall become immediately due and payable to the First Party. Such payment shall constitute a final acknowledgment and commitment to the total contract value, and the Second Party shall not be entitled to cancel, reduce, or suspend the financial obligations under this Agreement for any reason after such payment.
### Article (16): Visits During Elevator Shutdown or Spare Parts Requirement
The Second Party acknowledges and agrees that any site visit carried out by the First Party shall be considered a completed preventive maintenance visit under the agreed schedule, even if the elevator is found to be out of service or requires spare parts replacement or additional works not covered under this Agreement.

The First Party shall not be obligated to conduct additional visits or resume maintenance works unless a separate quotation for the required spare parts or corrective works is approved. The performed visit shall be deemed valid, completed, and non-refundable.

### Article (17): Governing Law & Jurisdiction
This Agreement shall be governed by the laws of the Kingdom of Saudi Arabia, and the competent courts of Saudi Arabia shall have exclusive jurisdiction.

IN WITNESS WHEREOF, the parties have executed this Agreement as of the date first written above.
`;


  /* ================== Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù„ØºØ© ================== */
  if(lang === 'ar') return ar;
  if(lang === 'en') return en;
  return ar + '\n\n---------------------------------\n\n' + en;
}
const cityZones = {
  riyadh: {
    label: 'Ø§Ù„Ø±ÙŠØ§Ø¶',
    increase: 0
  },
  near: {
    label: 'Ù‚Ø±ÙŠØ¨Ø© Ù…Ù† Ø§Ù„Ø±ÙŠØ§Ø¶',
    increase: 0.05
  },
  medium: {
    label: 'Ù…ØªÙˆØ³Ø·Ø© Ø§Ù„Ø¨Ø¹Ø¯',
    increase: 0.10
  },
  far: {
    label: 'Ø¨Ø¹ÙŠØ¯Ø©',
    increase: 0.15
  },
  remote: {
    label: 'Ù†Ø§Ø¦ÙŠØ©',
    increase: 0.20
  }
};

  

function calculateTotal(){

  const capacityValue = document.getElementById('capacity')?.value || '';
  const floorsValue   = document.getElementById('floors')?.value || '';
  const liftsValue    = document.getElementById('lifts')?.value || '';

  if (!capacityValue || !floorsValue || !liftsValue) {
    return {
      pricePerLift: 0,
      lifts: 0,
      zone: 'â€”',
      subtotal: 0,
      vat: 0,
      total: 0
    };
  }

  let pricePerLift = Number(capacityValue);

  const lifts    = Number(liftsValue);
  const floors   = Number(floorsValue);
  const building = document.getElementById('building')?.value || 'private';

  const brandSelect = document.getElementById('brandSelect')?.value || '';
  const brandOther  = document.getElementById('brandOther')?.value || '';

  let brand = '';
  if (brandSelect === 'Local') {
    brand = 'local';
  } else if (brandSelect === 'Other') {
    brand = brandOther.trim().toLowerCase() || 'other';
  } else {
    brand = brandSelect.toLowerCase();
  }

  const cityKey = document.getElementById('projectCity')?.value || 'riyadh';
  const zone = cityZones[cityKey] || cityZones.riyadh;

  if (floors > 2) pricePerLift *= 1.10;
  if (building === 'government') pricePerLift *= 1.50;
  if (['otis','kone','mitsubishi','schindler'].includes(brand)) pricePerLift += 2000;

  pricePerLift *= (1 + zone.increase);

  let subtotal = pricePerLift * lifts;

  if (lifts >= 3) subtotal *= 0.90;

  const vat   = subtotal * 0.15;
  const total = subtotal + vat;

  return {
    pricePerLift,     // Ø±Ù‚Ù…
    lifts,
    zone: zone.label,
    subtotal,         // Ø±Ù‚Ù…
    vat,              // Ø±Ù‚Ù…
    total             // Ø±Ù‚Ù…
  };
}



function saveContract() {
  if (!customer) {
    alert('âš ï¸ ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø¹Ù…ÙŠÙ„ Ø£ÙˆÙ„Ø§Ù‹');
    return;
  }

  const serviceType = document.getElementById('serviceType')?.value || 'annual';

  // Ø­Ù‚ÙˆÙ„ Ù…Ø´ØªØ±ÙƒØ©
  const lifts = document.getElementById('lifts').value;
  const capacity = document.getElementById('capacity').value;
  const floors = document.getElementById('floors').value;

  if (!lifts || !capacity || !floors) {
    alert('âš ï¸ ÙŠØ±Ø¬Ù‰ ØªØ¹Ø¨Ø¦Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ØµØ§Ø¹Ø¯ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© (Ø¹Ø¯Ø¯ Ø§Ù„Ù…ØµØ§Ø¹Ø¯ØŒ Ø§Ù„Ø­Ù…ÙˆÙ„Ø©ØŒ Ø§Ù„Ø·ÙˆØ§Ø¨Ù‚)');
    return;
  }

  // ØªØ­Ù‚Ù‚ Ø­Ø³Ø¨ Ø§Ù„Ù†ÙˆØ¹
  if (serviceType === 'annual') {
    const lang = document.getElementById('lang').value;
    const date = document.getElementById('contractDate').value;
    if (!lang || !date) {
      alert('âš ï¸ ÙŠØ±Ø¬Ù‰ ØªØ¹Ø¨Ø¦Ø© (Ø§Ù„Ù„ØºØ© + ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¹Ù‚Ø¯) Ù„Ù„Ø¹Ù‚Ø¯ Ø§Ù„Ø³Ù†ÙˆÙŠ');
      return;
    }
  } else {
    const onceRequired = ['onceVisitType','onceDate','onceIssue','oncePrice'];
    for (const id of onceRequired) {
      if (!document.getElementById(id).value) {
        alert('âš ï¸ ÙŠØ±Ø¬Ù‰ ØªØ¹Ø¨Ø¦Ø© Ù…ØªØ·Ù„Ø¨Ø§Øª Ø§Ù„Ø²ÙŠØ§Ø±Ø© (Ù†ÙˆØ¹ Ø§Ù„Ø²ÙŠØ§Ø±Ø©ØŒ Ø§Ù„ØªØ§Ø±ÙŠØ®ØŒ Ø§Ù„ÙˆØµÙØŒ Ø³Ø¹Ø± Ø§Ù„Ø²ÙŠØ§Ø±Ø©)');
        return;
      }
    }
  }

  try {
    const calc = window.finalCalcOverride || calculateTotal();

    const contract = {
      id: (serviceType === 'once' ? 'VIS-' : 'PMC-') + Date.now(),
      serviceType,
      customer,
      lifts,

      total: calc.total.toFixed(2) + ' Ø±ÙŠØ§Ù„',
      pricing: {
        zone: calc.zone || 'â€”',
        pricePerLift: Number(calc.pricePerLift || 0),
        subtotal: Number(calc.subtotal || 0),
        vat: Number(calc.vat || 0),
        total: Number(calc.total || 0),
        isManual: !!calc.isManual
      },

      // Ø¨ÙŠØ§Ù†Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ© Ø­Ø³Ø¨ Ø§Ù„Ù†ÙˆØ¹
      lang: (serviceType === 'annual') ? document.getElementById('lang').value : 'ar',
      date: (serviceType === 'annual') ? document.getElementById('contractDate').value : document.getElementById('onceDate').value,

      onceDetails: (serviceType === 'once') ? {
        visitType: document.getElementById('onceVisitType').value,
        visitDate: document.getElementById('onceDate').value,
        urgency: document.getElementById('onceUrgency').value,
        stopped: document.getElementById('onceStopped').value,
        issue: document.getElementById('onceIssue').value,
        priceBeforeVat: Number(document.getElementById('oncePrice').value || 0)
      } : null,

      // Ø®Ù„ÙŠÙ‡ ÙÙ‚Ø· Ù„Ù„Ø³Ù†ÙˆÙŠ
      content: (serviceType === 'annual') ? generateFullContractText() : ''
    };

    const contracts = JSON.parse(localStorage.getItem('rkl_maintenance_contracts') || '[]');
    contracts.push(contract);
    localStorage.setItem('rkl_maintenance_contracts', JSON.stringify(contracts));

    renderContractsTable();
    alert('âœ… ØªÙ… Ø§Ù„Ø­ÙØ¸ Ø¨Ù†Ø¬Ø§Ø­ ÙˆØ¥Ø¶Ø§ÙØªÙ‡ Ù„Ù„Ø³Ø¬Ù„');
  } catch (error) {
    console.error(error);
    alert('âŒ Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø­ÙØ¸: ' + error.message);
  }
}

 


function openPrintView(contract){

  if(!contract || !contract.id){
    alert('Ø®Ø·Ø£: Ø±Ù‚Ù… Ø§Ù„Ø¹Ù‚Ø¯ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯');
    return;
  }

   const serviceType = contract.serviceType || 'annual'; // âœ… Ø£Ø¶Ù Ù‡Ø°Ø§
  const w = window.open('', '_blank');

  w.document.write(`
<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>${contract.id}</title>

<style>
/* =========================================================
   RKL Professional Contract Print Styles (A4) â€“ FINAL
   Content unchanged â€“ Styling only
========================================================= */

/* ---------- Print Color Accuracy ---------- */
*{
  -webkit-print-color-adjust: exact;
  print-color-adjust: exact;
}

/* ---------- Page Setup ---------- */
@page{
  size:A4;
  margin:16mm 14mm 18mm 14mm;
}

:root{
  --ink:#111827;
  --muted:#6b7280;
  --line:#e5e7eb;
  --soft:#f8fafc;
  --brand:#0f766e;
  --brand2:#115e59;
}

/* ---------- Base ---------- */
html,body{
  height:100%;
}

body{
  margin:0;
  background:#fff;
  color:var(--ink);
  font-family:"Cairo","Tajawal",Arial,sans-serif;
  font-size:14px;
  line-height:1.75;
}

/* Preserve text formatting */
.ar,.en,.contract{
  white-space:pre-wrap;
  word-break:break-word;
  overflow-wrap:anywhere;
}

/* ---------- Hide UI ---------- */
.editor-toolbar,
button{
  display:none!important;
}

/* ---------- Watermark ---------- */
body::before{
  content:"";
  position:fixed;
  inset:0;
  background:url('/public/images/logo.png') center center / 340px no-repeat;
  opacity:0.045;
  z-index:-1;
}

.print-watermark{ display:none!important }

/* ---------- Page Frame ---------- */
.page-frame{
  outline:1.5px solid var(--brand);
  outline-offset:-8px;
  padding:18px 20px;
  min-height:96vh;
}

/* ---------- Header ---------- */
.print-header{
  margin-bottom:16px;
  padding-bottom:12px;
  border-bottom:1px solid var(--line);
}

.print-header-row{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:14px;
}

.print-logo{
  width:46px;
}

.header-center{
  text-align:center;
  flex:1;
}

.header-center h1{
  margin:0;
  font-size:19px;
  font-weight:900;
  color:var(--brand);
  letter-spacing:.3px;
}

.header-center p{
  margin-top:4px;
  font-size:11.8px;
  color:var(--muted);
}

.header-meta{
  min-width:160px;
  font-size:11.5px;
  color:var(--muted);
}

.header-meta b{
  color:var(--ink);
  font-weight:700;
}

.header-meta div{
  margin-bottom:6px;
}

/* ---------- Contract Body ---------- */
.contract{
  font-size:13.8px;
}

.contract p{
  margin:6px 0;
}

/* Section titles */
.contract .section-title{
  margin:18px 0 8px;
  font-size:14.5px;
  font-weight:900;
  color:var(--brand);
}

/* Highlight client data */
.user-data{
  color:var(--brand2);
  font-weight:900;
}

/* ---------- Language Direction ---------- */
.ar{
  direction:rtl;
  text-align:right;
}

.en{
  direction:ltr;
  text-align:left;
  font-family:"Segoe UI",Arial,sans-serif;
  font-size:13.3px;
}

/* ---------- Divider ---------- */
hr{
  border:none;
  border-top:1px solid #cbd5e1;
  margin:18px 0;
}

/* ---------- Tables ---------- */
table{
  width:100%;
  border-collapse:collapse;
  margin:12px 0;
  font-size:13.4px;
}

.contract-summary{
  background:var(--soft);
  border:1px solid var(--line);
  border-radius:14px;
  padding:16px 18px;
  margin:18px 0 12px;
  page-break-inside:avoid;
}

.contract-summary h4{
  margin:0 0 12px;
  text-align:center;
  font-size:15px;
  font-weight:900;
  color:var(--brand);
  border-bottom:1px solid var(--line);
  padding-bottom:10px;
}

.contract-summary td{
  padding:9px 10px;
  vertical-align:top;
}

.contract-summary tr:not(:last-child){
  border-bottom:1px solid var(--line);
}

.contract-summary .label{
  color:var(--muted);
}

.contract-summary .value{
  font-weight:800;
  color:var(--ink);
}

.contract-summary .total{
  font-size:15px;
  font-weight:900;
  color:var(--brand);
}

/* User info table */
.user-data-table{
  width:100%;
  margin:16px 0;
  background:#fafafa;
}

.user-data-table td{
  padding:10px;
  border:1px solid var(--line);
}

/* ---------- Footer ---------- */
.print-footer{
  position:fixed;
  bottom:9mm;
  left:0;
  right:0;
  text-align:center;
  font-size:10.5px;
  color:var(--muted);
}

/* ---------- Page Break ---------- */
.page-break{
  break-before:page;
  margin:0;
  padding:0;
}

/* ---------- Signature ---------- */
.signature{
  margin-top:34px;
  display:flex;
  justify-content:space-between;
  gap:24px;
  page-break-inside:avoid;
}

.signature div{
  width:48%;
  border-top:1.5px solid var(--ink);
  padding-top:12px;
  text-align:center;
  font-size:13px;
  font-weight:600;
}

/* ---------- Print Safety ---------- */
.contract,.ar,.en{
  orphans:3;
  widows:3;
}
</style>



</head>

<body>
<div class="print-footer" data-contract="${contract.id}"></div>

<div class="editor-toolbar">
  <button onclick="format('bold')"><b>B</b></button>
  <button onclick="format('italic')"><i>I</i></button>
  <button onclick="format('underline')"><u>U</u></button>

  <select onchange="format('foreColor', this.value)">
    <option value="">Ù„ÙˆÙ† Ø§Ù„Ù†Øµ</option>
    <option value="#2563eb">Ø£Ø²Ø±Ù‚</option>
    <option value="#dc2626">Ø£Ø­Ù…Ø±</option>
    <option value="#16a34a">Ø£Ø®Ø¶Ø±</option>
    <option value="#000000">Ø£Ø³ÙˆØ¯</option>
  </select>

  <select onchange="format('fontSize', this.value)">
    <option value="">Ø­Ø¬Ù… Ø§Ù„Ø®Ø·</option>
    <option value="3">ØµØºÙŠØ±</option>
    <option value="4">Ø¹Ø§Ø¯ÙŠ</option>
    <option value="5">ÙƒØ¨ÙŠØ±</option>
    <option value="6">ÙƒØ¨ÙŠØ± Ø¬Ø¯Ù‹Ø§</option>
  </select>
</div>
<div class="page-frame">
  <div id="editableContent" contenteditable="true" class="contract">
<!-- ================== Cover Page ================== -->
<div class="page-frame" style="page-break-after:always">

  <div style="text-align:center;margin-top:120px">
    <img src="/public/images/logo.png" style="width:90px;margin-bottom:20px">
    
    <h1 style="font-size:26px;color:#0f766e;margin:0">
      Ø¹Ù‚Ø¯ ØµÙŠØ§Ù†Ø© ÙˆÙ‚Ø§Ø¦ÙŠØ© Ø³Ù†ÙˆÙŠ Ù„Ù„Ù…ØµØ§Ø¹Ø¯
    </h1>

    <div style="width:140px;height:3px;background:#0f766e;margin:20px auto"></div>

    <p style="font-size:15px">
      Ø¨ÙŠÙ†<br>
      <b>Ù…Ø¤Ø³Ø³Ø© Ø¢Ø± ÙƒÙŠ Ø§Ù„ RKL Ù„Ù„Ù…ØµØ§Ø¹Ø¯ ÙˆØ§Ù„Ø³Ù„Ø§Ù„Ù… Ø§Ù„ÙƒÙ‡Ø±Ø¨Ø§Ø¦ÙŠØ©</b><br>
      Ùˆ<br>
      <b>${contract.customer.customer_name || 'â€”'}</b>
    </p>

    <div style="margin-top:40px;font-size:14px">
      <p><b>Ø±Ù‚Ù… Ø§Ù„Ø¹Ù‚Ø¯:</b> ${contract.id}</p>
      <p><b>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¹Ù‚Ø¯:</b> ${contract.date}</p>
    </div>
  </div>

</div>

<div class="print-header">
  <div class="print-header-row">

   <img src="/public/images/logo.png" class="print-watermark">


    <div class="header-center">
      <h1>${serviceType === 'once' ? 'Ø¹Ø±Ø¶ Ø³Ø¹Ø± Ø²ÙŠØ§Ø±Ø© Ù„Ù…Ø±Ø© ÙˆØ§Ø­Ø¯Ø©' : 'Ø¹Ø±Ø¶ Ø³Ø¹Ø± ØµÙŠØ§Ù†Ø© ÙˆÙ‚Ø§Ø¦ÙŠØ© Ù„Ù„Ù…ØµØ§Ø¹Ø¯'}</h1>

      <p>Ø¢Ø± ÙƒÙŠ Ø§Ù„ RKL Ù„Ù„Ù…ØµØ§Ø¹Ø¯ ÙˆØ§Ù„Ø³Ù„Ø§Ù„Ù… Ø§Ù„ÙƒÙ‡Ø±Ø¨Ø§Ø¦ÙŠØ©</p>
      <p class="small">Ø§Ù„Ø³Ø¬Ù„ Ø§Ù„ØªØ¬Ø§Ø±ÙŠ: 1010709355 | Ù‡Ø§ØªÙ: 0114774021</p>
    </div>

    <div class="header-meta">
      <div><b>Ø±Ù‚Ù… Ø§Ù„Ø¹Ù‚Ø¯:</b><br>${contract.id}</div>
      <div><b>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¹Ù‚Ø¯:</b><br>${contract.date}</div>
    </div>

  </div>
</div>


${
  contract.lang === 'en'
    ? `<div class="en">${contract.content}</div>`
    : contract.lang === 'ar'
      ? `<div class="ar">${contract.content}</div>`
      : `
        <div class="ar">
          ${contract.content.split('---------------------------------')[0].replace(/\n/g,'<br>')}
        </div>
        <hr>
        <div class="en">
          ${contract.content.split('---------------------------------')[1].replace(/\n/g,'<br>')}
        </div>
      `
}

</div>


<div class="signature">
  <div>ØªÙˆÙ‚ÙŠØ¹ Ø§Ù„Ø·Ø±Ù Ø§Ù„Ø£ÙˆÙ„</div>
  <div>ØªÙˆÙ‚ÙŠØ¹ Ø§Ù„Ø·Ø±Ù Ø§Ù„Ø«Ø§Ù†ÙŠ</div>
</div>
</div>
<br>
<button onclick="window.print()">ğŸ–¨ï¸ Ø·Ø¨Ø§Ø¹Ø© Ø§Ù„Ø¹Ù‚Ø¯</button>



</body>
</html>
  `);

  w.document.close();
}

function openAnnualContractOfferPrint(contract){

  if(!contract || contract.serviceType !== 'annual'){
    alert('âŒ Ù‡Ø°Ø§ Ù„ÙŠØ³ Ø¹Ù‚Ø¯ ØµÙŠØ§Ù†Ø© Ø³Ù†ÙˆÙŠ');
    return;
  }

  const calc = contract.pricing;
  const customer = contract.customer || {};
  const refNo = contract.id;
  const date  = contract.date;

  const visits =
    document.getElementById('visits')?.value === 'monthly'
      ? '12 Ø²ÙŠØ§Ø±Ø© (Ø²ÙŠØ§Ø±Ø© Ø´Ù‡Ø±ÙŠØ©)'
      : '6 Ø²ÙŠØ§Ø±Ø§Øª (ÙƒÙ„ Ø´Ù‡Ø±ÙŠÙ†)';

  const emergency =
    document.getElementById('emergency')?.value === 'extended'
      ? 'Ø®Ø¯Ù…Ø© Ø·ÙˆØ§Ø±Ø¦ Ø®Ø§Ø±Ø¬ Ø£ÙˆÙ‚Ø§Øª Ø§Ù„Ø¯ÙˆØ§Ù…'
      : 'Ø®Ø¯Ù…Ø© Ø·ÙˆØ§Ø±Ø¦ Ø®Ù„Ø§Ù„ Ø£ÙˆÙ‚Ø§Øª Ø§Ù„Ø¯ÙˆØ§Ù…';

  const spareParts =
    document.getElementById('spareParts')?.value === 'included'
      ? 'Ù‚Ø·Ø¹ Ø§Ù„ØºÙŠØ§Ø± Ù…Ø´Ù…ÙˆÙ„Ø© (Ø¨Ø¹Ø±Ø¶ Ø®Ø§Øµ)'
      : 'Ù‚Ø·Ø¹ Ø§Ù„ØºÙŠØ§Ø± ØºÙŠØ± Ù…Ø´Ù…ÙˆÙ„Ø©';

  const training =
    document.getElementById('training')?.value === 'yes'
      ? 'ÙŠØ´Ù…Ù„ ØªØ¯Ø±ÙŠØ¨ Ø¥Ù†Ù‚Ø§Ø° Ù…Ø­ØªØ¬Ø²ÙŠÙ†'
      : 'Ù„Ø§ ÙŠØ´Ù…Ù„ ØªØ¯Ø±ÙŠØ¨';

  const w = window.open('', '_blank');

  w.document.write(`
<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>Ø¹Ø±Ø¶ Ø³Ø¹Ø± Ø¹Ù‚Ø¯ ØµÙŠØ§Ù†Ø© ÙˆÙ‚Ø§Ø¦ÙŠØ© Ø³Ù†ÙˆÙŠ</title>

<style>
@page{size:A4;margin:15mm}
body{
  font-family:"Cairo","Tajawal",Arial;
  font-size:14px;
  color:#111;
}
.header{
  display:flex;
  justify-content:space-between;
  align-items:center;
  border-bottom:2px solid #0f766e;
  padding-bottom:10px;
}
.header img{width:45px}
.header h1{margin:0;color:#0f766e;font-size:20px}

.section{margin-top:22px}
.section h3{
  margin-bottom:10px;
  color:#0f766e;
  border-bottom:1px solid #e5e7eb;
  padding-bottom:6px;
}

table{
  width:100%;
  border-collapse:collapse;
  margin-top:10px;
}
td,th{
  border:1px solid #e5e7eb;
  padding:8px;
}
th{background:#f0fdfa}

.footer{
  margin-top:40px;
  text-align:center;
  font-size:12px;
  color:#555;
}
</style>
</head>

<body>

<div class="header">
  <img src="/public/images/logo.png">
  <h1>Ø¹Ø±Ø¶ Ø³Ø¹Ø± Ø¹Ù‚Ø¯ ØµÙŠØ§Ù†Ø© ÙˆÙ‚Ø§Ø¦ÙŠØ© Ø³Ù†ÙˆÙŠ</h1>
</div>

<div class="section">
  <b>Ø§Ù„Ø¹Ù…ÙŠÙ„:</b> ${customer.customer_name || 'â€”'}<br>
  <b>Ø±Ù‚Ù… Ø§Ù„Ø¹Ø±Ø¶:</b> ${refNo}<br>
  <b>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¹Ø±Ø¶:</b> ${date}
</div>

<div class="section">
  <h3>ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…ØµØ§Ø¹Ø¯</h3>
  <table>
    <tr>
      <th>Ø¹Ø¯Ø¯ Ø§Ù„Ù…ØµØ§Ø¹Ø¯</th>
      <th>Ù†ÙˆØ¹ Ø§Ù„Ø®Ø¯Ù…Ø©</th>
      <th>Ù…Ø¯Ø© Ø§Ù„Ø¹Ù‚Ø¯</th>
    </tr>
    <tr>
      <td>${contract.lifts}</td>
      <td>ØµÙŠØ§Ù†Ø© ÙˆÙ‚Ø§Ø¦ÙŠØ© Ø³Ù†ÙˆÙŠØ©</td>
      <td>Ø³Ù†Ø© ÙˆØ§Ø­Ø¯Ø©</td>
    </tr>
  </table>
</div>

<div class="section">
  <h3>Ù†Ø·Ø§Ù‚ Ø§Ù„ØµÙŠØ§Ù†Ø© Ø§Ù„Ù…Ø´Ù…ÙˆÙ„Ø©</h3>
  <table>
    <tr><th>Ø§Ù„Ø¨Ù†Ø¯</th><th>Ø§Ù„ØªÙØ§ØµÙŠÙ„</th></tr>
    <tr><td>Ø¹Ø¯Ø¯ Ø§Ù„Ø²ÙŠØ§Ø±Ø§Øª</td><td>${visits}</td></tr>
    <tr><td>Ø®Ø¯Ù…Ø© Ø§Ù„Ø·ÙˆØ§Ø±Ø¦</td><td>${emergency}</td></tr>
    <tr><td>Ù‚Ø·Ø¹ Ø§Ù„ØºÙŠØ§Ø±</td><td>${spareParts}</td></tr>
    <tr><td>Ø§Ù„ØªØ¯Ø±ÙŠØ¨</td><td>${training}</td></tr>
  </table>
</div>

<div class="section">
  <h3>Ø§Ù„Ù…Ù„Ø®Øµ Ø§Ù„Ù…Ø§Ù„ÙŠ</h3>
  <table>
    <tr>
      <th>Ø§Ù„Ù‚ÙŠÙ…Ø© Ù‚Ø¨Ù„ Ø§Ù„Ø¶Ø±ÙŠØ¨Ø©</th>
      <th>Ø¶Ø±ÙŠØ¨Ø© 15%</th>
      <th>Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø´Ø§Ù…Ù„ Ø§Ù„Ø¶Ø±ÙŠØ¨Ø©</th>
    </tr>
    <tr>
      <td>${calc.subtotal.toFixed(2)} Ø±ÙŠØ§Ù„</td>
      <td>${calc.vat.toFixed(2)} Ø±ÙŠØ§Ù„</td>
      <td><b>${calc.total.toFixed(2)} Ø±ÙŠØ§Ù„</b></td>
    </tr>
  </table>
</div>

<div class="section">
  <h3>Ù…Ù„Ø§Ø­Ø¸Ø§Øª ÙˆØ´Ø±ÙˆØ·</h3>
  <p>
    Ù‡Ø°Ø§ Ø§Ù„Ø¹Ø±Ø¶ Ø®Ø§Øµ Ø¨Ø¹Ù‚Ø¯ ØµÙŠØ§Ù†Ø© ÙˆÙ‚Ø§Ø¦ÙŠØ© Ø³Ù†ÙˆÙŠØŒ ÙˆÙ„Ø§ ÙŠØ´Ù…Ù„ Ù‚Ø·Ø¹ Ø§Ù„ØºÙŠØ§Ø±
    Ø¥Ù„Ø§ Ø¨Ø¹Ø±Ø¶ Ø³Ø¹Ø± Ù…Ø³ØªÙ‚Ù„ ÙˆÙ…Ø¹ØªÙ…Ø¯.  
    Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø²ÙŠØ§Ø±Ø§Øª ØªÙØ­ØªØ³Ø¨ Ø¶Ù…Ù† Ø§Ù„Ø¹Ù‚Ø¯ Ø­ØªÙ‰ ÙÙŠ Ø­Ø§Ù„ ØªÙˆÙ‚Ù Ø§Ù„Ù…ØµØ¹Ø¯.
  </p>
</div>

<div class="footer">
  Ù…Ø¤Ø³Ø³Ø© Ø¢Ø± ÙƒÙŠ Ø§Ù„ RKL Ù„Ù„Ù…ØµØ§Ø¹Ø¯ ÙˆØ§Ù„Ø³Ù„Ø§Ù„Ù… Ø§Ù„ÙƒÙ‡Ø±Ø¨Ø§Ø¦ÙŠØ©<br>
  Ø³.Øª: 1010709355 â€“ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø¶Ø±ÙŠØ¨ÙŠ: 302250422600003
</div>

<br>
<button onclick="window.print()">ğŸ–¨ï¸ Ø·Ø¨Ø§Ø¹Ø© Ø¹Ø±Ø¶ Ø§Ù„Ø³Ø¹Ø±</button>

</body>
</html>
  `);

  w.document.close();
}


  
function getBrandValue(){
  const brandSelect = document.getElementById('brandSelect').value;
  const brandOther  = document.getElementById('brandOther')?.value || '';

  if (brandSelect === 'Local') return 'local';
  if (brandSelect === 'Other') return brandOther.trim().toLowerCase() || 'other';

  return brandSelect.toLowerCase();
}

function renderContractsTable(){
  const annualTbody = document.getElementById('annualContractsTable');
  const onceTbody   = document.getElementById('onceVisitsTable');
  if (!annualTbody || !onceTbody) return;

  const items = JSON.parse(localStorage.getItem('rkl_maintenance_contracts') || '[]');

  annualTbody.innerHTML = '';
  onceTbody.innerHTML = '';

  let annualIndex = 0;
  let onceIndex = 0;

  items.forEach((c, i) => {

    // Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„ (ÙŠØ¯Ø¹Ù… Object Ø£Ùˆ Ù†Øµ Ù‚Ø¯ÙŠÙ…)
    let customerName = 'â€”';
    let customerCity = '';
    if (typeof c.customer === 'object' && c.customer !== null) {
      customerName = c.customer.customer_name || c.customer.name || 'â€”';
      customerCity = c.customer.city ? ` - ${c.customer.city}` : '';
    } else if (typeof c.customer === 'string') {
      customerName = c.customer;
    }

    const serviceType = c.serviceType || 'annual';

    // =======================
    // (Ø£) Ø§Ù„Ø¹Ù‚ÙˆØ¯ Ø§Ù„Ø³Ù†ÙˆÙŠØ© ÙÙ‚Ø·
    // Ø´Ø±Ø·Ù†Ø§ Ù‡Ù†Ø§: annual + ÙÙŠÙ‡ content (ÙŠØ¹Ù†ÙŠ Ø¹Ù‚Ø¯ ÙØ¹Ù„ÙŠ)
    // =======================
    if(serviceType === 'annual' && c.content){
      annualIndex++;

      const row = document.createElement('tr');
      row.innerHTML = `
        <td>${annualIndex}</td>
        <td>${c.id || 'â€”'}</td>
        <td>
          <strong>${customerName}</strong>
          <div style="font-size:12px;color:#6b7280">${customerCity}</div>
        </td>
        <td>${c.lifts || 'â€”'}</td>
        <td>${c.total || 'â€”'}</td>
        <td>${c.lang || 'â€”'}</td>
        <td>${c.date || 'â€”'}</td>
      <td>
  <button type="button" class="print-annual" data-index="${i}">Ø·Ø¨Ø§Ø¹Ø© Ø§Ù„Ø¹Ù‚Ø¯</button>

  <!-- âœ… Ø²Ø± Ø¹Ø±Ø¶ Ø§Ù„Ø³Ø¹Ø± Ø¯Ø§Ø®Ù„ Ø¬Ø¯ÙˆÙ„ (Ø£) -->
  <button type="button" class="print-annual-offer" data-index="${i}">
    ğŸ–¨ï¸ Ø·Ø¨Ø§Ø¹Ø© Ø¹Ø±Ø¶ Ø³Ø¹Ø± Ø§Ù„Ø¹Ù‚Ø¯
  </button>
</td>

      `;
      annualTbody.appendChild(row);
      return;
    }

    // =======================
    // (Ø¨) Ø§Ù„Ø²ÙŠØ§Ø±Ø§Øª Ù„Ù…Ø±Ø© ÙˆØ§Ø­Ø¯Ø©
    // =======================
    if(serviceType === 'once'){
      onceIndex++;

      const vt = c.onceDetails?.visitType || 'â€”';
      const vtLabel =
        vt === 'inspection' ? 'ÙØ­Øµ ÙˆØªØ´Ø®ÙŠØµ' :
        vt === 'repair'     ? 'ØµÙŠØ§Ù†Ø©/Ø¥ØµÙ„Ø§Ø­' :
        vt === 'rescue'     ? 'Ø§Ø­ØªØ¬Ø§Ø²/Ø¥Ù†Ù‚Ø§Ø°' : 'â€”';

      const row = document.createElement('tr');
      row.innerHTML = `
        <td>${onceIndex}</td>
        <td>${c.id || 'â€”'}</td>
        <td>
          <strong>${customerName}</strong>
          <div style="font-size:12px;color:#6b7280">${customerCity}</div>
        </td>
        <td>${c.lifts || 'â€”'}</td>
        <td>${c.total || 'â€”'}</td>
        <td>${c.date || 'â€”'}</td>
        <td>${vtLabel}</td>
        <td>
          <button type="button" class="print-once-offer" data-index="${i}">Ø·Ø¨Ø§Ø¹Ø© Ø¹Ø±Ø¶ Ø§Ù„Ø³Ø¹Ø±</button>
        </td>
      `;
      onceTbody.appendChild(row);
      return;
    }

    // Ø¥Ø°Ø§ Ø¹Ù†Ø¯Ùƒ Ø¨ÙŠØ§Ù†Ø§Øª Ù‚Ø¯ÙŠÙ…Ø© annual Ø¨Ø¯ÙˆÙ† contentØŒ ØªØ¬Ø§Ù‡Ù„Ù‡Ø§ Ø£Ùˆ Ù„Ø§Ø­Ù‚Ø§Ù‹ Ù†Ø±ØªÙ‘Ø¨Ù‡Ø§
  });

  // Ø±Ø¨Ø· Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø·Ø¨Ø§Ø¹Ø© Ù„Ù„Ø¹Ù‚ÙˆØ¯ Ø§Ù„Ø³Ù†ÙˆÙŠØ©
  document.querySelectorAll('.print-annual').forEach(btn => {
    btn.onclick = function(){
      const idx = Number(this.getAttribute('data-index'));
      openPrintView(items[idx]); // Ù†ÙØ³ Ø§Ù„Ø·Ø¨Ø§Ø¹Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ©
    };
  });
document.querySelectorAll('.print-annual-offer').forEach(btn => {
  btn.onclick = function(){
    const idx = Number(this.getAttribute('data-index'));
    openAnnualContractOfferPrint(items[idx]);
  };
});


  // Ø±Ø¨Ø· Ø£Ø²Ø±Ø§Ø± Ø·Ø¨Ø§Ø¹Ø© Ø¹Ø±Ø¶ Ø³Ø¹Ø± Ø§Ù„Ø²ÙŠØ§Ø±Ø©
  document.querySelectorAll('.print-once-offer').forEach(btn => {
    btn.onclick = function(){
      const idx = Number(this.getAttribute('data-index'));
      // Ù‡Ù†Ø§ Ø³Ù†Ø·Ø¨Ø¹ "Ø¹Ø±Ø¶ Ø§Ù„Ø³Ø¹Ø±" Ù„Ù„Ø²ÙŠØ§Ø±Ø©
      // Ø§Ø³ØªØ®Ø¯Ù… Ù†ÙØ³ printOfferFromPreview Ø¥Ø°Ø§ Ø¨Ø¯ÙƒØŒ Ø£Ùˆ Ù†Ø¬Ù‡Ø² Print View Ø®Ø§Øµ Ù„Ù„Ø²ÙŠØ§Ø±Ø© Ù„Ø§Ø­Ù‚Ù‹Ø§
      openPrintView(items[idx]); // Ù…Ø¤Ù‚ØªØ§Ù‹ Ù†ÙØ³ Ø§Ù„Ø¯Ø§Ù„Ø© (ÙˆØ³Ù†Ø¹Ø¯Ù„Ù‡Ø§ Ø¨Ø§Ù„Ø®Ø·ÙˆØ© Ø§Ù„ØªØ§Ù„ÙŠØ©)
    };
  });
}


document.addEventListener('DOMContentLoaded', renderContractsTable);


function reviewContract(){
  const required=['lang','contractDate','lifts','capacity','floors'];
  for(const id of required){
    if(!document.getElementById(id).value){
      alert('ÙŠØ±Ø¬Ù‰ ØªØ¹Ø¨Ø¦Ø© Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ø¥Ù„Ø²Ø§Ù…ÙŠØ©');
      return;
    }
  }

  let price=Number(document.getElementById('capacity').value);
  const lifts=Number(document.getElementById('lifts').value);
  const floors=Number(document.getElementById('floors').value);
  const building=document.getElementById('building').value;
  const brandSelect = document.getElementById('brandSelect').value || '';
const brandOther  = document.getElementById('brandOther')?.value || '';
const brand = (brandSelect === 'Other' || brandSelect === 'Local')
  ? brandOther.toLowerCase()
  : brandSelect.toLowerCase();


  if(floors>2) price*=1.10;
  if(building==='government') price*=1.50;
  if(['otis','kone','mitsubishi','schindler'].some(b=>brand.includes(b))){
    price+=2000;
  }

  const vat=price*lifts*0.15;
  const total=price*lifts+vat;
  const calc = calculateTotal();


  document.getElementById('reviewBox').innerHTML=`
    <p><b>Ø¹Ø¯Ø¯ Ø§Ù„Ù…ØµØ§Ø¹Ø¯:</b> ${lifts}</p>
    <p><b>Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹:</b> ${calc.zone}</p>
    <p><b>Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ø³Ù†ÙˆÙŠ Ù„Ù„Ù…ØµØ¹Ø¯:</b> ${price.toFixed(2)} Ø±ÙŠØ§Ù„</p>
    <p><b>Ø¶Ø±ÙŠØ¨Ø© Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ù…Ø¶Ø§ÙØ© 15%:</b> ${vat.toFixed(2)} Ø±ÙŠØ§Ù„</p>
    <p><b>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ù‚ÙŠÙ…Ø© Ø§Ù„Ø¹Ù‚Ø¯:</b> <strong>${total.toFixed(2)} Ø±ÙŠØ§Ù„</strong></p>
    <p><b>Ù…Ù„Ø§Ø­Ø¸Ø§Øª:</b> ${document.getElementById('notes').value||'â€”'}</p>
  `;

  document.getElementById('reviewSection').style.display='block';
}
</script>

  <script>
function toggleOtherBrand(){
  const select = document.getElementById('brandSelect').value;
  document.getElementById('otherBrandBox').style.display =
    (select === 'Other') ? 'block' : 'none';
}

    function numberToArabicWords(num){
  return num.toLocaleString('ar-SA');
}

</script>
<script>
window.manualPricePerLift = null; // Ø³Ø¹Ø± ÙŠØ¯ÙˆÙŠ Ù„Ù„Ù…ØµØ¹Ø¯ (Ù‚Ø¨Ù„ Ø§Ù„Ø®ØµÙˆÙ…Ø§Øª ÙˆØ§Ù„Ù…Ù†Ø·Ù‚Ø© Ø¥Ù„Ø®)
window.finalCalcOverride = null;  // Ù†ØªÙŠØ¬Ø© Ø­Ø³Ø§Ø¨ Ù†Ù‡Ø§Ø¦ÙŠØ© Ø¨Ø¹Ø¯ ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… (Ù„Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø¨Ø§Ù„Ø­ÙØ¸)
</script>
<script>
function fmt(n){
  return (Number(n || 0)).toFixed(2);
}

function recomputeFromManual(){
  const lifts = Number(document.getElementById('lifts').value || 0);
  if(!lifts) return;

  // Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ø³Ø¹Ø± Ø§Ù„ÙŠØ¯ÙˆÙŠ Ù„Ù„Ù…ØµØ¹Ø¯ Ù…Ù† Ø§Ù„Ø­Ù‚Ù„
  const v = Number(document.getElementById('manualPricePerLift')?.value || 0);
  if(!v || v <= 0){
    // Ø±Ø¬Ù‘Ø¹ Ù„Ù„Ø­Ø³Ø¨Ø© Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠØ© Ù„Ùˆ ÙØ§Ø¶ÙŠ Ø£Ùˆ ØµÙØ±
    window.manualPricePerLift = null;
    const calc = calculateTotal();
    window.finalCalcOverride = calc;
    paintPreview(calc, false);
    return;
  }

  window.manualPricePerLift = v;

  // âœ… Ù‡Ù†Ø§ Ù†Ø·Ø¨Ù‘Ù‚ Ù†ÙØ³ Ù…Ù†Ø·Ù‚ Ø§Ù„Ø®ØµÙˆÙ…Ø§Øª (3 Ù…ØµØ§Ø¹Ø¯ Ø®ØµÙ… 10%) + Ø§Ù„Ø¶Ø±ÙŠØ¨Ø©
  let subtotal = v * lifts;

  if (lifts >= 3) subtotal *= 0.90; // Ø®ØµÙ… 10%

  const vat = subtotal * 0.15;
  const total = subtotal + vat;

  const calc = {
    pricePerLift: v,
    lifts,
    zone: (cityZones[document.getElementById('projectCity')?.value || 'riyadh']?.label) || 'â€”',
    subtotal,
    vat,
    total,
    isManual: true
  };

  window.finalCalcOverride = calc;
  paintPreview(calc, true);
}

function paintPreview(calc, isManual){
  document.getElementById('reviewBox').innerHTML = `
    <div class="contract-summary">
      <h4>Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„ØªØ³Ø¹ÙŠØ± Ù‚Ø¨Ù„ Ø§Ù„Ø§Ø¹ØªÙ…Ø§Ø¯</h4>
      <table>
        <tr>
          <td class="label">Ø¹Ø¯Ø¯ Ø§Ù„Ù…ØµØ§Ø¹Ø¯</td>
          <td class="value">${calc.lifts}</td>
        </tr>
        <tr>
          <td class="label">Ø§Ù„Ù…Ù†Ø·Ù‚Ø©</td>
          <td class="value">${calc.zone}</td>
        </tr>
        <tr>
          <td class="label">Ø§Ù„Ø³Ø¹Ø± Ù„Ù„Ù…ØµØ¹Ø¯ (Ù‚Ø§Ø¨Ù„ Ù„Ù„ØªØ¹Ø¯ÙŠÙ„)</td>
          <td class="value">
            <input
              id="manualPricePerLift"
              type="number"
              min="0"
              step="0.01"
              style="width:180px;text-align:left"
              value="${fmt(calc.pricePerLift)}"
              oninput="recomputeFromManual()"
            />
            <div style="font-size:12px;color:#6b7280;margin-top:4px">
              ${isManual ? 'âœ… ØªÙ… Ø§Ø¹ØªÙ…Ø§Ø¯ Ø³Ø¹Ø± ÙŠØ¯ÙˆÙŠØŒ ÙˆØ³ÙŠØªÙ… Ø§Ù„Ø­ÙØ¸ Ø¹Ù„ÙŠÙ‡.' : 'â„¹ï¸ Ù‡Ø°Ø§ Ø³Ø¹Ø± Ù…Ø­Ø³ÙˆØ¨ ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§ØŒ ÙˆÙŠÙ…ÙƒÙ†Ùƒ ØªØ¹Ø¯ÙŠÙ„Ù‡.'}
            </div>
          </td>
        </tr>
        <tr>
          <td class="label">Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ù‚Ø¨Ù„ Ø§Ù„Ø¶Ø±ÙŠØ¨Ø©</td>
          <td class="value"><span id="pv_subtotal">${fmt(calc.subtotal)}</span> Ø±ÙŠØ§Ù„</td>
        </tr>
        <tr>
          <td class="label">Ø¶Ø±ÙŠØ¨Ø© Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ù…Ø¶Ø§ÙØ© (15%)</td>
          <td class="value"><span id="pv_vat">${fmt(calc.vat)}</span> Ø±ÙŠØ§Ù„</td>
        </tr>
        <tr>
          <td class="label total">Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø´Ø§Ù…Ù„ Ø§Ù„Ø¶Ø±ÙŠØ¨Ø©</td>
          <td class="value total"><span id="pv_total">${fmt(calc.total)}</span> Ø±ÙŠØ§Ù„</td>
        </tr>
      </table>

      <p class="words">
        âš ï¸ Ø§Ù„Ù…Ø¹Ø§ÙŠÙ†Ø© Ù‚Ø¨Ù„ Ø§Ù„Ø§Ø¹ØªÙ…Ø§Ø¯. ÙŠÙ…ÙƒÙ†Ùƒ ØªØ¹Ø¯ÙŠÙ„ Ø³Ø¹Ø± Ø§Ù„Ù…ØµØ¹Ø¯ Ù…Ù† Ø§Ù„Ø¬Ø¯ÙˆÙ„ ÙˆØ³ÙŠØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§.
      </p>
    </div>
  `;
}

function previewPricing(){

  const serviceType = document.getElementById('serviceType')?.value || 'annual';

  // Ø­Ù‚ÙˆÙ„ Ù…Ø´ØªØ±ÙƒØ© (Ø¹Ù…ÙŠÙ„ + Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ØµØ§Ø¹Ø¯ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©)
  const baseRequired = ['lifts','capacity','floors'];
  for(const id of baseRequired){
    if(!document.getElementById(id).value){
      alert('âš ï¸ ÙŠØ±Ø¬Ù‰ ØªØ¹Ø¨Ø¦Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ØµØ§Ø¹Ø¯ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© (Ø¹Ø¯Ø¯ Ø§Ù„Ù…ØµØ§Ø¹Ø¯ØŒ Ø§Ù„Ø­Ù…ÙˆÙ„Ø©ØŒ Ø§Ù„Ø·ÙˆØ§Ø¨Ù‚)');
      return;
    }
  }

  // ØªØ­Ù‚Ù‚ Ø­Ø³Ø¨ Ø§Ù„Ù†ÙˆØ¹
  if(serviceType === 'annual'){
    const annualRequired = ['lang','contractDate'];
    for(const id of annualRequired){
      if(!document.getElementById(id).value){
        alert('âš ï¸ ÙŠØ±Ø¬Ù‰ ØªØ¹Ø¨Ø¦Ø© (Ù„ØºØ© Ø§Ù„Ø¹Ù‚Ø¯ + ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¹Ù‚Ø¯) Ù„Ø¹Ø±Ø¶ Ø­Ø³Ø¨Ø© Ø§Ù„Ø¹Ù‚Ø¯ Ø§Ù„Ø³Ù†ÙˆÙŠ');
        return;
      }
    }

    const calc = calculateTotal();
    window.manualPricePerLift = null;
    window.finalCalcOverride = calc;
    paintPreview(calc, false);

  } else {
    // Ø²ÙŠØ§Ø±Ø© Ù„Ù…Ø±Ø© ÙˆØ§Ø­Ø¯Ø©
    const onceRequired = ['onceVisitType','onceDate','onceIssue','oncePrice'];
    for(const id of onceRequired){
      if(!document.getElementById(id).value){
        alert('âš ï¸ ÙŠØ±Ø¬Ù‰ ØªØ¹Ø¨Ø¦Ø© Ù…ØªØ·Ù„Ø¨Ø§Øª Ø§Ù„Ø²ÙŠØ§Ø±Ø© (Ù†ÙˆØ¹ Ø§Ù„Ø²ÙŠØ§Ø±Ø©ØŒ Ø§Ù„ØªØ§Ø±ÙŠØ®ØŒ Ø§Ù„ÙˆØµÙØŒ Ø³Ø¹Ø± Ø§Ù„Ø²ÙŠØ§Ø±Ø©)');
        return;
      }
    }

    const lifts = Number(document.getElementById('lifts').value || 0);
    const priceBeforeVat = Number(document.getElementById('oncePrice').value || 0);

    const subtotal = priceBeforeVat;       // Ø²ÙŠØ§Ø±Ø© ÙˆØ§Ø­Ø¯Ø©: Ø§Ù„Ù…Ø¨Ù„Øº Ù‚Ø¨Ù„ Ø§Ù„Ø¶Ø±ÙŠØ¨Ø©
    const vat = subtotal * 0.15;
    const total = subtotal + vat;

    const calc = {
      pricePerLift: (subtotal / Math.max(lifts,1)), // ÙÙ‚Ø· Ù„Ù„Ø¹Ø±Ø¶
      lifts,
      zone: (cityZones[document.getElementById('projectCity')?.value || 'riyadh']?.label) || 'â€”',
      subtotal,
      vat,
      total,
      isManual: true,
      mode: 'once'
    };

    window.finalCalcOverride = calc;

    // Ù…Ø¹Ø§ÙŠÙ†Ø© Ø¨Ø³ÙŠØ·Ø© Ù„Ù„Ø²ÙŠØ§Ø±Ø© Ø§Ù„ÙˆØ§Ø­Ø¯Ø© (Ø¨Ø¯ÙˆÙ† Ø­Ù‚Ù„ ØªØ¹Ø¯ÙŠÙ„ Ø³Ø¹Ø± Ø§Ù„Ù…ØµØ¹Ø¯)
    document.getElementById('reviewBox').innerHTML = `
      <div class="contract-summary">
        <h4>Ù…Ø¹Ø§ÙŠÙ†Ø© Ø¹Ø±Ø¶ Ø³Ø¹Ø± (Ø²ÙŠØ§Ø±Ø© Ù„Ù…Ø±Ø© ÙˆØ§Ø­Ø¯Ø©)</h4>
        <table>
          <tr><td class="label">Ù†ÙˆØ¹ Ø§Ù„Ø²ÙŠØ§Ø±Ø©</td><td class="value">${document.getElementById('onceVisitType').selectedOptions[0].textContent}</td></tr>
          <tr><td class="label">ØªØ§Ø±ÙŠØ® Ø§Ù„Ø²ÙŠØ§Ø±Ø©</td><td class="value">${document.getElementById('onceDate').value}</td></tr>
          <tr><td class="label">Ø§Ù„Ù…Ø¨Ù„Øº Ù‚Ø¨Ù„ Ø§Ù„Ø¶Ø±ÙŠØ¨Ø©</td><td class="value">${subtotal.toFixed(2)} Ø±ÙŠØ§Ù„</td></tr>
          <tr><td class="label">Ø§Ù„Ø¶Ø±ÙŠØ¨Ø© (15%)</td><td class="value">${vat.toFixed(2)} Ø±ÙŠØ§Ù„</td></tr>
          <tr><td class="label total">Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø´Ø§Ù…Ù„ Ø§Ù„Ø¶Ø±ÙŠØ¨Ø©</td><td class="value total">${total.toFixed(2)} Ø±ÙŠØ§Ù„</td></tr>
        </table>
      </div>
    `;
  }

document.getElementById('reviewSection').style.display = 'block';

const btn = document.getElementById('saveBtn');
btn.style.display = 'inline-block';

// âœ… Ù„Ø§ ØªØ¹Ø±Ù‘Ù serviceType Ù…Ø±Ø© Ø«Ø§Ù†ÙŠØ© (Ø§Ø³ØªØ®Ø¯Ù… Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯ Ø¨Ø§Ù„Ø£Ø¹Ù„Ù‰)
btn.textContent = (serviceType === 'once')
  ? 'ğŸ’¾ Ø­ÙØ¸ Ø§Ù„Ø²ÙŠØ§Ø±Ø© ÙÙŠ Ø§Ù„Ø³Ø¬Ù„'
  : 'ğŸ’¾ Ø§Ø¹ØªÙ…Ø§Ø¯ ÙˆØ­ÙØ¸ Ø§Ù„Ø¹Ù‚Ø¯';


}

</script>

<script>
  function toggleServiceType(){
  const type = document.getElementById('serviceType')?.value || 'annual';

  document.getElementById('annualBox').style.display = (type === 'annual') ? 'block' : 'none';
  document.getElementById('onceBox').style.display   = (type === 'once') ? 'block' : 'none';

  // Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ù…Ø¹Ø§ÙŠÙ†Ø© ÙˆØ²Ø± Ø§Ù„Ø­ÙØ¸ Ø¹Ù†Ø¯ ØªØºÙŠÙŠØ± Ø§Ù„Ù†ÙˆØ¹ (Ø¹Ø´Ø§Ù† Ù…Ø§ ÙŠØµÙŠØ± ØªØ¶Ø§Ø±Ø¨)
  document.getElementById('reviewSection').style.display = 'none';
  document.getElementById('saveBtn').style.display = 'none';

  // ØªØµÙÙŠØ± Ø£ÙŠ override Ø³Ø§Ø¨Ù‚
  window.manualPricePerLift = null;
  window.finalCalcOverride = null;
}

document.addEventListener('DOMContentLoaded', () => {
  toggleServiceType();
});

  </script>
<script>
  
function esc(s){
  return String(s ?? '').replace(/[&<>"']/g, m => ({
    '&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#039;'
  }[m]));
}

function printOfferFromPreview(){

  const serviceType = document.getElementById('serviceType')?.value || 'annual';

  const calc = window.finalCalcOverride || calculateTotal();
  if(!calc || !calc.total){
    alert('âš ï¸ Ø§Ø¹Ø±Ø¶ Ø§Ù„Ø­Ø³Ø¨Ø© Ø£ÙˆÙ„Ø§Ù‹ Ø«Ù… Ø§Ø·Ø¨Ø¹ Ø¹Ø±Ø¶ Ø§Ù„Ø³Ø¹Ø±');
    return;
  }
  if(!customer){
    alert('âš ï¸ ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø¹Ù…ÙŠÙ„ Ø£ÙˆÙ„Ø§Ù‹');
    return;
  }

  const lifts = Number(document.getElementById('lifts').value || 0);
  const building = document.getElementById('building').value === 'government' ? 'Ø­ÙƒÙˆÙ…ÙŠ' : 'Ø®Ø§Øµ';
  const elevatorType = document.getElementById('elevatorType').value || 'â€”';

  const brandSelect = document.getElementById('brandSelect').value || '';
  const brandOther  = document.getElementById('brandOther')?.value || '';
  const brand = (brandSelect === 'Other') ? (brandOther || 'â€”') : (brandSelect || 'â€”');

  // âœ… Ø§Ù„ØªØ§Ø±ÙŠØ® ÙŠØ®ØªÙ„Ù Ø­Ø³Ø¨ Ø§Ù„Ù†ÙˆØ¹
  const date = (serviceType === 'once')
    ? (document.getElementById('onceDate').value || '')
    : (document.getElementById('contractDate').value || '');

  // âœ… Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø®Ø¯Ù…Ø© ÙŠØ®ØªÙ„Ù Ø­Ø³Ø¨ Ø§Ù„Ù†ÙˆØ¹
  let serviceHtml = '';
  if(serviceType === 'annual'){
    const visits = document.getElementById('visits').value === 'monthly' ? 'Ø²ÙŠØ§Ø±Ø© Ø´Ù‡Ø±ÙŠØ© (12 Ø²ÙŠØ§Ø±Ø©)' : 'Ø²ÙŠØ§Ø±Ø© ÙƒÙ„ Ø´Ù‡Ø±ÙŠÙ† (6 Ø²ÙŠØ§Ø±Ø§Øª)';
    const emergency = document.getElementById('emergency').value === 'extended' ? 'Ø®Ø§Ø±Ø¬ Ø§Ù„Ø¯ÙˆØ§Ù… (Ø¥Ø¶Ø§ÙÙŠ)' : 'Ø£ÙˆÙ‚Ø§Øª Ø§Ù„Ø¯ÙˆØ§Ù…';
    const spareParts = document.getElementById('spareParts').value === 'included' ? 'Ù…Ø´Ù…ÙˆÙ„Ø© (Ø¨Ø¹Ø±Ø¶ Ø®Ø§Øµ)' : 'ØºÙŠØ± Ù…Ø´Ù…ÙˆÙ„Ø©';
    const training = document.getElementById('training').value === 'yes' ? 'Ù†Ø¹Ù…' : 'Ù„Ø§';
    const notes = document.getElementById('notes').value || 'â€”';

    serviceHtml = `
      <div class="grid">
        <div class="kv"><span class="k">Ø¹Ø¯Ø¯ Ø§Ù„Ù…ØµØ§Ø¹Ø¯</span><span class="v">${lifts}</span></div>
        <div class="kv"><span class="k">Ù†ÙˆØ¹ Ø§Ù„Ù…Ø¨Ù†Ù‰</span><span class="v">${esc(building)}</span></div>
        <div class="kv"><span class="k">Ù†ÙˆØ¹ Ø§Ù„Ù…ØµØ¹Ø¯</span><span class="v">${esc(elevatorType)}</span></div>
        <div class="kv"><span class="k">Ø§Ù„Ù…Ø§Ø±ÙƒØ©</span><span class="v">${esc(brand)}</span></div>
        <div class="kv"><span class="k">Ø¹Ø¯Ø¯ Ø§Ù„Ø²ÙŠØ§Ø±Ø§Øª</span><span class="v">${esc(visits)}</span></div>
        <div class="kv"><span class="k">Ø®Ø¯Ù…Ø© Ø§Ù„Ø·ÙˆØ§Ø±Ø¦</span><span class="v">${esc(emergency)}</span></div>
        <div class="kv"><span class="k">ØªØ¯Ø±ÙŠØ¨ Ø¥Ù†Ù‚Ø§Ø° Ù…Ø­ØªØ¬Ø²ÙŠÙ†</span><span class="v">${esc(training)}</span></div>
        <div class="kv"><span class="k">Ù‚Ø·Ø¹ Ø§Ù„ØºÙŠØ§Ø±</span><span class="v">${esc(spareParts)}</span></div>
      </div>
      <div style="margin-top:8px;color:#374151"><b>Ù…Ù„Ø§Ø­Ø¸Ø§Øª:</b> ${esc(notes)}</div>
    `;
  } else {
    const vt = document.getElementById('onceVisitType').selectedOptions[0]?.textContent || 'â€”';
    const urgency = document.getElementById('onceUrgency').value === 'urgent' ? 'Ù…Ø³ØªØ¹Ø¬Ù„' : 'Ø¹Ø§Ø¯ÙŠ';
    const stopped = document.getElementById('onceStopped').value === 'yes' ? 'Ù†Ø¹Ù…' : 'Ù„Ø§';
    const issue = document.getElementById('onceIssue').value || 'â€”';

    serviceHtml = `
      <div class="grid">
        <div class="kv"><span class="k">Ù†ÙˆØ¹ Ø§Ù„Ø²ÙŠØ§Ø±Ø©</span><span class="v">${esc(vt)}</span></div>
        <div class="kv"><span class="k">ØªØ§Ø±ÙŠØ® Ø§Ù„Ø²ÙŠØ§Ø±Ø©</span><span class="v">${esc(date)}</span></div>
        <div class="kv"><span class="k">Ø§Ù„Ø£ÙˆÙ„ÙˆÙŠØ©</span><span class="v">${esc(urgency)}</span></div>
        <div class="kv"><span class="k">ØªÙˆÙ‚Ù ÙƒØ§Ù…Ù„</span><span class="v">${esc(stopped)}</span></div>

        <div class="kv"><span class="k">Ø¹Ø¯Ø¯ Ø§Ù„Ù…ØµØ§Ø¹Ø¯</span><span class="v">${lifts}</span></div>
        <div class="kv"><span class="k">Ù†ÙˆØ¹ Ø§Ù„Ù…Ø¨Ù†Ù‰</span><span class="v">${esc(building)}</span></div>
        <div class="kv"><span class="k">Ù†ÙˆØ¹ Ø§Ù„Ù…ØµØ¹Ø¯</span><span class="v">${esc(elevatorType)}</span></div>
        <div class="kv"><span class="k">Ø§Ù„Ù…Ø§Ø±ÙƒØ©</span><span class="v">${esc(brand)}</span></div>
      </div>

      <div style="margin-top:10px;color:#374151">
        <b>ÙˆØµÙ Ø§Ù„Ù…Ø´ÙƒÙ„Ø©/Ø§Ù„Ù…Ø·Ù„ÙˆØ¨:</b><br>${esc(issue)}
      </div>
    `;
  }

  const offerId = 'Q-' + Date.now();
  const w = window.open('', '_blank');

</script>


</body>
</html>
