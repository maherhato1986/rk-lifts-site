<!DOCTYPE html>



<!DOCTYPE html>


<head>
<meta charset="UTF-8">
<title>Ø¹Ù‚Ø¯ ØµÙŠØ§Ù†Ø© ÙˆÙ‚Ø§Ø¦ÙŠØ© Ù„Ù„Ù…ØµØ§Ø¹Ø¯</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body{font-family:Cairo,Arial;background:#f3f4f6;margin:0}
.container{max-width:1200px;margin:20px auto;background:#fff;padding:30px}
h2,h3{margin-top:0}
.section{margin-bottom:35px;border-bottom:1px dashed #e5e7eb;padding-bottom:25px}
label{font-weight:600;font-size:14px}
input,select,textarea{
  width:100%;padding:8px;margin-top:6px;
  border:1px solid #d1d5db;border-radius:8px
}
textarea{min-height:70px}
.grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:15px}
button{
  background:#059669;color:#fff;border:none;
  padding:10px 22px;border-radius:8px;
  cursor:pointer;font-size:14px
}
button.secondary{background:#6b7280}
button:disabled{background:#9ca3af;cursor:not-allowed}
.review-box{background:#f9fafb;padding:25px;border-radius:10px}
.en{direction:ltr;font-family:Arial}
@media print{
  body{background:#fff}
  .no-print{display:none}
}
</style>
</head>

<body>
<div class="container">

<h2>Ø¹Ù‚Ø¯ ØµÙŠØ§Ù†Ø© ÙˆÙ‚Ø§Ø¦ÙŠØ© Ù„Ù„Ù…ØµØ§Ø¹Ø¯</h2>

<!-- ================== Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„ ================== -->
<div class="section">
<h3>Ø£ÙˆÙ„Ø§Ù‹: Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„</h3>
<div id="customerInfo"></div>
</div>

<!-- ================== Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø¹Ø§Ù…Ø© ================== -->
<div class="section">
<h3>Ø«Ø§Ù†ÙŠØ§Ù‹: Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø¹Ù‚Ø¯</h3>
<div class="contract" contenteditable="true">
<div class="grid">
  <div>
    <label>Ù„ØºØ© Ø§Ù„Ø¹Ù‚Ø¯</label>
    <select id="lang">
      <option value="">-- Ø§Ø®ØªØ± --</option>
      <option value="ar">Ø¹Ø±Ø¨ÙŠ</option>
      <option value="en">English</option>
      <option value="both">Ø¹Ø±Ø¨ÙŠ + English</option>
    </select>
  </div>

  <div>
    <label>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¹Ù‚Ø¯</label>
    <input id="contractDate" type="date">
  </div>

  <div>
    <label>Ù…Ø¯Ø© Ø§Ù„Ø¹Ù‚Ø¯</label>
    <select id="duration">
      <option value="1">Ø³Ù†Ø© ÙˆØ§Ø­Ø¯Ø©</option>
    </select>
  </div>

  <div>
    <label>ØªØ¬Ø¯ÙŠØ¯ ØªÙ„Ù‚Ø§Ø¦ÙŠ</label>
    <select id="renewal">
      <option value="yes">Ù†Ø¹Ù…</option>
      <option value="no">Ù„Ø§</option>
    </select>
  </div>
</div>
</div>

<!-- ================== Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ØµØ§Ø¹Ø¯ ================== -->
<div class="section">
<h3>Ø«Ø§Ù„Ø«Ø§Ù‹: Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ØµØ§Ø¹Ø¯</h3>

<div class="grid">
  <div>
    <label>Ø¹Ø¯Ø¯ Ø§Ù„Ù…ØµØ§Ø¹Ø¯</label>
    <input id="lifts" type="number" min="1">
  </div>

  <div>
    <label>Ù†ÙˆØ¹ Ø§Ù„Ù…ØµØ¹Ø¯</label>
    <select id="elevatorType">
      <option value="passenger">Ø±ÙƒØ§Ø¨</option>
      <option value="service">Ø®Ø¯Ù…Ø©</option>
      <option value="panoramic">Ø¨Ø§Ù†ÙˆØ±Ø§Ù…ÙŠ</option>
    </select>
  </div>

  <div>
    <label>Ù…Ø§Ø±ÙƒØ© Ø§Ù„Ù…ØµØ¹Ø¯</label>
    <input id="brandName" placeholder="Otis / KONE / Mitsubishi ...">
  </div>

  <div>
    <label>Ø­Ù…ÙˆÙ„Ø© Ø§Ù„Ù…ØµØ¹Ø¯ (ÙƒØ¬Ù…)</label>
    <select id="capacity">
      <option value="">-- Ø§Ø®ØªØ± --</option>
      <option value="3000">150 â€“ 320</option>
      <option value="3500">350 â€“ 550</option>
      <option value="4000">600 â€“ 900</option>
      <option value="4500">901 â€“ 1100</option>
      <option value="5000">1101 â€“ 1500</option>
      <option value="5500">1501 â€“ 1750</option>
    </select>
  </div>

  <div>
    <label>Ø¹Ø¯Ø¯ Ø§Ù„Ø·ÙˆØ§Ø¨Ù‚</label>
    <input id="floors" type="number" min="1">
  </div>

  <div>
    <label>Ù†ÙˆØ¹ Ø§Ù„Ù…Ø¨Ù†Ù‰</label>
    <select id="building">
      <option value="private">Ø®Ø§Øµ</option>
      <option value="government">Ø­ÙƒÙˆÙ…ÙŠ</option>
    </select>
  </div>
</div>
</div>

<!-- ================== Ù†Ø·Ø§Ù‚ Ø§Ù„ØµÙŠØ§Ù†Ø© ================== -->
<div class="section">
<h3>Ø±Ø§Ø¨Ø¹Ø§Ù‹: Ù†Ø·Ø§Ù‚ Ø§Ù„ØµÙŠØ§Ù†Ø©</h3>

<div class="grid">
  <div>
    <label>Ø¹Ø¯Ø¯ Ø§Ù„Ø²ÙŠØ§Ø±Ø§Øª Ø§Ù„Ø¯ÙˆØ±ÙŠØ©</label>
    <select id="visits">
      <option value="monthly">Ø²ÙŠØ§Ø±Ø© Ø´Ù‡Ø±ÙŠØ©</option>
      <option value="bimonthly">Ø²ÙŠØ§Ø±Ø© ÙƒÙ„ Ø´Ù‡Ø±ÙŠÙ†</option>
    </select>
  </div>

  <div>
    <label>ØªØ¯Ø±ÙŠØ¨ Ø¥Ù†Ù‚Ø§Ø° Ø§Ù„Ù…Ø­ØªØ¬Ø²ÙŠÙ†</label>
    <select id="training">
      <option value="yes">Ù†Ø¹Ù…</option>
      <option value="no">Ù„Ø§</option>
    </select>
  </div>

  <div>
    <label>Ù‚Ø·Ø¹ Ø§Ù„ØºÙŠØ§Ø±</label>
    <select id="spareParts">
      <option value="excluded">ØºÙŠØ± Ù…Ø´Ù…ÙˆÙ„Ø©</option>
      <option value="included">Ù…Ø´Ù…ÙˆÙ„Ø© (Ø¨Ø¹Ø±Ø¶ Ø®Ø§Øµ)</option>
    </select>
  </div>

  <div>
    <label>Ø®Ø¯Ù…Ø© Ø§Ù„Ø·ÙˆØ§Ø±Ø¦</label>
    <select id="emergency">
      <option value="normal">Ø£ÙˆÙ‚Ø§Øª Ø§Ù„Ø¯ÙˆØ§Ù…</option>
      <option value="extended">Ø®Ø§Ø±Ø¬ Ø§Ù„Ø¯ÙˆØ§Ù… (Ø¥Ø¶Ø§ÙÙŠ)</option>
    </select>
  </div>
</div>

<label style="margin-top:15px">Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ©</label>
<textarea id="notes"></textarea>
<button onclick="saveContract()">ğŸ’¾ Ø­ÙØ¸ Ø§Ù„Ø¹Ù‚Ø¯</button>


</div>

<!-- ================== Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ø¹Ù‚Ø¯ ================== -->
<div class="section" id="reviewSection" style="display:none">
<h3>Ø®Ø§Ù…Ø³Ø§Ù‹: Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ø¹Ù‚Ø¯</h3>
<div class="review-box" id="reviewBox"></div>
<button onclick="window.print()">ğŸ–¨ï¸ Ø·Ø¨Ø§Ø¹Ø© / PDF</button>
</div>

</div>
  <div class="section">
  <h3>Ø³Ø¬Ù„ Ø¹Ù‚ÙˆØ¯ Ø§Ù„ØµÙŠØ§Ù†Ø© Ø§Ù„ÙˆÙ‚Ø§Ø¦ÙŠØ©</h3>

  <table border="1" width="100%" cellpadding="8" style="border-collapse:collapse">
    <thead style="background:#f3f4f6">
      <tr>
        <th>#</th>
        <th>Ø±Ù‚Ù… Ø§Ù„Ø¹Ù‚Ø¯</th>
        <th>Ø§Ù„Ø¹Ù…ÙŠÙ„</th>
        <th>Ø¹Ø¯Ø¯ Ø§Ù„Ù…ØµØ§Ø¹Ø¯</th>
        <th>Ù‚ÙŠÙ…Ø© Ø§Ù„Ø¹Ù‚Ø¯</th>
        <th>Ø§Ù„Ù„ØºØ©</th>
        <th>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¹Ù‚Ø¯</th>
        <th>Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
      </tr>
    </thead>
    <tbody id="contractsTable"></tbody>
  </table>
</div>


<script>
let customer=null;

document.addEventListener('DOMContentLoaded',()=>{
  const saved=localStorage.getItem('rkl_selected_customer');
  if(!saved){alert('Ù„Ù… ÙŠØªÙ… Ø§Ø®ØªÙŠØ§Ø± Ø¹Ù…ÙŠÙ„');return;}
  customer=JSON.parse(saved);

  document.getElementById('customerInfo').innerHTML=`
    Ø§Ù„Ø¹Ù…ÙŠÙ„: <span class="user-data">${customer.customer_name}</span>

    <p><b>Ø§Ù„Ø¬ÙˆØ§Ù„:</b> ${customer.mobile}</p>
    <p><b>Ø§Ù„Ø¹Ù†ÙˆØ§Ù†:</b> ${customer.city} â€“ ${customer.full_address||''}</p>
  `;
});

  function generateFullContractText(){

  const lang = document.getElementById('lang').value;
  const date = document.getElementById('contractDate').value;
  const lifts = document.getElementById('lifts').value;
  const brand = document.getElementById('brandName').value;
  const buildingType = document.getElementById('building').value === 'government'
    ? 'Ø­ÙƒÙˆÙ…ÙŠ'
    : 'Ø®Ø§Øµ';

  const city = customer.city || 'â€”';
  const address = customer.full_address || city;
  const mobile = customer.mobile || 'â€”';

  const calc = calculateTotal();

  /* ================== Ø§Ù„Ù†Øµ Ø§Ù„Ø¹Ø±Ø¨ÙŠ ================== */
  const ar = `

Ø¨ØªÙˆÙÙŠÙ‚ Ù…Ù† Ø§Ù„Ù„Ù‡ ØªÙ… Ø§Ù„Ø§ØªÙØ§Ù‚ Ø¨ØªØ§Ø±ÙŠØ® : ${date} ØŒ Ø¨ÙŠÙ† ÙƒÙ„ Ù…Ù†:

(Ø§Ù„Ø·Ø±Ù Ø§Ù„Ø£ÙˆÙ„)
Ù…Ø¤Ø³Ø³Ø© Ø¢Ø± ÙƒÙŠ Ø§Ù„ RKL Ù„Ù„Ù…ØµØ§Ø¹Ø¯ ÙˆØ§Ù„Ø³Ù„Ø§Ù„Ù… Ø§Ù„ÙƒÙ‡Ø±Ø¨Ø§Ø¦ÙŠØ©  
Ø³Ø¬Ù„ ØªØ¬Ø§Ø±ÙŠ Ø±Ù‚Ù… (1010709355)  
Ø§Ù„Ø±ÙŠØ§Ø¶ â€“ Ù‡Ø§ØªÙ 0114774021  
Ø§Ù„Ø¹Ù†ÙˆØ§Ù†: Ø§Ù„Ø³Ù„ÙŠÙ…Ø§Ù†ÙŠØ© â€“ Ø§Ù„Ø±ÙŠØ§Ø¶  
Ø±Ù‚Ù… ØªØ¹Ù…ÙŠØ¯ Ø§Ù„Ø¯ÙØ§Ø¹ Ø§Ù„Ù…Ø¯Ù†ÙŠ: 1-001335970-45  

(Ø§Ù„Ø·Ø±Ù Ø§Ù„Ø«Ø§Ù†ÙŠ)
Ø§Ù„Ø¹Ù…ÙŠÙ„: ${customer.customer_name}  
Ø±Ù‚Ù… Ø§Ù„Ø¬ÙˆØ§Ù„: ${mobile}  
Ø§Ù„Ø¹Ù†ÙˆØ§Ù†: ${address}  

Ù…Ù‚Ø¯Ù…Ø© Ø§Ù„Ø¹Ù‚Ø¯:
Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø±ØºØ¨Ø© Ø§Ù„Ø·Ø±Ù Ø§Ù„Ø«Ø§Ù†ÙŠ Ø¨ØµÙŠØ§Ù†Ø© Ø¹Ø¯Ø¯ (${lifts}) Ù…ØµØ¹Ø¯
Ù†ÙˆØ¹ Ø§Ù„Ù…ØµØ¹Ø¯ (${brand}) â€“ Ù…ØµØ§Ø¹Ø¯ Ø±ÙƒØ§Ø¨
Ù„Ù…Ø¨Ù†Ù‰ (${buildingType}) ÙÙŠ Ù…Ø¯ÙŠÙ†Ø© ${city}ØŒ
ÙÙ‚Ø¯ ØªÙ… Ø¥Ø³Ù†Ø§Ø¯ Ø£Ø¹Ù…Ø§Ù„ Ù‡Ø°Ø§ Ø§Ù„Ø¹Ù‚Ø¯ Ù„Ù„Ø·Ø±Ù Ø§Ù„Ø£ÙˆÙ„ ÙˆÙÙ‚ Ø§Ù„Ø¨Ù†ÙˆØ¯ Ø§Ù„ØªØ§Ù„ÙŠØ©:

Ø¨Ù†ÙˆØ¯ Ø§Ù„Ø¹Ù‚Ø¯:

1- ÙŠÙ‚ÙˆÙ… Ø§Ù„Ø·Ø±Ù Ø§Ù„Ø£ÙˆÙ„ Ø¨ØªÙ‚Ø¯ÙŠÙ… Ø®Ø¯Ù…Ø§Øª Ø§Ù„ØµÙŠØ§Ù†Ø© Ø§Ù„Ø¯ÙˆØ±ÙŠØ© Ù…Ø±Ø© ÙƒÙ„ Ø´Ù‡Ø± Ø¨ÙˆØ§Ø³Ø·Ø© ÙÙ†ÙŠÙŠÙ† Ù…Ø¤Ù‡Ù„ÙŠÙ† Ø¹Ù„Ù‰ Ù…Ø³ØªÙˆÙ‰ Ø¹Ø§Ù„Ù Ù…Ù† Ø§Ù„ÙƒÙØ§Ø¡Ø©ØŒ ÙˆØ°Ù„Ùƒ Ù„ÙØ­Øµ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø¹Ø¯Ø§Øª ÙˆØ¶Ø¨Ø· Ù†Ø¸Ø§ÙØ© Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø­Ø±ÙƒØ§Øª ÙˆØ£Ø¬Ù‡Ø²Ø© Ø§Ù„ØªØ­ÙƒÙ… ÙˆØ§Ù„Ø£Ù…Ø§Ù† ÙˆØ§Ù„ØªØ²ÙŠÙŠØª ÙˆØ§Ù„ØªØ´Ø­ÙŠÙ… Ù„Ø¬Ù…ÙŠØ¹ Ø­ÙˆØ§Ù…Ù„ Ø§Ù„Ù…Ø¹Ø¯Ø§Øª ÙˆØ«ÙˆØ§Ø¨ØªÙ‡Ø§.

2- Ø¹Ù„Ù‰ Ø§Ù„Ø·Ø±Ù Ø§Ù„Ø«Ø§Ù†ÙŠ Ø¥Ø¨Ù„Ø§Øº Ø§Ù„Ø·Ø±Ù Ø§Ù„Ø£ÙˆÙ„ ÙÙˆØ±Ù‹Ø§ ÙÙŠ Ø­Ø§Ù„ Ø­Ø¯ÙˆØ« ØªØ´ØºÙŠÙ„ ØºÙŠØ± Ø·Ø¨ÙŠØ¹ÙŠ Ø£Ùˆ ØªÙˆÙ‚Ù Ø£ÙŠ Ù…Ù† Ø§Ù„Ù…Ø¹Ø¯Ø§ØªØŒ Ù„ÙŠÙ‚ÙˆÙ… Ø§Ù„Ø·Ø±Ù Ø§Ù„Ø£ÙˆÙ„ Ø¨ØªÙ‚Ø¯ÙŠÙ… Ø®Ø¯Ù…Ø§Øª Ø§Ù„ØµÙŠØ§Ù†Ø© Ø¨ÙˆØ§Ø³Ø·Ø© ÙÙ†ÙŠÙŠÙ† Ù…ØªØ®ØµØµÙŠÙ† Ù„ØªØµØ­ÙŠØ­ Ø£ÙˆØ¶Ø§Ø¹ Ø§Ù„ØªØ´ØºÙŠÙ„ ØºÙŠØ± Ø§Ù„Ø·Ø¨ÙŠØ¹ÙŠØ© ÙˆØ¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù…Ø¹Ø¯Ø§Øª Ø¥Ù„Ù‰ Ø­Ø§Ù„Ø© Ø§Ù„ØªØ´ØºÙŠÙ„.

3- ÙŠÙ„ØªØ²Ù… Ø§Ù„Ø·Ø±Ù Ø§Ù„Ø£ÙˆÙ„ Ø¨ØªØ¯Ø±ÙŠØ¨ ÙˆØ§Ø­Ø¯ Ø£Ùˆ Ø§Ø«Ù†ÙŠÙ† Ù…Ù† Ù…ÙˆØ¸ÙÙŠ ØµÙŠØ§Ù†Ø© Ø§Ù„Ù…Ø¨Ù†Ù‰ (ÙŠØªÙ… ØªØ¹ÙŠÙŠÙ†Ù‡Ù… Ù…Ù† Ù‚Ø¨Ù„ Ø§Ù„Ø·Ø±Ù Ø§Ù„Ø«Ø§Ù†ÙŠ) Ø¹Ù„Ù‰ Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø¥Ù†Ù‚Ø§Ø° Ø§Ù„Ø±ÙƒØ§Ø¨ Ø§Ù„Ù…Ø­ØªØ¬Ø²ÙŠÙ† Ø¯Ø§Ø®Ù„ Ø§Ù„Ù…ØµØ¹Ø¯ ÙÙŠ Ø­Ø§Ù„ Ø­Ø¯ÙˆØ« Ø¹Ø·Ù„.

4- ÙŠÙˆØ§ÙÙ‚ Ø§Ù„Ø·Ø±Ù Ø§Ù„Ø£ÙˆÙ„ Ø¹Ù„Ù‰ ØªÙˆÙÙŠØ± Ø¬Ù…ÙŠØ¹ Ø²ÙŠÙˆØª Ø§Ù„ØªØ±ÙˆØ³ ÙˆØ§Ù„Ø´Ø­ÙˆÙ… ÙˆÙ…ÙˆØ§Ø¯ Ø§Ù„ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ù„Ø§Ø²Ù…Ø© Ù„Ø£Ø¹Ù…Ø§Ù„ Ø§Ù„ØµÙŠØ§Ù†Ø©.

5- ÙŠÙˆØ§ÙÙ‚ Ø§Ù„Ø·Ø±Ù Ø§Ù„Ø«Ø§Ù†ÙŠ Ø¹Ù„Ù‰ ØªØ­Ù…Ù‘Ù„ ØªÙƒÙ„ÙØ© Ø§Ø³ØªØ¨Ø¯Ø§Ù„ Ù‚Ø·Ø¹ Ø§Ù„ØºÙŠØ§Ø± Ø§Ù„ØªØ§Ù„ÙØ© Ø¨Ø£Ø®Ø±Ù‰ Ø£ØµÙ„ÙŠØ© Ø¹Ù„Ù‰ Ù†ÙÙ‚ØªÙ‡ Ø§Ù„Ø®Ø§ØµØ©.

6- ÙŠÙ‚ÙˆÙ… Ø§Ù„Ø·Ø±Ù Ø§Ù„Ø£ÙˆÙ„ Ø¨ØªÙ†ÙÙŠØ° Ø®Ø¯Ù…Ø§Øª Ø§Ù„ØµÙŠØ§Ù†Ø© Ø§Ù„Ù…Ø°ÙƒÙˆØ±Ø© Ø£Ø¹Ù„Ø§Ù‡ Ù…Ù‚Ø§Ø¨Ù„ Ø£Ø¬ÙˆØ± Ø§Ù„ØµÙŠØ§Ù†Ø© Ø§Ù„Ø³Ù†ÙˆÙŠØ© Ø§Ù„Ù…ØªÙÙ‚ Ø¹Ù„ÙŠÙ‡Ø§ØŒ ÙˆØ§Ù„ØªÙŠ ÙŠÙ„ØªØ²Ù… Ø§Ù„Ø·Ø±Ù Ø§Ù„Ø«Ø§Ù†ÙŠ Ø¨Ø³Ø¯Ø§Ø¯Ù‡Ø§.

Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠØ© Ù„Ù„Ø¹Ù‚Ø¯:
Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ù‚ÙŠÙ…Ø© Ø§Ù„Ø¹Ù‚Ø¯ (${calc.total.toFixed(2)}) Ø±ÙŠØ§Ù„ Ø³Ø¹ÙˆØ¯ÙŠ Ø´Ø§Ù…Ù„ Ø¶Ø±ÙŠØ¨Ø© Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ù…Ø¶Ø§ÙØ© 15%ØŒ ÙˆØºÙŠØ± Ø´Ø§Ù…Ù„ Ù‚ÙŠÙ…Ø© Ù‚Ø·Ø¹ Ø§Ù„ØºÙŠØ§Ø±.

ÙŠØ¨Ø¯Ø£ Ø§Ù„Ø¹Ù‚Ø¯ Ù…Ù† ØªØ§Ø±ÙŠØ® ØªØ­ÙˆÙŠÙ„ ÙƒØ§Ù…Ù„ Ø§Ù„Ù…Ø¨Ù„Øº ÙˆÙ„Ù…Ø¯Ø© Ø³Ù†Ø© Ù…ÙŠÙ„Ø§Ø¯ÙŠØ© ÙƒØ§Ù…Ù„Ø©.

Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø¨Ù†ÙƒÙŠ:
Ø§Ù„Ø¨Ù†Ùƒ: Ø§Ù„Ø¨Ù†Ùƒ Ø§Ù„Ø£Ù‡Ù„ÙŠ Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠ (SNB)  
Ø§Ø³Ù… Ø§Ù„Ø­Ø³Ø§Ø¨: Ø¢Ø± ÙƒÙŠ Ø§Ù„ RKL  
Ø±Ù‚Ù… Ø§Ù„Ø­Ø³Ø§Ø¨: 01400005531406  
Ø§Ù„Ø¢ÙŠØ¨Ø§Ù†: SA1710000001400005531406  

7- ÙÙŠ Ø­Ø§Ù„ Ø¥Ø®ÙØ§Ù‚ Ø§Ù„Ø·Ø±Ù Ø§Ù„Ø«Ø§Ù†ÙŠ ÙÙŠ Ø³Ø¯Ø§Ø¯ Ø§Ù„Ù…Ø³ØªØ­Ù‚Ø§Øª ÙÙŠ Ù…ÙˆØ§Ø¹ÙŠØ¯Ù‡Ø§ØŒ ÙŠØ­Ù‚ Ù„Ù„Ø·Ø±Ù Ø§Ù„Ø£ÙˆÙ„ Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ø£Ø¹Ù…Ø§Ù„ ÙÙˆØ±Ù‹Ø§ Ø¯ÙˆÙ† Ø£Ø¯Ù†Ù‰ Ù…Ø³Ø¤ÙˆÙ„ÙŠØ© Ø¹Ù† Ø£ÙŠ Ø£Ø¹Ø·Ø§Ù„ Ø£Ùˆ Ø­ÙˆØ§Ø¯Ø« Ø®Ù„Ø§Ù„ ÙØªØ±Ø© Ø§Ù„Ø¥ÙŠÙ‚Ø§ÙØŒ ÙˆÙŠØªØ­Ù…Ù„ Ø§Ù„Ø·Ø±Ù Ø§Ù„Ø«Ø§Ù†ÙŠ ÙƒØ§Ù…Ù„ Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ÙŠØ©.

8- ÙÙŠ Ø­Ø§Ù„Ø§Øª Ø§Ù„Ø·ÙˆØ§Ø±Ø¦ØŒ ÙŠÙ„ØªØ²Ù… Ø§Ù„Ø·Ø±Ù Ø§Ù„Ø«Ø§Ù†ÙŠ Ø¨Ø§Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹ Ù…ÙƒØªØ¨ Ø§Ù„ØµÙŠØ§Ù†Ø© Ù‡Ø§ØªÙÙŠÙ‹Ø§ØŒ ÙˆØ§Ù„Ø·Ø±Ù Ø§Ù„Ø£ÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ø³ØªØ¹Ø¯Ø§Ø¯ Ù„ØªÙ„Ø¨ÙŠØ© Ù†Ø¯Ø§Ø¡Ø§Øª Ø§Ù„Ø·ÙˆØ§Ø±Ø¦.

9- ÙŠÙˆØ§ÙÙ‚ Ø§Ù„Ø·Ø±Ù Ø§Ù„Ø£ÙˆÙ„ Ø¹Ù„Ù‰ ØªÙˆÙÙŠØ± ÙÙ†ÙŠÙŠÙ† Ù…Ø¤Ù‡Ù„ÙŠÙ† ÙÙŠ Ø­Ø§Ù„Ø§Øª Ø§Ù„Ø·ÙˆØ§Ø±Ø¦ Ø£Ùˆ Ø§Ù„Ù…Ù†Ø§Ø³Ø¨Ø§Øª Ø§Ù„Ø®Ø§ØµØ© Ù…Ù‚Ø§Ø¨Ù„ Ø±Ø³ÙˆÙ… Ø¥Ø¶Ø§ÙÙŠØ© Ø­Ø³Ø¨ Ø§Ù„Ø·Ù„Ø¨.

10- ÙŠØ³Ø±ÙŠ Ù‡Ø°Ø§ Ø§Ù„Ø¹Ù‚Ø¯ Ù„Ù…Ø¯Ø© Ø³Ù†Ø© Ù…ÙŠÙ„Ø§Ø¯ÙŠØ© ÙˆÙŠØªØ¬Ø¯Ø¯ ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§ Ù„Ù…Ø¯Ø© Ù…Ù…Ø§Ø«Ù„Ø© Ù…Ø§ Ù„Ù… ÙŠØ®Ø·Ø± Ø£Ø­Ø¯ Ø§Ù„Ø·Ø±ÙÙŠÙ† Ø§Ù„Ø¢Ø®Ø± Ø®Ø·ÙŠÙ‹Ø§ Ø¨Ø¹Ø¯Ù… Ø§Ù„Ø±ØºØ¨Ø© ÙÙŠ Ø§Ù„ØªØ¬Ø¯ÙŠØ¯ Ù‚Ø¨Ù„ 60 ÙŠÙˆÙ…Ù‹Ø§ Ù…Ù† ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡.

`;

  /* ================== Ø§Ù„Ù†Øµ Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠ ================== */
  const en = `

With the grace of God, this agreement was concluded on ${date} between:

(First Party)
RKL Elevators & Escalators  
Commercial Registration No. 1010709355  
Riyadh â€“ Tel: 0114774021  

(Second Party)
Customer: ${customer.customer_name}  
Mobile: ${mobile}  
Address: ${address}  

Introduction:
Based on the second partyâ€™s request to maintain (${lifts}) passenger elevator(s),
Brand (${brand}), located in a ${buildingType} building in ${city},
the first party shall perform the maintenance services under the following terms:

Contract Terms:

1- The first party shall provide periodic preventive maintenance once per month by highly qualified technicians to inspect all equipment, motors, controllers, safety devices, lubrication and cleaning.

2- The second party shall immediately notify the first party in case of abnormal operation or stoppage of any equipment to restore normal operation.

3- The first party shall train one or two building maintenance personnel nominated by the second party on rescue procedures for trapped passengers.

4- The first party shall provide all required gear oils, grease and cleaning materials.

5- Spare parts replacement costs shall be borne by the second party.

6- The first party shall perform the above services in consideration of the agreed annual maintenance fees.

Contract Value:
The total contract value is SAR ${calc.total.toFixed(2)}, inclusive of 15% VAT and excluding spare parts.

The contract shall commence upon full payment and remain valid for one calendar year.

Bank Details:
Bank: Saudi National Bank (SNB)  
Account Name: RKL  
IBAN: SA1710000001400005531406  

7- In case of non-payment, the first party may suspend services without liability.

8- Emergency calls shall be handled upon immediate notification.

9- Emergency or special services may be provided upon request with additional charges.

10- This contract shall be valid for one year and automatically renewed unless either party provides written notice 60 days prior to expiry.

`;

  /* ================== Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù„ØºØ© ================== */
  if(lang === 'ar') return ar;
  if(lang === 'en') return en;
  return ar + '\n\n---------------------------------\n\n' + en;
}

  
function calculateTotal(){
  let price = Number(document.getElementById('capacity').value);
  const lifts = Number(document.getElementById('lifts').value);
  const floors = Number(document.getElementById('floors').value);
  const building = document.getElementById('building').value;
  const brand = document.getElementById('brandName').value.toLowerCase();

  if(floors > 2) price *= 1.10;
  if(building === 'government') price *= 1.50;
  if(['otis','kone','mitsubishi','schindler'].some(b=>brand.includes(b))){
    price += 2000;
  }

  const subtotal = price * lifts;
  const vat = subtotal * 0.15;
  return {
    pricePerLift: price,
    vat,
    total: subtotal + vat
  };
}
function saveContract(){

  if(!customer){
    alert('Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯Ø©');
    return;
  }

  const required = ['lang','contractDate','lifts','capacity','floors'];
  for(const id of required){
    if(!document.getElementById(id).value){
      alert('ÙŠØ±Ø¬Ù‰ ØªØ¹Ø¨Ø¦Ø© Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ø¥Ù„Ø²Ø§Ù…ÙŠØ©');
      return;
    }
  }

  const calc = calculateTotal();

  const contract = {
    id: 'PMC-' + Date.now(),
    customer: customer.customer_name,
    lifts: document.getElementById('lifts').value,
    total: calc.total.toFixed(2) + ' Ø±ÙŠØ§Ù„',
    lang: document.getElementById('lang').value,
    date: document.getElementById('contractDate').value,
    content: generateFullContractText()
  };

  const contracts = JSON.parse(
    localStorage.getItem('rkl_maintenance_contracts') || '[]'
  );

  contracts.push(contract);
  localStorage.setItem(
    'rkl_maintenance_contracts',
    JSON.stringify(contracts)
  );

  renderContractsTable();

  alert('âœ… ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø¹Ù‚Ø¯ Ø¨Ù†Ø¬Ø§Ø­ØŒ ÙŠÙ…ÙƒÙ†Ùƒ Ø·Ø¨Ø§Ø¹ØªÙ‡ Ù…Ù† Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø¨Ø§Ù„Ø£Ø³ÙÙ„');
}


function openPrintView(contract){
  const w = window.open('', '_blank');

  w.document.write(`
<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>Ø¹Ù‚Ø¯ ØµÙŠØ§Ù†Ø© ÙˆÙ‚Ø§Ø¦ÙŠØ©</title>

<style>
@page {
  size: A4;
  margin: 25mm;
}

body{
  font-family: "Cairo", Arial, sans-serif;
  color:#111827;
  line-height:1.9;
}

.header{
  text-align:center;
  border-bottom:2px solid #0f766e;
  padding-bottom:10px;
  margin-bottom:20px;
}

.header h1{
  margin:0;
  font-size:22px;
  text-align:center;   /* â­ */
}

.editor-toolbar{
  border:1px solid #d1d5db;
  padding:10px;
  margin-bottom:15px;
  background:#f9fafb;
  text-align:center;
}

.editor-toolbar button,
.editor-toolbar select{
  margin:0 4px;
  padding:4px 8px;
  font-size:13px;
}

.user-data{
  color:#2563eb;       /* Ø£Ø²Ø±Ù‚ ÙˆØ§Ø¶Ø­ */
  font-weight:600;
}
.header p{
  margin:4px 0;
  font-size:12px;
}

.contract{
  font-size:14px;
}

.section-title{
  font-weight:700;
  margin-top:22px;
  margin-bottom:10px;
  color:#0f766e;
  text-align:center;   /* â­ ØªÙˆØ³ÙŠØ· */
}

.signature{
  margin-top:40px;
  display:flex;
  justify-content:space-between;
}

.signature div{
  width:45%;
  border-top:1px solid #000;
  padding-top:8px;
  text-align:center;
}

hr{
  border:none;
  border-top:1px dashed #9ca3af;
  margin:30px 0;
}
@media print{
  button,
  .editor-toolbar{display:none}
}
</style>
</head>

<body>
<div class="editor-toolbar">
  <button onclick="format('bold')"><b>B</b></button>
  <button onclick="format('italic')"><i>I</i></button>
  <button onclick="format('underline')"><u>U</u></button>

  <select onchange="format('foreColor', this.value)">
    <option value="">Ù„ÙˆÙ† Ø§Ù„Ù†Øµ</option>
    <option value="#2563eb">Ø£Ø²Ø±Ù‚</option>
    <option value="#dc2626">Ø£Ø­Ù…Ø±</option>
    <option value="#16a34a">Ø£Ø®Ø¶Ø±</option>
    <option value="#000000">Ø£Ø³ÙˆØ¯</option>
  </select>

  <select onchange="format('fontSize', this.value)">
    <option value="">Ø­Ø¬Ù… Ø§Ù„Ø®Ø·</option>
    <option value="3">ØµØºÙŠØ±</option>
    <option value="4">Ø¹Ø§Ø¯ÙŠ</option>
    <option value="5">ÙƒØ¨ÙŠØ±</option>
    <option value="6">ÙƒØ¨ÙŠØ± Ø¬Ø¯Ù‹Ø§</option>
  </select>
</div>

<div class="header">
  <h1>Ø¹Ù‚Ø¯ ØµÙŠØ§Ù†Ø© ÙˆÙ‚Ø§Ø¦ÙŠØ© Ù„Ù„Ù…ØµØ§Ø¹Ø¯</h1>
  <p>Ø¢Ø± ÙƒÙŠ Ø§Ù„ RKL Ù„Ù„Ù…ØµØ§Ø¹Ø¯ ÙˆØ§Ù„Ø³Ù„Ø§Ù„Ù… Ø§Ù„ÙƒÙ‡Ø±Ø¨Ø§Ø¦ÙŠØ©</p>
  <p>Ø§Ù„Ø³Ø¬Ù„ Ø§Ù„ØªØ¬Ø§Ø±ÙŠ: 1010709355 | Ù‡Ø§ØªÙ: 0114774021</p>
</div>

<div class="contract" contenteditable="true">
${contract.content
  .replace(/\n/g,'<br>')
  .replace(/Ø¨Ù†ÙˆØ¯ Ø§Ù„Ø¹Ù‚Ø¯:/g,'<div class="section-title">Ø¨Ù†ÙˆØ¯ Ø§Ù„Ø¹Ù‚Ø¯</div>')
  .replace(/Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠØ© Ù„Ù„Ø¹Ù‚Ø¯:/g,'<div class="section-title">Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠØ© Ù„Ù„Ø¹Ù‚Ø¯</div>')
  .replace(/Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø¨Ù†ÙƒÙŠ:/g,'<div class="section-title">Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø¨Ù†ÙƒÙŠ</div>')
  .replace(/Ø§Ù„ØªÙˆÙ‚ÙŠØ¹Ø§Øª:/g,'<div class="section-title">Ø§Ù„ØªÙˆÙ‚ÙŠØ¹Ø§Øª</div>')
}
</div>

<div class="signature">
  <div>ØªÙˆÙ‚ÙŠØ¹ Ø§Ù„Ø·Ø±Ù Ø§Ù„Ø£ÙˆÙ„</div>
  <div>ØªÙˆÙ‚ÙŠØ¹ Ø§Ù„Ø·Ø±Ù Ø§Ù„Ø«Ø§Ù†ÙŠ</div>
</div>

<br>
<button onclick="window.print()">ğŸ–¨ï¸ Ø·Ø¨Ø§Ø¹Ø© Ø§Ù„Ø¹Ù‚Ø¯</button>

</body>
</html>
  `);

  w.document.close();
}

function renderContractsTable(){
  const tbody = document.getElementById('contractsTable');
  const contracts = JSON.parse(localStorage.getItem('rkl_maintenance_contracts') || '[]');
  tbody.innerHTML = '';

  contracts.forEach((c, i) => {
    tbody.innerHTML += `
      <tr>
        <td>${i+1}</td>
        <td>${c.id}</td>
        <td>${c.customer}</td>
        <td>${c.lifts}</td>
        <td>${c.total}</td>
        <td>${c.lang}</td>
        <td>${c.date}</td>
        <td>
          <button onclick='openPrintView(${JSON.stringify(c)})'>Ø·Ø¨Ø§Ø¹Ø©</button>
        </td>
      </tr>
    `;
  });
}

document.addEventListener('DOMContentLoaded', renderContractsTable);


function reviewContract(){
  const required=['lang','contractDate','lifts','capacity','floors'];
  for(const id of required){
    if(!document.getElementById(id).value){
      alert('ÙŠØ±Ø¬Ù‰ ØªØ¹Ø¨Ø¦Ø© Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ø¥Ù„Ø²Ø§Ù…ÙŠØ©');
      return;
    }
  }

  let price=Number(document.getElementById('capacity').value);
  const lifts=Number(document.getElementById('lifts').value);
  const floors=Number(document.getElementById('floors').value);
  const building=document.getElementById('building').value;
  const brand=document.getElementById('brandName').value.toLowerCase();

  if(floors>2) price*=1.10;
  if(building==='government') price*=1.50;
  if(['otis','kone','mitsubishi','schindler'].some(b=>brand.includes(b))){
    price+=2000;
  }

  const vat=price*lifts*0.15;
  const total=price*lifts+vat;

  document.getElementById('reviewBox').innerHTML=`
    <p><b>Ø¹Ø¯Ø¯ Ø§Ù„Ù…ØµØ§Ø¹Ø¯:</b> ${lifts}</p>
    <p><b>Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ø³Ù†ÙˆÙŠ Ù„Ù„Ù…ØµØ¹Ø¯:</b> ${price.toFixed(2)} Ø±ÙŠØ§Ù„</p>
    <p><b>Ø¶Ø±ÙŠØ¨Ø© Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ù…Ø¶Ø§ÙØ© 15%:</b> ${vat.toFixed(2)} Ø±ÙŠØ§Ù„</p>
    <p><b>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ù‚ÙŠÙ…Ø© Ø§Ù„Ø¹Ù‚Ø¯:</b> <strong>${total.toFixed(2)} Ø±ÙŠØ§Ù„</strong></p>
    <p><b>Ù…Ù„Ø§Ø­Ø¸Ø§Øª:</b> ${document.getElementById('notes').value||'â€”'}</p>
  `;

  document.getElementById('reviewSection').style.display='block';
}
</script>
  <script>
function format(cmd, value = null){
  document.execCommand(cmd, false, value);
}
</script>


</body>
</html>
