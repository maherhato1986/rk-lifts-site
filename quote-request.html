<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>ุทูุจ ุฎุฏูุฉ - RKL</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
body{font-family:Cairo;background:#f4f6f9}
.container{max-width:900px;margin:30px auto;background:#fff;padding:30px;border-radius:12px}
h2{text-align:center;margin-bottom:10px}
label{font-weight:600;margin-top:12px;display:block}
input,select,textarea{width:100%;padding:10px;margin-top:6px;border-radius:6px;border:1px solid #ccc}
button{margin-top:25px;width:100%;background:#0a7cff;color:#fff;border:none;padding:15px;font-size:16px;border-radius:8px}
.hidden{display:none}
.section{margin-top:25px;border-top:1px solid #eee;padding-top:15px}
.summary{background:#f9fafb;padding:15px;border-radius:8px;margin-top:20px}
</style>
</head>

<body>

<div class="container">
<h2>๐ ูููุฐุฌ ุทูุจ ุฎุฏูุฉ</h2>

<!-- ุจูุงูุงุช ุงูุนููู -->
<div class="section">
<label>ุงุณู ุงูุนููู</label>
<input id="name">

<label>ุฑูู ุงูุฌูุงู</label>
<input id="phone" name="ุฑูู ุงูุฌูุงู" placeholder="05XXXXXXXX" required>
  <label>ุงูุจุฑูุฏ ุงูุฅููุชุฑููู</label>
<input type="email" id="email" name="ุงูุจุฑูุฏ_ุงูุฅููุชุฑููู" placeholder="example@email.com" required>




<select id="type" onchange="toggleType()">
  <option value="">ุงุฎุชุฑ ููุน ุงูุทูุจ</option>
  <option value="maintenance">ุตูุงูุฉ ูุตุงุนุฏ</option>
  <option value="supply">ุชูุฑูุฏ ูุชุฑููุจ ูุตุงุนุฏ</option>
  <option value="consult">ุงุณุชุดุงุฑุฉ ููุท</option>
</select>


<!-- ููุน ุงูุทูุจ (ุซุงุจุช ุงูุขู) -->
<input type="hidden" name="request_type" value="maintenance">

<div id="contractQuestion">
  <label>ูู ูุฏูู ุนูุฏ ูุนูุงุ</label>
  <select id="hasContract" onchange="toggleContractFlow()">
    <option value="">ุงุฎุชุฑ</option>
    <option value="yes">ูุนู</option>
    <option value="no">ูุง</option>
  </select>
</div>



<div id="withContract" style="display:none">

  <label>ุงุณู ุงููุดุฑูุน / ุงููููุน</label>
  <input type="text" name="project_name">

  <label>  ููุน ุงูุจููุงุบ ุงููุทููุจ</label>
  <select name="issue_type">
    <option>ุตูุงูุฉ ุฏูุฑูุฉ</option>
    <option>ุนุทู ููุงุฌุฆ</option>
    <option>ุงุญุชุฌุงุฒ</option>
    <option>ุฅุนุงุฏุฉ ุชุดุบูู</option>
  </select>

  <label>ุญุงูุฉ ุงููุตุนุฏ</label>
  <select name="lift_status">
    
    <option>ูุนูู ูุน ููุงุญุธุงุช</option>
    <option>ูุชููู</option>
  </select>

  <label>ุฃููููุฉ ุงูุทูุจ</label>
  <select name="priority">
    <option>ุนุงุฏู</option>
    <option>ุนุงุฌู</option>
    <option>ุทุงุฑุฆ</option>
  </select>

  <label>ูุตู ุงูุนุทู</label>
  <textarea name="description"></textarea>

  <label>ุฅุฑูุงู ุตูุฑ / ูุฎุทุท (ุงุฎุชูุงุฑู)</label>
<small style="color:#666;">
โข ููููู ุฑูุน ุฃูุซุฑ ูู ุตูุฑุฉ  
โข ููููู ุงูุชุตููุฑ ูุจุงุดุฑุฉ ูู ูุงููุฑุง ุงูุฌูุงู  
โข ููููู ุฑูุน ููู PDF (ูุฎุทุท)
</small>

<input
  type="file"
  name="attachments[]"
  multiple
  accept="image/*,.pdf"
  capture="environment"
>


</div>


<div id="withoutContract" style="display:none">

  <label>ููุน ุงูุฎุฏูุฉ ุงููุทููุจุฉ</label>
  <select name="service_type">
    
    <option>ุนุฑุถ ุณุนุฑ ุฒูุงุฑุฉ ููุฑู ูุงุญุฏุฉ</option>
    <option>ุนุฑุถ ุณุนุฑ ุนูุฏ ุตูุงูุฉ ููุงุฆูุฉ ุณููู</option>
  </select>

  <label>ุนุฏุฏ ุงููุตุงุนุฏ</label>
  <input type="number" name="lifts_count">
  <label>ุนุฏุฏ ุงููููุงุช (ุงูุฃุฏูุงุฑ)</label>
<input type="number" name="stops_count" placeholder="ูุซุงู: 10">

<label>ุญูููุฉ ุงููุตุนุฏ (ูุฌู)</label>
<select name="capacity">
  <option value="">ุงุฎุชุฑ ุงูุญูููุฉ</option>
  <option>450</option>
  <option>630</option>
  <option>800</option>
  <option>1000</option>
  <option>1600</option>
</select>

<label>ููุน ุงููุจูู</label>
<select name="building_type">
  <option value="">ุงุฎุชุฑ</option>
  <option>ุณููู</option>
  <option>ุญูููู</option>
</select>


<label>ููุน ุงููุตุงุนุฏ</label>
<select name="lift_brand">
  <option>ููุฌู</option>
  <option>ุดูุฏูุฑ</option>
  <option>ุงูุชูุณ</option>
  <option>ุชุฌููุน ูุญูู</option>
  <option>ูุง ุงุนุฑู</option>
</select>

<label>ุญุงูุฉ ุงููุตุนุฏ</label>
<select name="lift_condition">
  <option>ูุนูู</option>
  <option>ูุชููู</option>
  <option>ุจู ูุดุงูู</option>
</select>


  <label>ุงูุนูุฑ ุงูุชูุฑูุจู ูููุตุนุฏ</label>
  <select name="lift_age">
    <option>ุฃูู ูู 5 ุณููุงุช</option>
    <option>5 โ 10 ุณููุงุช</option>
    <option>ุฃูุซุฑ ูู 10 ุณููุงุช</option>
  </select>
<label>ุฑูุน ุตูุฑุฉ (ุงุฎุชูุงุฑู)</label>
<small style="color:#666;">
ูุฑุฌู ุฑูุน ุตูุฑุฉ ูููุงุจููุฉ ูู ุงูุฏุงุฎู ุฃู ููุญุฉ ุงูููุชุฑูู ุฏุงุฎู ุบุฑูุฉ ุงูููููุฉ (ุฅู ูุฌุฏุช)ุ  
ูุฐูู ููุณุงุนุฏุชูุง ุนูู ุชูููู  ุจุดูู ุฃุฏู.
</small>
<input type="file" accept="image/*">
  <label>ููุงุญุธุงุช ุนู ุงููุตุงุนุฏ </label>
  <textarea name="description"></textarea>

</div>



<div id="mapSection">
  <label>ูููุน ุงููุดุฑูุน</label>
  <input type="text" id="location" readonly>
  <div id="map" style="height:300px;border-radius:8px;margin-top:10px;"></div>
</div>








<!-- ุชูุฑูุฏ -->
<div id="supply" class="section hidden">
<label>ุงุณู ุงููุดุฑูุน</label>
<input id="project">



<label>ููุน ุงููุจูู</label>
<select>
  <option>ุณููู</option>
  <option>ุชุฌุงุฑู</option>
  <option>ูุณุชุดูู</option>
</select>

<label>ุนุฏุฏ ุงููุตุงุนุฏ</label>
<input type="number">

<label>ุนุฏุฏ ุงูุฃุฏูุงุฑ</label>
<input type="number">

<label>ุฑูุน ุงููุฎุทุท</label>
<input type="file">

<label>ููุงุญุธุงุช</label>
<textarea></textarea>
</div>

<!-- ููุฎุต -->
<div class="section">
<button type="button" onclick="showSummary()">
๐ ุนุฑุถ ููุฎุต ุงูุทูุจ
</button>

<div id="summaryBox" class="summary hidden"></div>
</div>

<form action="https://formsubmit.co/admin@rkl.sa"
      method="POST"
      onsubmit="prepareBeforeSubmit();">
<input type="hidden" name="ุฑูู_ุงูุทูุจ" id="request_id">


  <!-- ุฅุนุฏุงุฏุงุช FormSubmit -->
  <input type="hidden" name="_subject" value="๐ฉ ุทูุจ ุฎุฏูุฉ ุฌุฏูุฏ ูู ูููุน RKL">
  <input type="hidden" name="_captcha" value="false">
  <input type="hidden" name="_template" value="table">

  <!-- ุงูุญููู ุงูุชู ุณุชุธูุฑ ูู ุฌุฏูู ุงูุฅูููู -->


  <!-- ุงูููุฎุต ุงูุชูุตููู (ูุธูุฑ ููุต ุฎุงุฑุฌ ุงูุฌุฏูู) -->
  <input type="hidden" name="ููุฎุต_ุงูุทูุจ_ุงููุงูู" id="full_summary">

  <!-- ุฅุฑุณุงู ูุณุฎุฉ ูู ุงูุฅูููู ููุนููู -->
  <input type="hidden" name="_cc" id="cc_email">

  <!-- ุฒุฑ ุงูุฅุฑุณุงู -->
  <button type="submit">๐จ ุฅุฑุณุงู ุงูุทูุจ</button>
</form>




<p style="font-size:13px;color:#777;margin-top:10px;text-align:center;">
๐ ุฌููุน ุงูุจูุงูุงุช ูุญููุธุฉ ุจุณุฑูุฉ ุชุงูุฉ ููู ูุชู ุงุณุชุฎุฏุงููุง ุฅูุง ูุบุฑุถ ุงูุฎุฏูุฉ.
</p>

</div>

<script>
let map, marker;

/* =========================
   ุงูุชุญูู ุจููุน ุงูุทูุจ
========================= */
function toggleType() {
  const type = document.getElementById("type").value;

  // ุฅุฎูุงุก ูู ุงูุฃูุณุงู ุฃููุงู
  hideAllSections();

  // ุฅุฎูุงุก ุณุคุงู ุงูุนูุฏ ุงูุชุฑุงุถูุงู
  document.getElementById("contractQuestion").style.display = "none";
  document.getElementById("hasContract").value = "";

  if (type === "maintenance") {
    // ุตูุงูุฉ โ ูุธูุฑ ุณุคุงู ุงูุนูุฏ + ุงูุฎุฑูุทุฉ
    document.getElementById("contractQuestion").style.display = "block";
    document.getElementById("mapSection").style.display = "block";
  }

  if (type === "supply") {
    // ุชูุฑูุฏ ูุชุฑููุจ โ ููุท ูุณู ุงูุชูุฑูุฏ + ุงูุฎุฑูุทุฉ
    document.getElementById("supply").style.display = "block";
    document.getElementById("mapSection").style.display = "block";
  }

  if (type === "consult") {
    alert("๐ ุณูุชู ุงูุชูุงุตู ูุนู ูุชูุฏูู ุงุณุชุดุงุฑุฉ ูููุฉ ูุฌุงููุฉ");
  }
}


/* =========================
   ูู ููุฌุฏ ุนูุฏุ
========================= */
function toggleContractFlow() {
  const val = document.getElementById("hasContract").value;

  document.getElementById("withContract").style.display = "none";
  document.getElementById("withoutContract").style.display = "none";

  if (val === "yes") {
    document.getElementById("withContract").style.display = "block";
  }

  if (val === "no") {
    document.getElementById("withoutContract").style.display = "block";
  }
}

/* =========================
   ุฅุฎูุงุก ูู ุงูุฃูุณุงู
========================= */
function hideAllSections() {
  document.getElementById("withContract").style.display = "none";
  document.getElementById("withoutContract").style.display = "none";
  document.getElementById("supply").style.display = "none";
 
}


/* =========================
   Google Map
========================= */
function initMap() {
  const defaultLocation = { lat: 24.7136, lng: 46.6753 };

  map = new google.maps.Map(document.getElementById("map"), {
    center: defaultLocation,
    zoom: 12
  });

  map.addListener("click", function (e) {
    if (marker) marker.setMap(null);

    marker = new google.maps.Marker({
      position: e.latLng,
      map: map
    });

    document.getElementById("location").value =
      `https://maps.google.com/?q=${e.latLng.lat()},${e.latLng.lng()}`;
  });
}

function showSummary() {

  const byId = id => document.getElementById(id)?.value || "โ";
  const byName = name => document.querySelector(`[name="${name}"]`)?.value || "โ";

  const type = byId("type");
  const hasContract = byId("hasContract");

  let serviceDetails = "";

  /* =========================
     ุตูุงูุฉ ูุตุงุนุฏ
  ========================= */
  if (type === "maintenance") {

    if (hasContract === "yes") {
      serviceDetails = `
      <b>๐ข ุงุณู ุงููุดุฑูุน:</b> ${byName("project_name")}<br>
      <b>๐ง ููุน ุงูุจูุงุบ:</b> ${byName("issue_type")}<br>
      <b>๐จ ุญุงูุฉ ุงููุตุนุฏ:</b> ${byName("lift_status")}<br>
      <b>โก ุฃููููุฉ ุงูุทูุจ:</b> ${byName("priority")}<br>
      <b>๐ ูุตู ุงูุนุทู:</b><br>${byName("description")}
      `;
    }

    if (hasContract === "no") {
      serviceDetails = `
      <b>๐๏ธ ููุน ุงูุฎุฏูุฉ:</b> ${byName("service_type")}<br>
      <b>๐ ุนุฏุฏ ุงููุตุงุนุฏ:</b> ${byName("lifts_count")}<br>
      <b>๐ข ููุน ุงููุจูู:</b> ${byName("building_type")}<br>
      <b>๐ ุนุฏุฏ ุงููููุงุช:</b> ${byName("stops_count")}<br>
      <b>โ๏ธ ุงูุญูููุฉ:</b> ${byName("capacity")} ูุฌู<br>
      <b>๐ญ ููุน ุงููุตุงุนุฏ:</b> ${byName("lift_brand")}<br>
      <b>๐จ ุญุงูุฉ ุงููุตุนุฏ:</b> ${byName("lift_condition")}<br>
      <b>โณ ุนูุฑ ุงููุตุนุฏ:</b> ${byName("lift_age")}<br>
      <b>๐ ููุงุญุธุงุช:</b><br>${byName("description")}
      `;
    }
  }

  /* =========================
     ุชูุฑูุฏ ูุชุฑููุจ ูุตุงุนุฏ
  ========================= */
  if (type === "supply") {
    serviceDetails = `
    <b>๐๏ธ ุงุณู ุงููุดุฑูุน:</b> ${byId("project")}<br>
    <b>๐ข ููุน ุงููุจูู:</b> ${document.querySelector('#supply select')?.value || "โ"}<br>
    <b>๐ ุนุฏุฏ ุงููุตุงุนุฏ:</b> ${document.querySelector('#supply input[type="number"]')?.value || "โ"}<br>
    <b>๐ข ุนุฏุฏ ุงูุฃุฏูุงุฑ:</b> ${document.querySelectorAll('#supply input[type="number"]')[1]?.value || "โ"}<br>
    <b>๐ ูุฎุทุท ูุฑูู:</b> ${document.querySelector('#supply input[type="file"]')?.files.length ? "ูุนู โ" : "ูุง"}<br>
    <b>๐ ููุงุญุธุงุช:</b><br>${document.querySelector('#supply textarea')?.value || "โ"}
    `;
  }

  const summary = `
  <div style="line-height:2">
    <h4>๐ ููุฎุต ุงูุทูุจ</h4>
    <hr>
    <b>๐ค ุงูุงุณู:</b> ${byId("name")}<br>
    <b>๐ ุงูุฌูุงู:</b> ${byId("phone")}<br>
    <b>๐๏ธ ููุน ุงูุทูุจ:</b> ${type}<br>

    <hr>
    ${serviceDetails}
    <hr>

    <b>๐ ูููุน ุงููุดุฑูุน:</b><br>
    <a href="${byId("location")}" target="_blank">${byId("location")}</a>
  </div>
  `;

document.getElementById("summaryBox").innerHTML = summary;
document.getElementById("summaryBox").classList.remove("hidden");

// โฌ๏ธ ูุฐุง ุงูุณุทุฑ ุงูุฌุฏูุฏ (ููู)
document.getElementById("full_summary").value =
`๐ ุทูุจ ุฎุฏูุฉ ุฌุฏูุฏ โ RKL
ุฑูู ุงูุทูุจ: ${document.getElementById("request_id").value}
--------------------------------

๐ค ุงูุงุณู: ${byId("name")}
๐ ุงูุฌูุงู: ${byId("phone")}
๐๏ธ ููุน ุงูุทูุจ: ${type}

${serviceDetails
  .replace(/<br>/g, "\n")
  .replace(/<[^>]*>/g, "")
}

๐ ูููุน ุงููุดุฑูุน:
${byId("location")}
`;

}


</script>
 
<script>
function prepareBeforeSubmit() {
  // 1) ุชูููุฏ ููุฎุต ุงูุฅูููู ูู ููุณ ููุฎุต ุงูุตูุญุฉ
  showSummary();
const reqId = generateRequestId();
document.getElementById("request_id").value = reqId;

  // 2) ุฅุฑุณุงู ูุณุฎุฉ ููุนููู
  document.getElementById("cc_email").value =
    document.getElementById("email").value || "";

  // 3) ูุงุชุณุงุจ (ุงุฎุชูุงุฑู) ุจุฏูู ุชุนุฏูู full_summary
  if (typeof sendWhatsAppToClient === "function") {
    sendWhatsAppToClient(); 
  }

  return true;
}
</script>



  <script
  src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCscTZats0zQdXyjweiRZuqjiSxw_Y1dlY&callback=initMap"
  async
  defer>
</script>

<script>
function normalizeSaudiPhone(phone) {
  phone = phone.replace(/\D/g, '');
  if (phone.startsWith('05')) return '966' + phone.substring(1);
  if (phone.startsWith('5')) return '966' + phone;
  if (phone.startsWith('966')) return phone;
  return '';
}

function sendWhatsAppToClient() {

  /* ===== ุงูุจูุงูุงุช ุงูุฃุณุงุณูุฉ ===== */
  const name = document.getElementById("name").value || "โ";
  const rawPhone = document.getElementById("phone").value;
  const phone = normalizeSaudiPhone(rawPhone);

  if (!phone) {
    alert("โ ุฑูู ุงูุฌูุงู ุบูุฑ ุตุญูุญ");
    return false;
  }

  const type = document.getElementById("type").value || "โ";
  const hasContract = document.getElementById("hasContract").value || "โ";
  const location = document.getElementById("location").value || "โ";
const reqId = document.getElementById("request_id").value;

const whatsappMsg = `
ูุฑุญุจูุง ${name} ๐
ุชู ุงุณุชูุงู ุทูุจู ูุฏู *RKL ูููุตุงุนุฏ* โ

๐ ุฑูู ุงูุทูุจ: ${reqId}
๐๏ธ ููุน ุงูุทูุจ: ${type}
๐ ุงููููุน: ${location}

๐ ูุฑุฌู ุฅุฑุณุงู ุงูุตูุฑ / ุงููุฎุทุท ูุน ุฐูุฑ ุฑูู ุงูุทูุจ ุฃุนูุงู.
`;

  /* ===== ุชูุงุตูู ุญุณุจ ุงูุญุงูุฉ ===== */
  let details = "";

  if (hasContract === "yes") {
    details = `
ุงุณู ุงููุดุฑูุน: ${document.querySelector('[name="project_name"]')?.value || "โ"}
ููุน ุงูุจูุงุบ: ${document.querySelector('[name="issue_type"]')?.value || "โ"}
ุญุงูุฉ ุงููุตุนุฏ: ${document.querySelector('[name="lift_status"]')?.value || "โ"}
ุฃููููุฉ ุงูุทูุจ: ${document.querySelector('[name="priority"]')?.value || "โ"}
ูุตู ุงูุนุทู: ${document.querySelector('[name="description"]')?.value || "โ"}
`;
  }

  if (hasContract === "no") {
  details = `
ููุน ุงูุฎุฏูุฉ: ${document.querySelector('[name="service_type"]')?.value || "โ"}
ุนุฏุฏ ุงููุตุงุนุฏ: ${document.querySelector('[name="lifts_count"]')?.value || "โ"}
ููุน ุงููุจูู: ${document.querySelector('[name="building_type"]')?.value || "โ"}
ุนุฏุฏ ุงููููุงุช: ${document.querySelector('[name="stops_count"]')?.value || "โ"}
ุญูููุฉ ุงููุตุนุฏ: ${document.querySelector('[name="capacity"]')?.value || "โ"} ูุฌู
ููุน ุงููุตุงุนุฏ: ${document.querySelector('[name="lift_brand"]')?.value || "โ"}
ุญุงูุฉ ุงููุตุนุฏ: ${document.querySelector('[name="lift_condition"]')?.value || "โ"}
ุนูุฑ ุงููุตุนุฏ: ${document.querySelector('[name="lift_age"]')?.value || "โ"}
ููุงุญุธุงุช: ${document.querySelector('[name="description"]')?.value || "โ"}
`;
}





  /* ===== ุฑุณุงูุฉ ูุงุชุณุงุจ ููุนููู ===== */
  const whatsappMsg = `
ูุฑุญุจูุง ${name} ๐
ุชู ุงุณุชูุงู ุทูุจู ูุฏู *RKL ูููุตุงุนุฏ* โ

๐๏ธ ููุน ุงูุทูุจ: ${type}
๐ ุงููููุน: ${location}

ุณูุชู ุงูุชูุงุตู ูุนู ูุฑูุจูุง.
ุดูุฑุงู ูุซูุชู ุจูุง ๐ท
  `;

  window.open(
    "https://wa.me/" + phone + "?text=" + encodeURIComponent(whatsappMsg),
    "_blank"
  );
document.getElementById("cc_email").value =
  document.getElementById("email").value;

  return true; // ููู ุฌุฏูุง ููุณูุงุญ ุจุฅุฑุณุงู ุงูููุฑู
}
</script>

  <script>
function generateRequestId() {
  const now = new Date();
  const y = now.getFullYear().toString().slice(2);
  const m = String(now.getMonth() + 1).padStart(2, '0');
  const d = String(now.getDate()).padStart(2, '0');
  const r = Math.floor(Math.random() * 900 + 100); // 3 digits
  return `RKL-${y}${m}${d}-${r}`;
}
</script>

  
</body>
</html>
